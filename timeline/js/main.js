!function(t,e){function n(t){var e=t.length,n=ot.type(t);return!ot.isWindow(t)&&(!(1!==t.nodeType||!e)||"array"===n||"function"!==n&&(0===e||"number"==typeof e&&e>0&&e-1 in t))}function i(t){var e=pt[t]={};return ot.each(t.match(st)||[],function(t,n){e[n]=!0}),e}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ot.expando+Math.random()}function o(t,n,i){var r;if(i===e&&1===t.nodeType)if(r="data-"+n.replace(yt,"-$1").toLowerCase(),i=t.getAttribute(r),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:vt.test(i)?JSON.parse(i):i)}catch(t){}gt.set(t,n,i)}else i=e;return i}function a(){return!0}function s(){return!1}function u(){try{return B.activeElement}catch(t){}}function l(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function c(t,e,n){if(ot.isFunction(e))return ot.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return ot.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(Dt.test(e))return ot.filter(e,t,n);e=ot.filter(e,t)}return ot.grep(t,function(t){return et.call(e,t)>=0!==n})}function f(t,e){return ot.nodeName(t,"table")&&ot.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function h(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function d(t){var e=Lt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function p(t,e){for(var n=t.length,i=0;n>i;i++)mt.set(t[i],"globalEval",!e||mt.get(e[i],"globalEval"))}function g(t,e){var n,i,r,o,a,s,u,l;if(1===e.nodeType){if(mt.hasData(t)&&(o=mt.access(t),a=ot.extend({},o),l=o.events,mt.set(e,a),l)){delete a.handle,a.events={};for(r in l)for(n=0,i=l[r].length;i>n;n++)ot.event.add(e,r,l[r][n])}gt.hasData(t)&&(s=gt.access(t),u=ot.extend({},s),gt.set(e,u))}}function m(t,n){var i=t.getElementsByTagName?t.getElementsByTagName(n||"*"):t.querySelectorAll?t.querySelectorAll(n||"*"):[];return n===e||n&&ot.nodeName(t,n)?ot.merge([t],i):i}function v(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Rt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function y(t,e){if(e in t)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),i=e,r=Jt.length;r--;)if(e=Jt[r]+n,e in t)return e;return i}function b(t,e){return t=e||t,"none"===ot.css(t,"display")||!ot.contains(t.ownerDocument,t)}function w(e){return t.getComputedStyle(e,null)}function _(t,e){for(var n,i,r,o=[],a=0,s=t.length;s>a;a++)i=t[a],i.style&&(o[a]=mt.get(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&b(i)&&(o[a]=mt.access(i,"olddisplay",S(i.nodeName)))):o[a]||(r=b(i),(n&&"none"!==n||!r)&&mt.set(i,"olddisplay",r?n:ot.css(i,"display"))));for(a=0;s>a;a++)i=t[a],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function x(t,e,n){var i=Bt.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function k(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=ot.css(t,n+Zt[o],!0,r)),i?("content"===n&&(a-=ot.css(t,"padding"+Zt[o],!0,r)),"margin"!==n&&(a-=ot.css(t,"border"+Zt[o]+"Width",!0,r))):(a+=ot.css(t,"padding"+Zt[o],!0,r),"padding"!==n&&(a+=ot.css(t,"border"+Zt[o]+"Width",!0,r)));return a}function M(t,e,n){var i=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=w(t),a=ot.support.boxSizing&&"border-box"===ot.css(t,"boxSizing",!1,o);if(0>=r||null==r){if(r=qt(t,e,o),(0>r||null==r)&&(r=t.style[e]),Wt.test(r))return r;i=a&&(ot.support.boxSizingReliable||r===t.style[e]),r=parseFloat(r)||0}return r+k(t,e,n||(a?"border":"content"),i,o)+"px"}function S(t){var e=B,n=Gt[t];return n||(n=T(t,e),"none"!==n&&n||(Ft=(Ft||ot("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(Ft[0].contentWindow||Ft[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),n=T(t,e),Ft.detach()),Gt[t]=n),n}function T(t,e){var n=ot(e.createElement(t)).appendTo(e.body),i=ot.css(n[0],"display");return n.remove(),i}function C(t,e,n,i){var r;if(ot.isArray(e))ot.each(e,function(e,r){n||te.test(t)?i(t,r):C(t+"["+("object"==typeof r?e:"")+"]",r,n,i)});else if(n||"object"!==ot.type(e))i(t,e);else for(r in e)C(t+"["+r+"]",e[r],n,i)}function D(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(st)||[];if(ot.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function E(t,e,n,i){function r(s){var u;return o[s]=!0,ot.each(t[s]||[],function(t,s){var l=s(e,n,i);return"string"!=typeof l||a||o[l]?a?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},a=t===ve;return r(e.dataTypes[0])||!o["*"]&&r("*")}function N(t,n){var i,r,o=ot.ajaxSettings.flatOptions||{};for(i in n)n[i]!==e&&((o[i]?t:r||(r={}))[i]=n[i]);return r&&ot.extend(!0,t,r),t}function $(t,n,i){for(var r,o,a,s,u=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),r===e&&(r=t.mimeType||n.getResponseHeader("Content-Type"));if(r)for(o in u)if(u[o]&&u[o].test(r)){l.unshift(o);break}if(l[0]in i)a=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==l[0]&&l.unshift(a),i[a]):void 0}function A(t,e,n,i){var r,o,a,s,u,l={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(a=l[u+" "+o]||l["* "+o],!a)for(r in l)if(s=r.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[r]:l[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}function j(){return setTimeout(function(){Se=e}),Se=ot.now()}function P(t,e){ot.each(e,function(e,n){for(var i=($e[e]||[]).concat($e["*"]),r=0,o=i.length;o>r;r++)if(i[r].call(t,e,n))return})}function R(t,e,n){var i,r,o=0,a=Ne.length,s=ot.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=Se||j(),n=Math.max(0,l.startTime+l.duration-e),i=n/l.duration||0,o=1-i,a=0,u=l.tweens.length;u>a;a++)l.tweens[a].run(o);return s.notifyWith(t,[l,o,n]),1>o&&u?n:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:ot.extend({},e),opts:ot.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Se||j(),duration:n.duration,tweens:[],createTween:function(e,n){var i=ot.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)l.tweens[n].run(1);return e?s.resolveWith(t,[l,e]):s.rejectWith(t,[l,e]),this}}),c=l.props;for(I(c,l.opts.specialEasing);a>o;o++)if(i=Ne[o].call(l,t,c,l.opts))return i;return P(l,c),ot.isFunction(l.opts.start)&&l.opts.start.call(t,l),ot.fx.timer(ot.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function I(t,e){var n,i,r,o,a;for(n in t)if(i=ot.camelCase(n),r=e[i],o=t[n],ot.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),a=ot.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function H(t,n,i){var r,o,a,s,u,l,c,f,h,d=this,p=t.style,g={},m=[],v=t.nodeType&&b(t);i.queue||(f=ot._queueHooks(t,"fx"),null==f.unqueued&&(f.unqueued=0,h=f.empty.fire,f.empty.fire=function(){f.unqueued||h()}),f.unqueued++,d.always(function(){d.always(function(){f.unqueued--,ot.queue(t,"fx").length||f.empty.fire()})})),1===t.nodeType&&("height"in n||"width"in n)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ot.css(t,"display")&&"none"===ot.css(t,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]})),u=mt.get(t,"fxshow");for(r in n)if(a=n[r],Ce.exec(a)){if(delete n[r],l=l||"toggle"===a,a===(v?"hide":"show")){if("show"!==a||u===e||u[r]===e)continue;v=!0}m.push(r)}if(s=m.length){u=mt.get(t,"fxshow")||mt.access(t,"fxshow",{}),"hidden"in u&&(v=u.hidden),l&&(u.hidden=!v),v?ot(t).show():d.done(function(){ot(t).hide()}),d.done(function(){var e;mt.remove(t,"fxshow");for(e in g)ot.style(t,e,g[e])});for(r=0;s>r;r++)o=m[r],c=d.createTween(o,v?u[o]:0),g[o]=u[o]||ot.style(t,o),o in u||(u[o]=c.start,v&&(c.end=c.start,c.start="width"===o||"height"===o?1:0))}}function L(t,e,n,i,r){return new L.prototype.init(t,e,n,i,r)}function z(t,e){var n,i={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)n=Zt[r],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function O(t){return ot.isWindow(t)?t:9===t.nodeType&&t.defaultView}var q,F,Y=typeof e,V=t.location,B=t.document,W=B.documentElement,U=t.jQuery,G=t.$,X={},Q=[],Z="2.0.0",J=Q.concat,K=Q.push,tt=Q.slice,et=Q.indexOf,nt=X.toString,it=X.hasOwnProperty,rt=Z.trim,ot=function(t,e){return new ot.fn.init(t,e,q)},at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,st=/\S+/g,ut=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,lt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^-ms-/,ft=/-([\da-z])/gi,ht=function(t,e){return e.toUpperCase()},dt=function(){B.removeEventListener("DOMContentLoaded",dt,!1),t.removeEventListener("load",dt,!1),ot.ready()};ot.fn=ot.prototype={jquery:Z,constructor:ot,init:function(t,n,i){var r,o;if(!t)return this;if("string"==typeof t){if(r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ut.exec(t),!r||!r[1]&&n)return!n||n.jquery?(n||i).find(t):this.constructor(n).find(t);if(r[1]){if(n=n instanceof ot?n[0]:n,ot.merge(this,ot.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:B,!0)),lt.test(r[1])&&ot.isPlainObject(n))for(r in n)ot.isFunction(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}return o=B.getElementById(r[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=B,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ot.isFunction(t)?i.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),ot.makeArray(t,this))},selector:"",length:0,toArray:function(){return tt.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=ot.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return ot.each(this,t,e)},ready:function(t){return ot.ready.promise().done(t),this},slice:function(){return this.pushStack(tt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},map:function(t){return this.pushStack(ot.map(this,function(e,n){return t.call(e,n,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:[].sort,splice:[].splice},ot.fn.init.prototype=ot.fn,ot.extend=ot.fn.extend=function(){var t,n,i,r,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||ot.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(t=arguments[u]))for(n in t)i=s[n],r=t[n],s!==r&&(c&&r&&(ot.isPlainObject(r)||(o=ot.isArray(r)))?(o?(o=!1,a=i&&ot.isArray(i)?i:[]):a=i&&ot.isPlainObject(i)?i:{},s[n]=ot.extend(c,a,r)):r!==e&&(s[n]=r));return s},ot.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===ot&&(t.$=G),e&&t.jQuery===ot&&(t.jQuery=U),ot},isReady:!1,readyWait:1,holdReady:function(t){t?ot.readyWait++:ot.ready(!0)},ready:function(t){(t===!0?--ot.readyWait:ot.isReady)||(ot.isReady=!0,t!==!0&&--ot.readyWait>0||(F.resolveWith(B,[ot]),ot.fn.trigger&&ot(B).trigger("ready").off("ready")))},isFunction:function(t){return"function"===ot.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?X[nt.call(t)]||"object":typeof t},isPlainObject:function(t){if("object"!==ot.type(t)||t.nodeType||ot.isWindow(t))return!1;try{if(t.constructor&&!it.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||B;var i=lt.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=ot.buildFragment([t],e,r),r&&ot(r).remove(),ot.merge([],i.childNodes))},parseJSON:JSON.parse,parseXML:function(t){var n,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,n=i.parseFromString(t,"text/xml")}catch(t){n=e}return n&&!n.getElementsByTagName("parsererror").length||ot.error("Invalid XML: "+t),n},noop:function(){},globalEval:function(t){var e,n=eval;t=ot.trim(t),t&&(1===t.indexOf("use strict")?(e=B.createElement("script"),e.text=t,B.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(ct,"ms-").replace(ft,ht)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var r,o=0,a=t.length,s=n(t);if(i){if(s)for(;a>o&&(r=e.apply(t[o],i),r!==!1);o++);else for(o in t)if(r=e.apply(t[o],i),r===!1)break}else if(s)for(;a>o&&(r=e.call(t[o],o,t[o]),r!==!1);o++);else for(o in t)if(r=e.call(t[o],o,t[o]),r===!1)break;return t},trim:function(t){return null==t?"":rt.call(t)},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?ot.merge(i,"string"==typeof t?[t]:t):K.call(i,t)),i},inArray:function(t,e,n){return null==e?-1:et.call(e,t,n)},merge:function(t,n){var i=n.length,r=t.length,o=0;if("number"==typeof i)for(;i>o;o++)t[r++]=n[o];else for(;n[o]!==e;)t[r++]=n[o++];return t.length=r,t},grep:function(t,e,n){var i,r=[],o=0,a=t.length;for(n=!!n;a>o;o++)i=!!e(t[o],o),n!==i&&r.push(t[o]);return r},map:function(t,e,i){var r,o=0,a=t.length,s=n(t),u=[];if(s)for(;a>o;o++)r=e(t[o],o,i),null!=r&&(u[u.length]=r);else for(o in t)r=e(t[o],o,i),null!=r&&(u[u.length]=r);return J.apply([],u)},guid:1,proxy:function(t,n){var i,r,o;return"string"==typeof n&&(i=t[n],n=t,t=i),ot.isFunction(t)?(r=tt.call(arguments,2),o=function(){return t.apply(n||this,r.concat(tt.call(arguments)))},o.guid=t.guid=t.guid||ot.guid++,o):e},access:function(t,n,i,r,o,a,s){var u=0,l=t.length,c=null==i;if("object"===ot.type(i)){o=!0;for(u in i)ot.access(t,n,u,i[u],!0,a,s)}else if(r!==e&&(o=!0,ot.isFunction(r)||(s=!0),c&&(s?(n.call(t,r),n=null):(c=n,n=function(t,e,n){return c.call(ot(t),n)})),n))for(;l>u;u++)n(t[u],i,s?r:r.call(t[u],u,n(t[u],i)));return o?t:c?n.call(t):l?n(t[0],i):a},now:Date.now,swap:function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=a[o];return r}}),ot.ready.promise=function(e){return F||(F=ot.Deferred(),"complete"===B.readyState?setTimeout(ot.ready):(B.addEventListener("DOMContentLoaded",dt,!1),t.addEventListener("load",dt,!1))),F.promise(e)},ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){X["[object "+e+"]"]=e.toLowerCase()}),q=ot(B),function(t,e){function n(t){return bt.test(t+"")}function i(){var t,e=[];return t=function(n,i){return e.push(n+=" ")>T.cacheLength&&delete t[e.shift()],t[n]=i}}function r(t){return t[O]=!0,t}function o(t){var e=j.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(t,e,n,i){var r,o,a,s,u,l,c,f,h,g;if((e?e.ownerDocument||e:q)!==j&&A(e),e=e||j,n=n||[],!t||"string"!=typeof t)return n;if(1!==(s=e.nodeType)&&9!==s)return[];if(R&&!i){if(r=wt.exec(t))if(a=r[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&z(e,o)&&o.id===a)return n.push(o),n}else{if(r[2])return et.apply(n,e.getElementsByTagName(t)),n;if((a=r[3])&&F.getElementsByClassName&&e.getElementsByClassName)return et.apply(n,e.getElementsByClassName(a)),n}if(F.qsa&&(!I||!I.test(t))){if(f=c=O,h=e,g=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(l=d(t),(c=e.getAttribute("id"))?f=c.replace(kt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",u=l.length;u--;)l[u]=f+p(l[u]);h=pt.test(t)&&e.parentNode||e,g=l.join(",")}if(g)try{return et.apply(n,h.querySelectorAll(g)),n}catch(t){}finally{c||e.removeAttribute("id")}}}return x(t.replace(ft,"$1"),e,n,i)}function s(t,e){var n=e&&t,i=n&&(~e.sourceIndex||Z)-(~t.sourceIndex||Z);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function u(t,n,i){var r;return i?e:(r=t.getAttributeNode(n))&&r.specified?r.value:t[n]===!0?n.toLowerCase():null}function l(t,n,i){var r;return i?e:r=t.getAttribute(n,"type"===n.toLowerCase()?1:2)}function c(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function f(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function h(t){return r(function(e){return e=+e,r(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function d(t,e){var n,i,r,o,s,u,l,c=W[t+" "];if(c)return e?0:c.slice(0);for(s=t,u=[],l=T.preFilter;s;){n&&!(i=ht.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(r=[])),n=!1,(i=dt.exec(s))&&(n=i.shift(),r.push({value:n,type:i[0].replace(ft," ")}),s=s.slice(n.length));for(o in T.filter)!(i=yt[o].exec(s))||l[o]&&!(i=l[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),s=s.slice(n.length));if(!n)break}return e?s.length:s?a.error(t):W(t,u).slice(0)}function p(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function g(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=V++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,u,l,c=Y+" "+o;if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r)if(l=e[O]||(e[O]={}),(u=l[i])&&u[0]===c){if((s=u[1])===!0||s===S)return s===!0}else if(u=l[i]=[c],u[1]=t(e,n,a)||S,u[1]===!0)return!0}}function m(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function v(t,e,n,i,r){for(var o,a=[],s=0,u=t.length,l=null!=e;u>s;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),l&&e.push(s)));return a}function y(t,e,n,i,o,a){return i&&!i[O]&&(i=y(i)),o&&!o[O]&&(o=y(o,a)),r(function(r,a,s,u){var l,c,f,h=[],d=[],p=a.length,g=r||_(e||"*",s.nodeType?[s]:s,[]),m=!t||!r&&e?g:v(g,h,t,s,u),y=n?o||(r?t:p||i)?[]:a:m;if(n&&n(m,y,s,u),i)for(l=v(y,d),i(l,[],s,u),c=l.length;c--;)(f=l[c])&&(y[d[c]]=!(m[d[c]]=f));if(r){if(o||t){if(o){for(l=[],c=y.length;c--;)(f=y[c])&&l.push(m[c]=f);o(null,y=[],l,u)}for(c=y.length;c--;)(f=y[c])&&(l=o?it.call(r,f):h[c])>-1&&(r[l]=!(a[l]=f))}}else y=v(y===a?y.splice(p,y.length):y),o?o(null,a,y,u):et.apply(a,y)})}function b(t){for(var e,n,i,r=t.length,o=T.relative[t[0].type],a=o||T.relative[" "],s=o?1:0,u=g(function(t){return t===e},a,!0),l=g(function(t){return it.call(e,t)>-1},a,!0),c=[function(t,n,i){return!o&&(i||n!==N)||((e=n).nodeType?u(t,n,i):l(t,n,i))}];r>s;s++)if(n=T.relative[t[s].type])c=[g(m(c),n)];else{if(n=T.filter[t[s].type].apply(null,t[s].matches),n[O]){for(i=++s;r>i&&!T.relative[t[i].type];i++);return y(s>1&&m(c),s>1&&p(t.slice(0,s-1)).replace(ft,"$1"),n,i>s&&b(t.slice(s,i)),r>i&&b(t=t.slice(i)),r>i&&p(t))}c.push(n)}return m(c)}function w(t,e){var n=0,i=e.length>0,o=t.length>0,s=function(r,s,u,l,c){var f,h,d,p=[],g=0,m="0",y=r&&[],b=null!=c,w=N,_=r||o&&T.find.TAG("*",c&&s.parentNode||s),x=Y+=null==w?1:Math.random()||.1;for(b&&(N=s!==j&&s,S=n);null!=(f=_[m]);m++){if(o&&f){for(h=0;d=t[h++];)if(d(f,s,u)){l.push(f);break}b&&(Y=x,S=++n)}i&&((f=!d&&f)&&g--,r&&y.push(f))}if(g+=m,i&&m!==g){for(h=0;d=e[h++];)d(y,p,s,u);if(r){if(g>0)for(;m--;)y[m]||p[m]||(p[m]=K.call(l));p=v(p)}et.apply(l,p),b&&!r&&p.length>0&&g+e.length>1&&a.uniqueSort(l)}return b&&(Y=x,N=w),y};return i?r(s):s}function _(t,e,n){for(var i=0,r=e.length;r>i;i++)a(t,e[i],n);return n}function x(t,e,n,i){var r,o,a,s,u,l=d(t);if(!i&&1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===e.nodeType&&R&&T.relative[o[1].type]){if(e=(T.find.ID(a.matches[0].replace(Mt,St),e)||[])[0],!e)return n;t=t.slice(o.shift().value.length)}for(r=yt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!T.relative[s=a.type]);)if((u=T.find[s])&&(i=u(a.matches[0].replace(Mt,St),pt.test(o[0].type)&&e.parentNode||e))){if(o.splice(r,1),t=i.length&&p(o),!t)return et.apply(n,i),n;break}}return E(t,l)(i,e,!R,n,pt.test(t)),n}function k(){}var M,S,T,C,D,E,N,$,A,j,P,R,I,H,L,z,O="sizzle"+-new Date,q=t.document,F={},Y=0,V=0,B=i(),W=i(),U=i(),G=!1,X=function(){return 0},Q=typeof e,Z=1<<31,J=[],K=J.pop,tt=J.push,et=J.push,nt=J.slice,it=J.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",at="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ut=st.replace("w","w#"),lt="\\["+at+"*("+st+")"+at+"*(?:([*^$|!~]?=)"+at+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ut+")|)|)"+at+"*\\]",ct=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+lt.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+at+"+|((?:^|[^\\\\])(?:\\\\.)*)"+at+"+$","g"),ht=new RegExp("^"+at+"*,"+at+"*"),dt=new RegExp("^"+at+"*([>+~]|"+at+")"+at+"*"),pt=new RegExp(at+"*[+~]"),gt=new RegExp("="+at+"*([^\\]'\"]*)"+at+"*\\]","g"),mt=new RegExp(ct),vt=new RegExp("^"+ut+"$"),yt={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+lt),PSEUDO:new RegExp("^"+ct),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+at+"*(even|odd|(([+-]|)(\\d*)n|)"+at+"*(?:([+-]|)"+at+"*(\\d+)|))"+at+"*\\)|)","i"),"boolean":new RegExp("^(?:"+rt+")$","i"),needsContext:new RegExp("^"+at+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+at+"*((?:-\\d)?\\d*)"+at+"*\\)|)(?=[^-]|$)","i")},bt=/^[^{]+\{\s*\[native \w/,wt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_t=/^(?:input|select|textarea|button)$/i,xt=/^h\d$/i,kt=/'|\\/g,Mt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,St=function(t,e){var n="0x"+e-65536;return n!==n?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{et.apply(J=nt.call(q.childNodes),q.childNodes),J[q.childNodes.length].nodeType}catch(t){et={apply:J.length?function(t,e){tt.apply(t,nt.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}D=a.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},A=a.setDocument=function(t){var i=t?t.ownerDocument||t:q;return i!==j&&9===i.nodeType&&i.documentElement?(j=i,P=i.documentElement,R=!D(i),F.getElementsByTagName=o(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),F.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),F.getElementsByClassName=o(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),F.sortDetached=o(function(t){return 1&t.compareDocumentPosition(j.createElement("div"))}),F.getById=o(function(t){return P.appendChild(t).id=O,!i.getElementsByName||!i.getElementsByName(O).length}),F.getById?(T.find.ID=function(t,e){if(typeof e.getElementById!==Q&&R){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},T.filter.ID=function(t){var e=t.replace(Mt,St);return function(t){return t.getAttribute("id")===e}}):(T.find.ID=function(t,n){if(typeof n.getElementById!==Q&&R){var i=n.getElementById(t);return i?i.id===t||typeof i.getAttributeNode!==Q&&i.getAttributeNode("id").value===t?[i]:e:[]}},T.filter.ID=function(t){var e=t.replace(Mt,St);return function(t){var n=typeof t.getAttributeNode!==Q&&t.getAttributeNode("id");return n&&n.value===e}}),T.find.TAG=F.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==Q?e.getElementsByTagName(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},T.find.CLASS=F.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==Q&&R?e.getElementsByClassName(t):void 0},H=[],I=[],(F.qsa=n(i.querySelectorAll))&&(o(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||I.push("\\["+at+"*(?:value|"+rt+")"),t.querySelectorAll(":checked").length||I.push(":checked")}),o(function(t){var e=j.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&I.push("[*^$]="+at+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),I.push(",.*:")})),(F.matchesSelector=n(L=P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&o(function(t){F.disconnectedMatch=L.call(t,"div"),L.call(t,"[s!='']:x"),H.push("!=",ct)}),I=I.length&&new RegExp(I.join("|")),H=H.length&&new RegExp(H.join("|")),z=n(P.contains)||P.compareDocumentPosition?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},X=P.compareDocumentPosition?function(t,e){if(t===e)return G=!0,0;var n=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e);return n?1&n||!F.sortDetached&&e.compareDocumentPosition(t)===n?t===i||z(q,t)?-1:e===i||z(q,e)?1:$?it.call($,t)-it.call($,e):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var n,r=0,o=t.parentNode,a=e.parentNode,u=[t],l=[e];if(t===e)return G=!0,0;if(!o||!a)return t===i?-1:e===i?1:o?-1:a?1:$?it.call($,t)-it.call($,e):0;if(o===a)return s(t,e);for(n=t;n=n.parentNode;)u.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;u[r]===l[r];)r++;return r?s(u[r],l[r]):u[r]===q?-1:l[r]===q?1:0},j):j},a.matches=function(t,e){return a(t,null,null,e)},a.matchesSelector=function(t,e){if((t.ownerDocument||t)!==j&&A(t),e=e.replace(gt,"='$1']"),!(!F.matchesSelector||!R||H&&H.test(e)||I&&I.test(e)))try{var n=L.call(t,e);if(n||F.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return a(e,j,null,[t]).length>0},a.contains=function(t,e){return(t.ownerDocument||t)!==j&&A(t),z(t,e)},a.attr=function(t,n){(t.ownerDocument||t)!==j&&A(t);var i=T.attrHandle[n.toLowerCase()],r=i&&i(t,n,!R);return r===e?F.attributes||!R?t.getAttribute(n):(r=t.getAttributeNode(n))&&r.specified?r.value:null:r},a.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},a.uniqueSort=function(t){var e,n=[],i=0,r=0;if(G=!F.detectDuplicates,$=!F.sortStable&&t.slice(0),t.sort(X),G){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return t},C=a.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=C(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i];i++)n+=C(e);return n},T=a.selectors={cacheLength:50,createPseudo:r,match:yt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Mt,St),t[3]=(t[4]||t[5]||"").replace(Mt,St),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||a.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&a.error(t[0]),t},PSEUDO:function(t){var e,n=!t[5]&&t[2];return yt.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:n&&mt.test(n)&&(e=d(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Mt,St).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=B[t+" "];return e||(e=new RegExp("(^|"+at+")"+t+"("+at+"|$)"))&&B(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==Q&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=a.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,f,h,d,p,g=o!==a?"nextSibling":"previousSibling",m=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!u&&!s;if(m){if(o){for(;g;){for(f=e;f=f[g];)if(s?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(c=m[O]||(m[O]={}),l=c[t]||[],d=l[0]===Y&&l[1],h=l[0]===Y&&l[2],f=d&&m.childNodes[d];f=++d&&f&&f[g]||(h=d=0)||p.pop();)if(1===f.nodeType&&++h&&f===e){c[t]=[Y,d,h];break}}else if(y&&(l=(e[O]||(e[O]={}))[t])&&l[0]===Y)h=l[1];else for(;(f=++d&&f&&f[g]||(h=d=0)||p.pop())&&((s?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++h||(y&&((f[O]||(f[O]={}))[t]=[Y,h]),f!==e)););return h-=r,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(t,e){var n,i=T.pseudos[t]||T.setFilters[t.toLowerCase()]||a.error("unsupported pseudo: "+t);return i[O]?i(e):i.length>1?(n=[t,t,"",e],T.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,n){for(var r,o=i(t,e),a=o.length;a--;)r=it.call(t,o[a]),t[r]=!(n[r]=o[a])}):function(t){return i(t,0,n)}):i}},pseudos:{not:r(function(t){var e=[],n=[],i=E(t.replace(ft,"$1"));return i[O]?r(function(t,e,n,r){for(var o,a=i(t,null,r,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),!n.pop()}}),has:r(function(t){return function(e){return a(t,e).length>0}}),contains:r(function(t){return function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:r(function(t){return vt.test(t||"")||a.error("unsupported lang: "+t),t=t.replace(Mt,St).toLowerCase(),function(e){var n;do if(n=R?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===P},focus:function(t){return t===j.activeElement&&(!j.hasFocus||j.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!T.pseudos.empty(t)},header:function(t){return xt.test(t.nodeName)},input:function(t){return _t.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:h(function(){return[0]}),last:h(function(t,e){return[e-1]}),eq:h(function(t,e,n){return[0>n?n+e:n]}),even:h(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:h(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:h(function(t,e,n){
for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:h(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}};for(M in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[M]=c(M);for(M in{submit:!0,reset:!0})T.pseudos[M]=f(M);E=a.compile=function(t,e){var n,i=[],r=[],o=U[t+" "];if(!o){for(e||(e=d(t)),n=e.length;n--;)o=b(e[n]),o[O]?i.push(o):r.push(o);o=U(t,w(r,i))}return o},T.pseudos.nth=T.pseudos.eq,k.prototype=T.filters=T.pseudos,T.setFilters=new k,F.sortStable=O.split("").sort(X).join("")===O,A(),[0,0].sort(X),F.detectDuplicates=G,o(function(t){if(t.innerHTML="<a href='#'></a>","#"!==t.firstChild.getAttribute("href"))for(var e="type|href|height|width".split("|"),n=e.length;n--;)T.attrHandle[e[n]]=l}),o(function(t){if(null!=t.getAttribute("disabled"))for(var e=rt.split("|"),n=e.length;n--;)T.attrHandle[e[n]]=u}),ot.find=a,ot.expr=a.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=a.uniqueSort,ot.text=a.getText,ot.isXMLDoc=a.isXML,ot.contains=a.contains}(t);var pt={};ot.Callbacks=function(t){t="string"==typeof t?pt[t]||i(t):ot.extend({},t);var n,r,o,a,s,u,l=[],c=!t.once&&[],f=function(e){for(n=t.memory&&e,r=!0,u=a||0,a=0,s=l.length,o=!0;l&&s>u;u++)if(l[u].apply(e[0],e[1])===!1&&t.stopOnFalse){n=!1;break}o=!1,l&&(c?c.length&&f(c.shift()):n?l=[]:h.disable())},h={add:function(){if(l){var e=l.length;!function i(e){ot.each(e,function(e,n){var r=ot.type(n);"function"===r?t.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),o?s=l.length:n&&(a=e,f(n))}return this},remove:function(){return l&&ot.each(arguments,function(t,e){for(var n;(n=ot.inArray(e,l,n))>-1;)l.splice(n,1),o&&(s>=n&&s--,u>=n&&u--)}),this},has:function(t){return t?ot.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=n=e,this},disabled:function(){return!l},lock:function(){return c=e,n||h.disable(),this},locked:function(){return!c},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!l||r&&!c||(o?c.push(e):f(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h},ot.extend({Deferred:function(t){var e=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ot.Deferred(function(n){ot.each(e,function(e,o){var a=o[0],s=ot.isFunction(t[e])&&t[e];r[o[1]](function(){var t=s&&s.apply(this,arguments);t&&ot.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ot.extend(t,i):i}},r={};return i.pipe=i.then,ot.each(e,function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=tt.call(arguments),a=o.length,s=1!==a||t&&ot.isFunction(t.promise)?a:0,u=1===s?t:ot.Deferred(),l=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?tt.call(arguments):r,i===e?u.notifyWith(n,i):--s||u.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&ot.isFunction(o[r].promise)?o[r].promise().done(l(r,i,o)).fail(u.reject).progress(l(r,n,e)):--s;return s||u.resolveWith(i,o),u.promise()}}),ot.support=function(e){var n=B.createElement("input"),i=B.createDocumentFragment(),r=B.createElement("div"),o=B.createElement("select"),a=o.appendChild(B.createElement("option"));return n.type?(n.type="checkbox",e.checkOn=""!==n.value,e.optSelected=a.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,n.checked=!0,e.noCloneChecked=n.cloneNode(!0).checked,o.disabled=!0,e.optDisabled=!a.disabled,n=B.createElement("input"),n.value="t",n.type="radio",e.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),i.appendChild(n),e.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in t,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===r.style.backgroundClip,ot(function(){var n,i,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=B.getElementsByTagName("body")[0];a&&(n=B.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",ot.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===r.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(r,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(r,null)||{width:"4px"}).width,i=r.appendChild(B.createElement("div")),i.style.cssText=r.style.cssText=o,i.style.marginRight=i.style.width="0",r.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(i,null)||{}).marginRight)),a.removeChild(n))}),e):e}({});var gt,mt,vt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,yt=/([A-Z])/g;r.uid=1,r.accepts=function(t){return!t.nodeType||1===t.nodeType||9===t.nodeType},r.prototype={key:function(t){if(!r.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=r.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,ot.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,r=this.key(t),o=this.cache[r];if("string"==typeof e)o[e]=n;else if(ot.isEmptyObject(o))this.cache[r]=e;else for(i in e)o[i]=e[i]},get:function(t,n){var i=this.cache[this.key(t)];return n===e?i:i[n]},access:function(t,n,i){return n===e||n&&"string"==typeof n&&i===e?this.get(t,n):(this.set(t,n,i),i!==e?i:n)},remove:function(t,n){var i,r,o=this.key(t),a=this.cache[o];if(n===e)this.cache[o]={};else{ot.isArray(n)?r=n.concat(n.map(ot.camelCase)):n in a?r=[n]:(r=ot.camelCase(n),r=r in a?[r]:r.match(st)||[]),i=r.length;for(;i--;)delete a[r[i]]}},hasData:function(t){return!ot.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){delete this.cache[this.key(t)]}},gt=new r,mt=new r,ot.extend({acceptData:r.accepts,hasData:function(t){return gt.hasData(t)||mt.hasData(t)},data:function(t,e,n){return gt.access(t,e,n)},removeData:function(t,e){gt.remove(t,e)},_data:function(t,e,n){return mt.access(t,e,n)},_removeData:function(t,e){mt.remove(t,e)}}),ot.fn.extend({data:function(t,n){var i,r,a=this[0],s=0,u=null;if(t===e){if(this.length&&(u=gt.get(a),1===a.nodeType&&!mt.get(a,"hasDataAttrs"))){for(i=a.attributes;s<i.length;s++)r=i[s].name,0===r.indexOf("data-")&&(r=ot.camelCase(r.substring(5)),o(a,r,u[r]));mt.set(a,"hasDataAttrs",!0)}return u}return"object"==typeof t?this.each(function(){gt.set(this,t)}):ot.access(this,function(n){var i,r=ot.camelCase(t);if(a&&n===e){if(i=gt.get(a,t),i!==e)return i;if(i=gt.get(a,r),i!==e)return i;if(i=o(a,r,e),i!==e)return i}else this.each(function(){var i=gt.get(this,r);gt.set(this,r,n),-1!==t.indexOf("-")&&i!==e&&gt.set(this,t,n)})},null,n,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){gt.remove(this,t)})}}),ot.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=mt.get(t,e),n&&(!i||ot.isArray(n)?i=mt.access(t,e,ot.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=ot.queue(t,e),i=n.length,r=n.shift(),o=ot._queueHooks(t,e),a=function(){ot.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),o.cur=r,r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return mt.get(t,n)||mt.access(t,n,{empty:ot.Callbacks("once memory").add(function(){mt.remove(t,[e+"queue",n])})})}}),ot.fn.extend({queue:function(t,n){var i=2;return"string"!=typeof t&&(n=t,t="fx",i--),arguments.length<i?ot.queue(this[0],t):n===e?this:this.each(function(){var e=ot.queue(this,t,n);ot._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ot.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ot.dequeue(this,t)})},delay:function(t,e){return t=ot.fx?ot.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){var i,r=1,o=ot.Deferred(),a=this,s=this.length,u=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof t&&(n=t,t=e),t=t||"fx";s--;)i=mt.get(a[s],t+"queueHooks"),i&&i.empty&&(r++,i.empty.add(u));return u(),o.promise(n)}});var bt,wt,_t=/[\t\r\n]/g,xt=/\r/g,kt=/^(?:input|select|textarea|button)$/i;ot.fn.extend({attr:function(t,e){return ot.access(this,ot.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ot.removeAttr(this,t)})},prop:function(t,e){return ot.access(this,ot.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[ot.propFix[t]||t]})},addClass:function(t){var e,n,i,r,o,a=0,s=this.length,u="string"==typeof t&&t;if(ot.isFunction(t))return this.each(function(e){ot(this).addClass(t.call(this,e,this.className))});if(u)for(e=(t||"").match(st)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(_t," "):" ")){for(o=0;r=e[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");n.className=ot.trim(i)}return this},removeClass:function(t){var e,n,i,r,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof t&&t;if(ot.isFunction(t))return this.each(function(e){ot(this).removeClass(t.call(this,e,this.className))});if(u)for(e=(t||"").match(st)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(_t," "):"")){for(o=0;r=e[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");n.className=t?ot.trim(i):""}return this},toggleClass:function(t,e){var n=typeof t,i="boolean"==typeof e;return this.each(ot.isFunction(t)?function(n){ot(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var r,o=0,a=ot(this),s=e,u=t.match(st)||[];r=u[o++];)s=i?s:!a.hasClass(r),a[s?"addClass":"removeClass"](r);else n!==Y&&"boolean"!==n||(this.className&&mt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":mt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(_t," ").indexOf(e)>=0)return!0;return!1},val:function(t){var n,i,r,o=this[0];return arguments.length?(r=ot.isFunction(t),this.each(function(i){var o,a=ot(this);1===this.nodeType&&(o=r?t.call(this,i,a.val()):t,null==o?o="":"number"==typeof o?o+="":ot.isArray(o)&&(o=ot.map(o,function(t){return null==t?"":t+""})),n=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==e||(this.value=o))})):o?(n=ot.valHooks[o.type]||ot.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==e?i:(i=o.value,"string"==typeof i?i.replace(xt,""):null==i?"":i)):void 0}}),ot.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:i.length,u=0>r?s:o?r:0;s>u;u++)if(n=i[u],!(!n.selected&&u!==r||(ot.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ot.nodeName(n.parentNode,"optgroup"))){if(e=ot(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=ot.makeArray(e),a=r.length;a--;)i=r[a],(i.selected=ot.inArray(ot(i).val(),o)>=0)&&(n=!0);return n||(t.selectedIndex=-1),o}}},attr:function(t,n,i){var r,o,a=t.nodeType;return t&&3!==a&&8!==a&&2!==a?typeof t.getAttribute===Y?ot.prop(t,n,i):(1===a&&ot.isXMLDoc(t)||(n=n.toLowerCase(),r=ot.attrHooks[n]||(ot.expr.match["boolean"].test(n)?wt:bt)),i===e?r&&"get"in r&&null!==(o=r.get(t,n))?o:(o=ot.find.attr(t,n),null==o?e:o):null!==i?r&&"set"in r&&(o=r.set(t,i,n))!==e?o:(t.setAttribute(n,i+""),i):void ot.removeAttr(t,n)):void 0},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(st);if(o&&1===t.nodeType)for(;n=o[r++];)i=ot.propFix[n]||n,ot.expr.match["boolean"].test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!ot.support.radioValue&&"radio"===e&&ot.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,n,i){var r,o,a,s=t.nodeType;return t&&3!==s&&8!==s&&2!==s?(a=1!==s||!ot.isXMLDoc(t),a&&(n=ot.propFix[n]||n,o=ot.propHooks[n]),i!==e?o&&"set"in o&&(r=o.set(t,i,n))!==e?r:t[n]=i:o&&"get"in o&&null!==(r=o.get(t,n))?r:t[n]):void 0},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||kt.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),wt={set:function(t,e,n){return e===!1?ot.removeAttr(t,n):t.setAttribute(n,n),n}},ot.each(ot.expr.match["boolean"].source.match(/\w+/g),function(t,n){var i=ot.expr.attrHandle[n]||ot.find.attr;ot.expr.attrHandle[n]=function(t,n,r){var o=ot.expr.attrHandle[n],a=r?e:(ot.expr.attrHandle[n]=e)!=i(t,n,r)?n.toLowerCase():null;return ot.expr.attrHandle[n]=o,a}}),ot.support.optSelected||(ot.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(t,e){return ot.isArray(e)?t.checked=ot.inArray(ot(t).val(),e)>=0:void 0}},ot.support.checkOn||(ot.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Mt=/^key/,St=/^(?:mouse|contextmenu)|click/,Tt=/^(?:focusinfocus|focusoutblur)$/,Ct=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(t,n,i,r,o){var a,s,u,l,c,f,h,d,p,g,m,v=mt.get(t);if(v){for(i.handler&&(a=i,i=a.handler,o=a.selector),i.guid||(i.guid=ot.guid++),(l=v.events)||(l=v.events={}),(s=v.handle)||(s=v.handle=function(t){return typeof ot===Y||t&&ot.event.triggered===t.type?e:ot.event.dispatch.apply(s.elem,arguments)},s.elem=t),n=(n||"").match(st)||[""],c=n.length;c--;)u=Ct.exec(n[c])||[],p=m=u[1],g=(u[2]||"").split(".").sort(),p&&(h=ot.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=ot.event.special[p]||{},f=ot.extend({type:p,origType:m,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&ot.expr.match.needsContext.test(o),namespace:g.join(".")},a),(d=l[p])||(d=l[p]=[],d.delegateCount=0,h.setup&&h.setup.call(t,r,g,s)!==!1||t.addEventListener&&t.addEventListener(p,s,!1)),h.add&&(h.add.call(t,f),f.handler.guid||(f.handler.guid=i.guid)),o?d.splice(d.delegateCount++,0,f):d.push(f),ot.event.global[p]=!0);t=null}},remove:function(t,e,n,i,r){var o,a,s,u,l,c,f,h,d,p,g,m=mt.hasData(t)&&mt.get(t);if(m&&(u=m.events)){for(e=(e||"").match(st)||[""],l=e.length;l--;)if(s=Ct.exec(e[l])||[],d=g=s[1],p=(s[2]||"").split(".").sort(),d){for(f=ot.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,h=u[d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=h.length;o--;)c=h[o],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,f.remove&&f.remove.call(t,c));a&&!h.length&&(f.teardown&&f.teardown.call(t,p,m.handle)!==!1||ot.removeEvent(t,d,m.handle),delete u[d])}else for(d in u)ot.event.remove(t,d+e[l],n,i,!0);ot.isEmptyObject(u)&&(delete m.handle,mt.remove(t,"events"))}},trigger:function(n,i,r,o){var a,s,u,l,c,f,h,d=[r||B],p=it.call(n,"type")?n.type:n,g=it.call(n,"namespace")?n.namespace.split("."):[];if(s=u=r=r||B,3!==r.nodeType&&8!==r.nodeType&&!Tt.test(p+ot.event.triggered)&&(p.indexOf(".")>=0&&(g=p.split("."),p=g.shift(),g.sort()),c=p.indexOf(":")<0&&"on"+p,n=n[ot.expando]?n:new ot.Event(p,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=e,n.target||(n.target=r),i=null==i?[n]:ot.makeArray(i,[n]),h=ot.event.special[p]||{},o||!h.trigger||h.trigger.apply(r,i)!==!1)){if(!o&&!h.noBubble&&!ot.isWindow(r)){for(l=h.delegateType||p,Tt.test(l+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),u=s;u===(r.ownerDocument||B)&&d.push(u.defaultView||u.parentWindow||t)}for(a=0;(s=d[a++])&&!n.isPropagationStopped();)n.type=a>1?l:h.bindType||p,f=(mt.get(s,"events")||{})[n.type]&&mt.get(s,"handle"),f&&f.apply(s,i),f=c&&s[c],f&&ot.acceptData(s)&&f.apply&&f.apply(s,i)===!1&&n.preventDefault();return n.type=p,o||n.isDefaultPrevented()||h._default&&h._default.apply(d.pop(),i)!==!1||!ot.acceptData(r)||c&&ot.isFunction(r[p])&&!ot.isWindow(r)&&(u=r[c],u&&(r[c]=null),ot.event.triggered=p,r[p](),ot.event.triggered=e,u&&(r[c]=u)),n.result}},dispatch:function(t){t=ot.event.fix(t);var n,i,r,o,a,s=[],u=tt.call(arguments),l=(mt.get(this,"events")||{})[t.type]||[],c=ot.event.special[t.type]||{};if(u[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(s=ot.event.handlers.call(this,t,l),n=0;(o=s[n++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,i=0;(a=o.handlers[i++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(a.namespace)||(t.handleObj=a,t.data=a.data,r=((ot.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u),r!==e&&(t.result=r)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,n){var i,r,o,a,s=[],u=n.delegateCount,l=t.target;if(u&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(r=[],i=0;u>i;i++)a=n[i],o=a.selector+" ",r[o]===e&&(r[o]=a.needsContext?ot(o,this).index(l)>=0:ot.find(o,this,null,[l]).length),r[o]&&r.push(a);r.length&&s.push({elem:l,handlers:r})}return u<n.length&&s.push({elem:this,handlers:n.slice(u)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,n){var i,r,o,a=n.button;return null==t.pageX&&null!=n.clientX&&(i=t.target.ownerDocument||B,r=i.documentElement,o=i.body,t.pageX=n.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),t.pageY=n.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[ot.expando])return t;var e,n,i,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=St.test(r)?this.mouseHooks:Mt.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new ot.Event(o),e=i.length;e--;)n=i[e],t[n]=o[n];return 3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ot.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return ot.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var r=ot.extend(new ot.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?ot.event.trigger(r,null,e):ot.event.dispatch.call(e,r),r.isDefaultPrevented()&&n.preventDefault()}},ot.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},ot.Event=function(t,e){return this instanceof ot.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.getPreventDefault&&t.getPreventDefault()?a:s):this.type=t,e&&ot.extend(this,e),this.timeStamp=t&&t.timeStamp||ot.now(),void(this[ot.expando]=!0)):new ot.Event(t,e)},ot.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=a,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=a,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){ot.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||ot.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),ot.support.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(t,e){var n=0,i=function(t){ot.event.simulate(e,t.target,ot.event.fix(t),!0)};ot.event.special[e]={setup:function(){0===n++&&B.addEventListener(t,i,!0)},teardown:function(){0===--n&&B.removeEventListener(t,i,!0)}}}),ot.fn.extend({on:function(t,n,i,r,o){var a,u;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=e);for(u in t)this.on(u,n,i,t[u],o);return this}if(null==i&&null==r?(r=n,i=n=e):null==r&&("string"==typeof n?(r=i,i=e):(r=i,i=n,n=e)),r===!1)r=s;else if(!r)return this;return 1===o&&(a=r,r=function(t){return ot().off(t),a.apply(this,arguments)},r.guid=a.guid||(a.guid=ot.guid++)),this.each(function(){ot.event.add(this,t,r,i,n)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,n,i){var r,o;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,ot(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(o in t)this.off(o,n,t[o]);return this}return n!==!1&&"function"!=typeof n||(i=n,n=e),i===!1&&(i=s),this.each(function(){ot.event.remove(this,t,i,n)})},trigger:function(t,e){return this.each(function(){ot.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?ot.event.trigger(t,e,n,!0):void 0}});var Dt=/^.[^:#\[\.,]*$/,Et=ot.expr.match.needsContext,Nt={children:!0,contents:!0,next:!0,prev:!0};ot.fn.extend({find:function(t){var e,n,i,r=this.length;if("string"!=typeof t)return e=this,this.pushStack(ot(t).filter(function(){for(i=0;r>i;i++)if(ot.contains(e[i],this))return!0}));for(n=[],i=0;r>i;i++)ot.find(t,this[i],n);return n=this.pushStack(r>1?ot.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+t,n},has:function(t){var e=ot(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(ot.contains(this,e[t]))return!0})},not:function(t){return this.pushStack(c(this,t||[],!0))},filter:function(t){return this.pushStack(c(this,t||[],!1))},is:function(t){return!!t&&("string"==typeof t?Et.test(t)?ot(t,this.context).index(this[0])>=0:ot.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=Et.test(t)||"string"!=typeof t?ot(t,e||this.context):0;r>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ot.find.matchesSelector(n,t))){n=o.push(n);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(t){return t?"string"==typeof t?et.call(ot(t),this[0]):et.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var n="string"==typeof t?ot(t,e):ot.makeArray(t&&t.nodeType?[t]:t),i=ot.merge(this.get(),n);return this.pushStack(ot.unique(i))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ot.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ot.dir(t,"parentNode")},parentsUntil:function(t,e,n){return ot.dir(t,"parentNode",n)},next:function(t){return l(t,"nextSibling")},prev:function(t){return l(t,"previousSibling")},nextAll:function(t){return ot.dir(t,"nextSibling")},prevAll:function(t){return ot.dir(t,"previousSibling")},nextUntil:function(t,e,n){return ot.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return ot.dir(t,"previousSibling",n)},siblings:function(t){return ot.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return ot.sibling(t.firstChild)},contents:function(t){return ot.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:ot.merge([],t.childNodes)}},function(t,e){ot.fn[t]=function(n,i){var r=ot.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=ot.filter(i,r)),this.length>1&&(Nt[t]||ot.unique(r),"p"===t[0]&&r.reverse()),this.pushStack(r)}}),ot.extend({filter:function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?ot.find.matchesSelector(i,t)?[i]:[]:ot.find.matches(t,ot.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,n,i){for(var r=[],o=i!==e;(t=t[n])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&ot(t).is(i))break;r.push(t)}return r},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}});var $t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,At=/<([\w:]+)/,jt=/<|&#?\w+;/,Pt=/<(?:script|style|link)/i,Rt=/^(?:checkbox|radio)$/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Ht=/^$|\/(?:java|ecma)script/i,Lt=/^true\/(.*)/,zt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ot={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ot.optgroup=Ot.option,Ot.tbody=Ot.tfoot=Ot.colgroup=Ot.caption=Ot.col=Ot.thead,Ot.th=Ot.td,ot.fn.extend({text:function(t){return ot.access(this,function(t){return t===e?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||B).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,i=t?ot.filter(t,this):this,r=0;null!=(n=i[r]);r++)e||1!==n.nodeType||ot.cleanData(m(n)),n.parentNode&&(e&&ot.contains(n.ownerDocument,n)&&p(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(ot.cleanData(m(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return ot.clone(this,t,e)})},html:function(t){return ot.access(this,function(t){var n=this[0]||{},i=0,r=this.length;if(t===e&&1===n.nodeType)return n.innerHTML;if("string"==typeof t&&!Pt.test(t)&&!Ot[(At.exec(t)||["",""])[1].toLowerCase()]){t=t.replace($t,"<$1></$2>");try{for(;r>i;i++)n=this[i]||{},1===n.nodeType&&(ot.cleanData(m(n,!1)),n.innerHTML=t);n=0}catch(t){}}n&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=ot.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(n){var i=t[e++],r=t[e++];r&&(ot(this).remove(),r.insertBefore(n,i))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,n){t=J.apply([],t);var i,r,o,a,s,u,l=0,c=this.length,f=this,p=c-1,g=t[0],v=ot.isFunction(g);if(v||!(1>=c||"string"!=typeof g||ot.support.checkClone)&&It.test(g))return this.each(function(i){var r=f.eq(i);v&&(t[0]=g.call(this,i,r.html())),r.domManip(t,e,n)});if(c&&(i=ot.buildFragment(t,this[0].ownerDocument,!1,!n&&this),r=i.firstChild,1===i.childNodes.length&&(i=r),r)){for(o=ot.map(m(i,"script"),h),a=o.length;c>l;l++)s=i,l!==p&&(s=ot.clone(s,!0,!0),a&&ot.merge(o,m(s,"script"))),e.call(this[l],s,l);if(a)for(u=o[o.length-1].ownerDocument,ot.map(o,d),l=0;a>l;l++)s=o[l],Ht.test(s.type||"")&&!mt.access(s,"globalEval")&&ot.contains(u,s)&&(s.src?ot._evalUrl(s.src):ot.globalEval(s.textContent.replace(zt,"")))}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ot.fn[t]=function(t){for(var n,i=[],r=ot(t),o=r.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),ot(r[a])[e](n),K.apply(i,n.get());return this.pushStack(i)}}),ot.extend({clone:function(t,e,n){var i,r,o,a,s=t.cloneNode(!0),u=ot.contains(t.ownerDocument,t);if(!(ot.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ot.isXMLDoc(t)))for(a=m(s),o=m(t),i=0,r=o.length;r>i;i++)v(o[i],a[i]);if(e)if(n)for(o=o||m(t),a=a||m(s),i=0,r=o.length;r>i;i++)g(o[i],a[i]);else g(t,s);return a=m(s,"script"),a.length>0&&p(a,!u&&m(t,"script")),s},buildFragment:function(t,e,n,i){for(var r,o,a,s,u,l,c=0,f=t.length,h=e.createDocumentFragment(),d=[];f>c;c++)if(r=t[c],r||0===r)if("object"===ot.type(r))ot.merge(d,r.nodeType?[r]:r);else if(jt.test(r)){for(o=o||h.appendChild(e.createElement("div")),a=(At.exec(r)||["",""])[1].toLowerCase(),s=Ot[a]||Ot._default,o.innerHTML=s[1]+r.replace($t,"<$1></$2>")+s[2],l=s[0];l--;)o=o.firstChild;ot.merge(d,o.childNodes),o=h.firstChild,o.textContent=""}else d.push(e.createTextNode(r));for(h.textContent="",c=0;r=d[c++];)if((!i||-1===ot.inArray(r,i))&&(u=ot.contains(r.ownerDocument,r),o=m(h.appendChild(r),"script"),u&&p(o),n))for(l=0;r=o[l++];)Ht.test(r.type||"")&&n.push(r);return h},cleanData:function(t){for(var e,n,i,r=t.length,o=0,a=ot.event.special;r>o;o++){if(n=t[o],ot.acceptData(n)&&(e=mt.access(n)))for(i in e.events)a[i]?ot.event.remove(n,i):ot.removeEvent(n,i,e.handle);gt.discard(n),mt.discard(n)}},_evalUrl:function(t){return ot.ajax({url:t,type:"GET",dataType:"text",async:!1,global:!1,success:ot.globalEval})}}),ot.fn.extend({wrapAll:function(t){var e;return ot.isFunction(t)?this.each(function(e){ot(this).wrapAll(t.call(this,e))}):(this[0]&&(e=ot(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(ot.isFunction(t)?function(e){ot(this).wrapInner(t.call(this,e))}:function(){var e=ot(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=ot.isFunction(t);return this.each(function(n){ot(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}});var qt,Ft,Yt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,Bt=new RegExp("^("+at+")(.*)$","i"),Wt=new RegExp("^("+at+")(?!px)[a-z%]+$","i"),Ut=new RegExp("^([+-])=("+at+")","i"),Gt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Qt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"];ot.fn.extend({css:function(t,n){return ot.access(this,function(t,n,i){var r,o,a={},s=0;if(ot.isArray(n)){for(r=w(t),o=n.length;o>s;s++)a[n[s]]=ot.css(t,n[s],!1,r);return a}return i!==e?ot.style(t,n,i):ot.css(t,n)},t,n,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:b(this))?ot(this).show():ot(this).hide()})}}),ot.extend({cssHooks:{opacity:{get:function(t,e){
if(e){var n=qt(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,n,i,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s,u=ot.camelCase(n),l=t.style;return n=ot.cssProps[u]||(ot.cssProps[u]=y(l,u)),s=ot.cssHooks[n]||ot.cssHooks[u],i===e?s&&"get"in s&&(o=s.get(t,!1,r))!==e?o:l[n]:(a=typeof i,"string"===a&&(o=Ut.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(ot.css(t,n)),a="number"),void(null==i||"number"===a&&isNaN(i)||("number"!==a||ot.cssNumber[u]||(i+="px"),ot.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(i=s.set(t,i,r))===e||(l[n]=i))))}},css:function(t,n,i,r){var o,a,s,u=ot.camelCase(n);return n=ot.cssProps[u]||(ot.cssProps[u]=y(t.style,u)),s=ot.cssHooks[n]||ot.cssHooks[u],s&&"get"in s&&(o=s.get(t,!0,i)),o===e&&(o=qt(t,n,r)),"normal"===o&&n in Qt&&(o=Qt[n]),""===i||i?(a=parseFloat(o),i===!0||ot.isNumeric(a)?a||0:o):o}}),qt=function(t,n,i){var r,o,a,s=i||w(t),u=s?s.getPropertyValue(n)||s[n]:e,l=t.style;return s&&(""!==u||ot.contains(t.ownerDocument,t)||(u=ot.style(t,n)),Wt.test(u)&&Vt.test(n)&&(r=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=r,l.minWidth=o,l.maxWidth=a)),u},ot.each(["height","width"],function(t,e){ot.cssHooks[e]={get:function(t,n,i){return n?0===t.offsetWidth&&Yt.test(ot.css(t,"display"))?ot.swap(t,Xt,function(){return M(t,e,i)}):M(t,e,i):void 0},set:function(t,n,i){var r=i&&w(t);return x(t,n,i?k(t,e,i,ot.support.boxSizing&&"border-box"===ot.css(t,"boxSizing",!1,r),r):0)}}}),ot(function(){ot.support.reliableMarginRight||(ot.cssHooks.marginRight={get:function(t,e){return e?ot.swap(t,{display:"inline-block"},qt,[t,"marginRight"]):void 0}}),!ot.support.pixelPosition&&ot.fn.position&&ot.each(["top","left"],function(t,e){ot.cssHooks[e]={get:function(t,n){return n?(n=qt(t,e),Wt.test(n)?ot(t).position()[e]+"px":n):void 0}}})}),ot.expr&&ot.expr.filters&&(ot.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},ot.expr.filters.visible=function(t){return!ot.expr.filters.hidden(t)}),ot.each({margin:"",padding:"",border:"Width"},function(t,e){ot.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[t+Zt[i]+e]=o[i]||o[i-2]||o[0];return r}},Vt.test(t)||(ot.cssHooks[t+e].set=x)});var Kt=/%20/g,te=/\[\]$/,ee=/\r?\n/g,ne=/^(?:submit|button|image|reset|file)$/i,ie=/^(?:input|select|textarea|keygen)/i;ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ot.prop(this,"elements");return t?ot.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ot(this).is(":disabled")&&ie.test(this.nodeName)&&!ne.test(t)&&(this.checked||!Rt.test(t))}).map(function(t,e){var n=ot(this).val();return null==n?null:ot.isArray(n)?ot.map(n,function(t){return{name:e.name,value:t.replace(ee,"\r\n")}}):{name:e.name,value:n.replace(ee,"\r\n")}}).get()}}),ot.param=function(t,n){var i,r=[],o=function(t,e){e=ot.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(n===e&&(n=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(t)||t.jquery&&!ot.isPlainObject(t))ot.each(t,function(){o(this.name,this.value)});else for(i in t)C(i,t[i],n,o);return r.join("&").replace(Kt,"+")},ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ot.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),ot.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var re,oe,ae=ot.now(),se=/\?/,ue=/#.*$/,le=/([?&])_=[^&]*/,ce=/^(.*?):[ \t]*([^\r\n]*)$/gm,fe=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,he=/^(?:GET|HEAD)$/,de=/^\/\//,pe=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ge=ot.fn.load,me={},ve={},ye="*/".concat("*");try{oe=V.href}catch(t){oe=B.createElement("a"),oe.href="",oe=oe.href}re=pe.exec(oe.toLowerCase())||[],ot.fn.load=function(t,n,i){if("string"!=typeof t&&ge)return ge.apply(this,arguments);var r,o,a,s=this,u=t.indexOf(" ");return u>=0&&(r=t.slice(u),t=t.slice(0,u)),ot.isFunction(n)?(i=n,n=e):n&&"object"==typeof n&&(o="POST"),s.length>0&&ot.ajax({url:t,type:o,dataType:"html",data:n}).done(function(t){a=arguments,s.html(r?ot("<div>").append(ot.parseHTML(t)).find(r):t)}).complete(i&&function(t,e){s.each(i,a||[t.responseText,e,t])}),this},ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ot.fn[e]=function(t){return this.on(e,t)}}),ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oe,type:"GET",isLocal:fe.test(re[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ye,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?N(N(t,ot.ajaxSettings),e):N(ot.ajaxSettings,t)},ajaxPrefilter:D(me),ajaxTransport:D(ve),ajax:function(t,n){function i(t,n,i,s){var l,f,y,b,_,k=n;2!==w&&(w=2,u&&clearTimeout(u),r=e,a=s||"",x.readyState=t>0?4:0,l=t>=200&&300>t||304===t,i&&(b=$(h,x,i)),b=A(h,b,x,l),l?(h.ifModified&&(_=x.getResponseHeader("Last-Modified"),_&&(ot.lastModified[o]=_),_=x.getResponseHeader("etag"),_&&(ot.etag[o]=_)),204===t?k="nocontent":304===t?k="notmodified":(k=b.state,f=b.data,y=b.error,l=!y)):(y=k,!t&&k||(k="error",0>t&&(t=0))),x.status=t,x.statusText=(n||k)+"",l?g.resolveWith(d,[f,k,x]):g.rejectWith(d,[x,k,y]),x.statusCode(v),v=e,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,h,l?f:y]),m.fireWith(d,[x,k]),c&&(p.trigger("ajaxComplete",[x,h]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=e),n=n||{};var r,o,a,s,u,l,c,f,h=ot.ajaxSetup({},n),d=h.context||h,p=h.context&&(d.nodeType||d.jquery)?ot(d):ot.event,g=ot.Deferred(),m=ot.Callbacks("once memory"),v=h.statusCode||{},y={},b={},w=0,_="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!s)for(s={};e=ce.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=b[n]=b[n]||t,y[t]=e),this},overrideMimeType:function(t){return w||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||_;return r&&r.abort(e),i(0,e),this}};if(g.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,h.url=((t||h.url||oe)+"").replace(ue,"").replace(de,re[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=ot.trim(h.dataType||"*").toLowerCase().match(st)||[""],null==h.crossDomain&&(l=pe.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===re[1]&&l[2]===re[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(re[3]||("http:"===re[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=ot.param(h.data,h.traditional)),E(me,h,n,x),2===w)return x;c=h.global,c&&0===ot.active++&&ot.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!he.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(se.test(o)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=le.test(o)?o.replace(le,"$1_="+ae++):o+(se.test(o)?"&":"?")+"_="+ae++)),h.ifModified&&(ot.lastModified[o]&&x.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&x.setRequestHeader("If-None-Match",ot.etag[o])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",h.contentType),x.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+ye+"; q=0.01":""):h.accepts["*"]);for(f in h.headers)x.setRequestHeader(f,h.headers[f]);if(h.beforeSend&&(h.beforeSend.call(d,x,h)===!1||2===w))return x.abort();_="abort";for(f in{success:1,error:1,complete:1})x[f](h[f]);if(r=E(ve,h,n,x)){x.readyState=1,c&&p.trigger("ajaxSend",[x,h]),h.async&&h.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},h.timeout));try{w=1,r.send(y,i)}catch(t){if(!(2>w))throw t;i(-1,t)}}else i(-1,"No Transport");return x},getJSON:function(t,e,n){return ot.get(t,e,n,"json")},getScript:function(t,n){return ot.get(t,e,n,"script")}}),ot.each(["get","post"],function(t,n){ot[n]=function(t,i,r,o){return ot.isFunction(i)&&(o=o||r,r=i,i=e),ot.ajax({url:t,type:n,dataType:o,data:i,success:r})}}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return ot.globalEval(t),t}}}),ot.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),ot.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,r){e=ot("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),B.head.appendChild(e[0])},abort:function(){n&&n()}}}});var be=[],we=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=be.pop()||ot.expando+"_"+ae++;return this[t]=!0,t}}),ot.ajaxPrefilter("json jsonp",function(n,i,r){var o,a,s,u=n.jsonp!==!1&&(we.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&we.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=ot.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(we,"$1"+o):n.jsonp!==!1&&(n.url+=(se.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||ot.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=t[o],t[o]=function(){s=arguments},r.always(function(){t[o]=a,n[o]&&(n.jsonpCallback=i.jsonpCallback,be.push(o)),s&&ot.isFunction(a)&&a(s[0]),s=a=e}),"script"):void 0}),ot.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var _e=ot.ajaxSettings.xhr(),xe={0:200,1223:204},ke=0,Me={};t.ActiveXObject&&ot(t).on("unload",function(){for(var t in Me)Me[t]();Me=e}),ot.support.cors=!!_e&&"withCredentials"in _e,ot.support.ajax=_e=!!_e,ot.ajaxTransport(function(t){var n;return ot.support.cors||_e&&!t.crossDomain?{send:function(i,r){var o,a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)s.setRequestHeader(o,i[o]);n=function(t){return function(){n&&(delete Me[a],n=s.onload=s.onerror=null,"abort"===t?s.abort():"error"===t?r(s.status||404,s.statusText):r(xe[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:e,s.getAllResponseHeaders()))}},s.onload=n(),s.onerror=n("error"),n=Me[a=ke++]=n("abort"),s.send(t.hasContent&&t.data||null)},abort:function(){n&&n()}}:void 0});var Se,Te,Ce=/^(?:toggle|show|hide)$/,De=new RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),Ee=/queueHooks$/,Ne=[H],$e={"*":[function(t,e){var n,i,r=this.createTween(t,e),o=De.exec(e),a=r.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],i=o[3]||(ot.cssNumber[t]?"":"px"),"px"!==i&&s){s=ot.css(r.elem,t,!0)||n||1;do u=u||".5",s/=u,ot.style(r.elem,t,s+i);while(u!==(u=r.cur()/a)&&1!==u&&--l)}r.unit=i,r.start=s,r.end=o[1]?s+(o[1]+1)*n:n}return r}]};ot.Animation=ot.extend(R,{tweener:function(t,e){ot.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,r=t.length;r>i;i++)n=t[i],$e[n]=$e[n]||[],$e[n].unshift(e)},prefilter:function(t,e){e?Ne.unshift(t):Ne.push(t)}}),ot.Tween=L,L.prototype={constructor:L,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(ot.cssNumber[n]?"":"px")},cur:function(){var t=L.propHooks[this.prop];return t&&t.get?t.get(this):L.propHooks._default.get(this)},run:function(t){var e,n=L.propHooks[this.prop];return this.pos=e=this.options.duration?ot.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=ot.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){ot.fx.step[t.prop]?ot.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[ot.cssProps[t.prop]]||ot.cssHooks[t.prop])?ot.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ot.each(["toggle","show","hide"],function(t,e){var n=ot.fn[e];ot.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(z(e,!0),t,i,r)}}),ot.fn.extend({fadeTo:function(t,e,n,i){return this.filter(b).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=ot.isEmptyObject(t),o=ot.speed(e,n,i),a=function(){var e=R(this,ot.extend({},t),o);a.finish=function(){e.stop(!0)},(r||mt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,n,i){var r=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=n,n=t,t=e),n&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",o=ot.timers,a=mt.get(this);if(n)a[n]&&a[n].stop&&r(a[n]);else for(n in a)a[n]&&a[n].stop&&Ee.test(n)&&r(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(i),e=!1,o.splice(n,1));!e&&i||ot.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=mt.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=ot.timers,a=i?i.length:0;for(n.finish=!0,ot.queue(this,t,[]),r&&r.cur&&r.cur.finish&&r.cur.finish.call(this),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),ot.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ot.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),ot.speed=function(t,e,n){var i=t&&"object"==typeof t?ot.extend({},t):{complete:n||!n&&e||ot.isFunction(t)&&t,duration:t,easing:n&&e||e&&!ot.isFunction(e)&&e};return i.duration=ot.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ot.fx.speeds?ot.fx.speeds[i.duration]:ot.fx.speeds._default,null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){ot.isFunction(i.old)&&i.old.call(this),i.queue&&ot.dequeue(this,i.queue)},i},ot.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},ot.timers=[],ot.fx=L.prototype.init,ot.fx.tick=function(){var t,n=ot.timers,i=0;for(Se=ot.now();i<n.length;i++)t=n[i],t()||n[i]!==t||n.splice(i--,1);n.length||ot.fx.stop(),Se=e},ot.fx.timer=function(t){t()&&ot.timers.push(t)&&ot.fx.start()},ot.fx.interval=13,ot.fx.start=function(){Te||(Te=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(Te),Te=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fx.step={},ot.expr&&ot.expr.filters&&(ot.expr.filters.animated=function(t){return ot.grep(ot.timers,function(e){return t===e.elem}).length}),ot.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){ot.offset.setOffset(this,t,e)});var n,i,r=this[0],o={top:0,left:0},a=r&&r.ownerDocument;return a?(n=a.documentElement,ot.contains(n,r)?(typeof r.getBoundingClientRect!==Y&&(o=r.getBoundingClientRect()),i=O(a),{top:o.top+i.pageYOffset-n.clientTop,left:o.left+i.pageXOffset-n.clientLeft}):o):void 0},ot.offset={setOffset:function(t,e,n){var i,r,o,a,s,u,l,c=ot.css(t,"position"),f=ot(t),h={};"static"===c&&(t.style.position="relative"),s=f.offset(),o=ot.css(t,"top"),u=ot.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(i=f.position(),a=i.top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),ot.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+r),"using"in e?e.using.call(t,h):f.css(h)}},ot.fn.extend({position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===ot.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ot.nodeName(t[0],"html")||(i=t.offset()),i.top+=ot.css(t[0],"borderTopWidth",!0),i.left+=ot.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-ot.css(n,"marginTop",!0),left:e.left-i.left-ot.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||W;t&&!ot.nodeName(t,"html")&&"static"===ot.css(t,"position");)t=t.offsetParent;return t||W})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,i){var r="pageYOffset"===i;ot.fn[n]=function(o){return ot.access(this,function(n,o,a){var s=O(n);return a===e?s?s[i]:n[o]:void(s?s.scrollTo(r?t.pageXOffset:a,r?a:t.pageYOffset):n[o]=a)},n,o,arguments.length,null)}}),ot.each({Height:"height",Width:"width"},function(t,n){ot.each({padding:"inner"+t,content:n,"":"outer"+t},function(i,r){ot.fn[r]=function(r,o){var a=arguments.length&&(i||"boolean"!=typeof r),s=i||(r===!0||o===!0?"margin":"border");return ot.access(this,function(n,i,r){var o;return ot.isWindow(n)?n.document.documentElement["client"+t]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+t],o["scroll"+t],n.body["offset"+t],o["offset"+t],o["client"+t])):r===e?ot.css(n,i,s):ot.style(n,i,r,s)},n,a?r:e,a,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=ot:"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot}),"object"==typeof t&&"object"==typeof t.document&&(t.jQuery=t.$=ot)}(window),function(){function t(t,e,n){for(var i=(n||0)-1,r=t?t.length:0;++i<r;)if(t[i]===e)return i;return-1}function e(e,n){var i=typeof n;if(e=e.cache,"boolean"==i||null==n)return e[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:v+n;return e=(e=e[i])&&e[r],"object"==i?e&&t(e,n)>-1?0:-1:e?0:-1}function n(t){var e=this.cache,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?t:v+t,r=e[n]||(e[n]={});"object"==n?(r[i]||(r[i]=[])).push(t):r[i]=!0}}function i(t){return t.charCodeAt(0)}function r(t,e){for(var n=t.criteria,i=e.criteria,r=-1,o=n.length;++r<o;){var a=n[r],s=i[r];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return t.index-e.index}function o(t){var e=-1,i=t.length,r=t[0],o=t[i/2|0],a=t[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=u();s["false"]=s["null"]=s["true"]=s.undefined=!1;var l=u();for(l.array=t,l.cache=s,l.push=n;++e<i;)l.push(t[e]);return l}function a(t){return"\\"+U[t]}function s(){return p.pop()||[]}function u(){return g.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(t){t.length=0,p.length<b&&p.push(t)}function c(t){var e=t.cache;e&&c(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,g.length<b&&g.push(t)}function f(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var i=-1,r=n-e||0,o=Array(0>r?0:r);++i<r;)o[i]=t[e+i];return o}function h(n){function p(t){return t&&"object"==typeof t&&!Jn(t)&&Pn.call(t,"__wrapped__")?t:new g(t)}function g(t,e){this.__chain__=!!e,this.__wrapped__=t}function b(t){function e(){if(i){var t=f(i);Rn.apply(t,arguments)}if(this instanceof e){var o=X(n.prototype),a=n.apply(o,t||arguments);return Nt(a)?a:o}return n.apply(r,t||arguments)}var n=t[0],i=t[2],r=t[4];return Zn(e,t),e}function U(t,e,n,i,r){if(n){var o=n(t);if("undefined"!=typeof o)return o}var a=Nt(t);if(!a)return t;var u=Cn.call(t);if(!Y[u])return t;var c=Xn[u];switch(u){case I:case H:return new c(+t);case z:case F:return new c(t);case q:return o=c(t.source,S.exec(t)),o.lastIndex=t.lastIndex,o}var h=Jn(t);if(e){var d=!i;i||(i=s()),r||(r=s());for(var p=i.length;p--;)if(i[p]==t)return r[p];o=h?c(t.length):{}}else o=h?f(t):oi({},t);return h&&(Pn.call(t,"index")&&(o.index=t.index),Pn.call(t,"input")&&(o.input=t.input)),e?(i.push(t),r.push(o),(h?Qt:ui)(t,function(t,a){o[a]=U(t,e,n,i,r)}),d&&(l(i),l(r)),o):o}function X(t,e){return Nt(t)?On(t):{}}function Q(t,e,n){if("function"!=typeof t)return Ze;if("undefined"==typeof e||!("prototype"in t))return t;var i=t.__bindData__;if("undefined"==typeof i&&(Qn.funcNames&&(i=!t.name),i=i||!Qn.funcDecomp,!i)){var r=An.call(t);Qn.funcNames||(i=!T.test(r)),i||(i=N.test(r),Zn(t,i))}if(i===!1||i!==!0&&1&i[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return Pe(t,e)}function Z(t){function e(){var t=u?a:this;if(r){var p=f(r);Rn.apply(p,arguments)}if((o||c)&&(p||(p=f(arguments)),o&&Rn.apply(p,o),c&&p.length<s))return i|=16,Z([n,h?i:-4&i,p,null,a,s]);if(p||(p=arguments),l&&(n=t[d]),this instanceof e){t=X(n.prototype);var g=n.apply(t,p);return Nt(g)?g:t}return n.apply(t,p)}var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=1&i,l=2&i,c=4&i,h=8&i,d=n;return Zn(e,t),e}function J(n,i){var r=-1,a=ut(),s=n?n.length:0,u=s>=y&&a===t,l=[];if(u){var f=o(i);f?(a=e,i=f):u=!1}for(;++r<s;){var h=n[r];a(i,h)<0&&l.push(h)}return u&&c(i),l}function tt(t,e,n,i){for(var r=(i||0)-1,o=t?t.length:0,a=[];++r<o;){var s=t[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Jn(s)||ht(s))){e||(s=tt(s,e,n));var u=-1,l=s.length,c=a.length;for(a.length+=l;++u<l;)a[c++]=s[u]}else n||a.push(s)}return a}function et(t,e,n,i,r,o){if(n){var a=n(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;var u=typeof t,c=typeof e;if(!(t!==t||t&&W[u]||e&&W[c]))return!1;if(null==t||null==e)return t===e;var f=Cn.call(t),h=Cn.call(e);if(f==P&&(f=O),h==P&&(h=O),f!=h)return!1;switch(f){case I:case H:return+t==+e;case z:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case q:case F:return t==xn(e)}var d=f==R;if(!d){var p=Pn.call(t,"__wrapped__"),g=Pn.call(e,"__wrapped__");if(p||g)return et(p?t.__wrapped__:t,g?e.__wrapped__:e,n,i,r,o);if(f!=O)return!1;var m=t.constructor,v=e.constructor;if(m!=v&&!(Et(m)&&m instanceof m&&Et(v)&&v instanceof v)&&"constructor"in t&&"constructor"in e)return!1}var y=!r;r||(r=s()),o||(o=s());for(var b=r.length;b--;)if(r[b]==t)return o[b]==e;var w=0;if(a=!0,r.push(t),o.push(e),d){if(b=t.length,w=e.length,a=w==b,a||i)for(;w--;){var _=b,x=e[w];if(i)for(;_--&&!(a=et(t[_],x,n,i,r,o)););else if(!(a=et(t[w],x,n,i,r,o)))break}}else si(e,function(e,s,u){return Pn.call(u,s)?(w++,a=Pn.call(t,s)&&et(t[s],e,n,i,r,o)):void 0}),a&&!i&&si(t,function(t,e,n){return Pn.call(n,e)?a=--w>-1:void 0});return r.pop(),o.pop(),y&&(l(r),l(o)),a}function nt(t,e,n,i,r){(Jn(e)?Qt:ui)(e,function(e,o){var a,s,u=e,l=t[o];if(e&&((s=Jn(e))||li(e))){for(var c=i.length;c--;)if(a=i[c]==e){l=r[c];break}if(!a){var f;n&&(u=n(l,e),(f="undefined"!=typeof u)&&(l=u)),f||(l=s?Jn(l)?l:[]:li(l)?l:{}),i.push(e),r.push(l),f||nt(l,e,n,i,r)}}else n&&(u=n(l,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(l=u);t[o]=l})}function it(t,e){return t+$n(Gn()*(e-t+1))}function rt(n,i,r){var a=-1,u=ut(),f=n?n.length:0,h=[],d=!i&&f>=y&&u===t,p=r||d?s():h;if(d){var g=o(p);u=e,p=g}for(;++a<f;){var m=n[a],v=r?r(m,a,n):m;(i?!a||p[p.length-1]!==v:u(p,v)<0)&&((r||d)&&p.push(v),h.push(m))}return d?(l(p.array),c(p)):r&&l(p),h}function ot(t){return function(e,n,i){var r={};n=p.createCallback(n,i,3);var o=-1,a=e?e.length:0;if("number"==typeof a)for(;++o<a;){var s=e[o];t(r,s,n(s,o,e),e)}else ui(e,function(e,i,o){t(r,e,n(e,i,o),o)});return r}}function at(t,e,n,i,r,o){var a=1&e,s=2&e,u=4&e,l=16&e,c=32&e;if(!s&&!Et(t))throw new kn;l&&!n.length&&(e&=-17,l=n=!1),c&&!i.length&&(e&=-33,c=i=!1);var h=t&&t.__bindData__;if(h&&h!==!0)return h=f(h),h[2]&&(h[2]=f(h[2])),h[3]&&(h[3]=f(h[3])),!a||1&h[1]||(h[4]=r),!a&&1&h[1]&&(e|=8),!u||4&h[1]||(h[5]=o),l&&Rn.apply(h[2]||(h[2]=[]),n),c&&Ln.apply(h[3]||(h[3]=[]),i),h[1]|=e,at.apply(null,h);var d=1==e||17===e?b:Z;return d([t,e,n,i,r,o])}function st(t){return ei[t]}function ut(){var e=(e=p.indexOf)===ve?t:e;return e}function lt(t){return"function"==typeof t&&Dn.test(t)}function ct(t){var e,n;return!!(t&&Cn.call(t)==O&&(e=t.constructor,!Et(e)||e instanceof e))&&(si(t,function(t,e){n=e}),"undefined"==typeof n||Pn.call(t,n))}function ft(t){return ni[t]}function ht(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Cn.call(t)==P||!1}function dt(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n=e,e=!1),U(t,e,"function"==typeof n&&Q(n,i,1))}function pt(t,e,n){return U(t,!0,"function"==typeof e&&Q(e,n,1))}function gt(t,e){var n=X(t);return e?oi(n,e):n}function mt(t,e,n){var i;return e=p.createCallback(e,n,3),ui(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function vt(t,e,n){var i;return e=p.createCallback(e,n,3),bt(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function yt(t,e,n){var i=[];si(t,function(t,e){i.push(e,t)});var r=i.length;for(e=Q(e,n,3);r--&&e(i[r--],i[r],t)!==!1;);return t}function bt(t,e,n){var i=ti(t),r=i.length;for(e=Q(e,n,3);r--;){var o=i[r];if(e(t[o],o,t)===!1)break}return t}function wt(t){var e=[];return si(t,function(t,n){Et(t)&&e.push(n)}),e.sort()}function _t(t,e){return!!t&&Pn.call(t,e)}function xt(t){for(var e=-1,n=ti(t),i=n.length,r={};++e<i;){var o=n[e];r[t[o]]=o}return r}function kt(t){return t===!0||t===!1||t&&"object"==typeof t&&Cn.call(t)==I||!1}function Mt(t){return t&&"object"==typeof t&&Cn.call(t)==H||!1}function St(t){return t&&1===t.nodeType||!1}function Tt(t){var e=!0;if(!t)return e;var n=Cn.call(t),i=t.length;return n==R||n==F||n==P||n==O&&"number"==typeof i&&Et(t.splice)?!i:(ui(t,function(){return e=!1}),e)}function Ct(t,e,n,i){return et(t,e,"function"==typeof n&&Q(n,i,2))}function Dt(t){return Fn(t)&&!Yn(parseFloat(t))}function Et(t){return"function"==typeof t}function Nt(t){return!(!t||!W[typeof t])}function $t(t){return jt(t)&&t!=+t}function At(t){return null===t}function jt(t){return"number"==typeof t||t&&"object"==typeof t&&Cn.call(t)==z||!1}function Pt(t){return t&&"object"==typeof t&&Cn.call(t)==q||!1}function Rt(t){return"string"==typeof t||t&&"object"==typeof t&&Cn.call(t)==F||!1}function It(t){return"undefined"==typeof t}function Ht(t,e,n){var i={};return e=p.createCallback(e,n,3),ui(t,function(t,n,r){i[n]=e(t,n,r)}),i}function Lt(t){var e=arguments,n=2;if(!Nt(t))return t;if("number"!=typeof e[2]&&(n=e.length),n>3&&"function"==typeof e[n-2])var i=Q(e[--n-1],e[n--],2);else n>2&&"function"==typeof e[n-1]&&(i=e[--n]);for(var r=f(arguments,1,n),o=-1,a=s(),u=s();++o<n;)nt(t,r[o],i,a,u);return l(a),l(u),t}function zt(t,e,n){var i={};if("function"!=typeof e){var r=[];si(t,function(t,e){r.push(e)}),r=J(r,tt(arguments,!0,!1,1));for(var o=-1,a=r.length;++o<a;){var s=r[o];i[s]=t[s]}}else e=p.createCallback(e,n,3),si(t,function(t,n,r){e(t,n,r)||(i[n]=t)});return i}function Ot(t){for(var e=-1,n=ti(t),i=n.length,r=pn(i);++e<i;){var o=n[e];r[e]=[o,t[o]]}return r}function qt(t,e,n){var i={};if("function"!=typeof e)for(var r=-1,o=tt(arguments,!0,!1,1),a=Nt(t)?o.length:0;++r<a;){var s=o[r];s in t&&(i[s]=t[s])}else e=p.createCallback(e,n,3),si(t,function(t,n,r){e(t,n,r)&&(i[n]=t)});return i}function Ft(t,e,n,i){var r=Jn(t);if(null==n)if(r)n=[];else{var o=t&&t.constructor,a=o&&o.prototype;n=X(a)}return e&&(e=p.createCallback(e,i,4),(r?Qt:ui)(t,function(t,i,r){return e(n,t,i,r)})),n}function Yt(t){for(var e=-1,n=ti(t),i=n.length,r=pn(i);++e<i;)r[e]=t[n[e]];return r}function Vt(t){for(var e=arguments,n=-1,i=tt(e,!0,!1,1),r=e[2]&&e[2][e[1]]===t?1:i.length,o=pn(r);++n<r;)o[n]=t[i[n]];return o}function Bt(t,e,n){var i=-1,r=ut(),o=t?t.length:0,a=!1;return n=(0>n?Bn(0,o+n):n)||0,Jn(t)?a=r(t,e,n)>-1:"number"==typeof o?a=(Rt(t)?t.indexOf(e,n):r(t,e,n))>-1:ui(t,function(t){return++i>=n?!(a=t===e):void 0}),a}function Wt(t,e,n){var i=!0;e=p.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&(i=!!e(t[r],r,t)););else ui(t,function(t,n,r){return i=!!e(t,n,r)});return i}function Ut(t,e,n){var i=[];e=p.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o;){var a=t[r];e(a,r,t)&&i.push(a)}else ui(t,function(t,n,r){e(t,n,r)&&i.push(t)});return i}function Gt(t,e,n){e=p.createCallback(e,n,3);var i=-1,r=t?t.length:0;if("number"!=typeof r){var o;return ui(t,function(t,n,i){return e(t,n,i)?(o=t,!1):void 0}),o}for(;++i<r;){var a=t[i];if(e(a,i,t))return a}}function Xt(t,e,n){var i;return e=p.createCallback(e,n,3),Zt(t,function(t,n,r){return e(t,n,r)?(i=t,!1):void 0}),i}function Qt(t,e,n){var i=-1,r=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Q(e,n,3),"number"==typeof r)for(;++i<r&&e(t[i],i,t)!==!1;);else ui(t,e);return t}function Zt(t,e,n){var i=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Q(e,n,3),"number"==typeof i)for(;i--&&e(t[i],i,t)!==!1;);else{var r=ti(t);i=r.length,ui(t,function(t,n,o){return n=r?r[--i]:--i,e(o[n],n,o)})}return t}function Jt(t,e){var n=f(arguments,2),i=-1,r="function"==typeof e,o=t?t.length:0,a=pn("number"==typeof o?o:0);return Qt(t,function(t){a[++i]=(r?e:t[e]).apply(t,n)}),a}function Kt(t,e,n){var i=-1,r=t?t.length:0;if(e=p.createCallback(e,n,3),"number"==typeof r)for(var o=pn(r);++i<r;)o[i]=e(t[i],i,t);else o=[],ui(t,function(t,n,r){o[++i]=e(t,n,r)});return o}function te(t,e,n){var r=-(1/0),o=r;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Jn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];u>o&&(o=u)}else e=null==e&&Rt(t)?i:p.createCallback(e,n,3),Qt(t,function(t,n,i){var a=e(t,n,i);a>r&&(r=a,o=t)});return o}function ee(t,e,n){var r=1/0,o=r;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Jn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];o>u&&(o=u)}else e=null==e&&Rt(t)?i:p.createCallback(e,n,3),Qt(t,function(t,n,i){var a=e(t,n,i);r>a&&(r=a,o=t)});return o}function ne(t,e,n,i){if(!t)return n;var r=arguments.length<3;e=p.createCallback(e,i,4);var o=-1,a=t.length;if("number"==typeof a)for(r&&(n=t[++o]);++o<a;)n=e(n,t[o],o,t);else ui(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)});return n}function ie(t,e,n,i){var r=arguments.length<3;return e=p.createCallback(e,i,4),Zt(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function re(t,e,n){return e=p.createCallback(e,n,3),Ut(t,function(t,n,i){return!e(t,n,i)})}function oe(t,e,n){if(t&&"number"!=typeof t.length&&(t=Yt(t)),null==e||n)return t?t[it(0,t.length-1)]:d;var i=ae(t);return i.length=Wn(Bn(0,e),i.length),i}function ae(t){var e=-1,n=t?t.length:0,i=pn("number"==typeof n?n:0);return Qt(t,function(t){var n=it(0,++e);i[e]=i[n],i[n]=t}),i}function se(t){var e=t?t.length:0;return"number"==typeof e?e:ti(t).length}function ue(t,e,n){var i;e=p.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&!(i=e(t[r],r,t)););else ui(t,function(t,n,r){return!(i=e(t,n,r))});return!!i}function le(t,e,n){var i=-1,o=Jn(e),a=t?t.length:0,f=pn("number"==typeof a?a:0);

for(o||(e=p.createCallback(e,n,3)),Qt(t,function(t,n,r){var a=f[++i]=u();o?a.criteria=Kt(e,function(e){return t[e]}):(a.criteria=s())[0]=e(t,n,r),a.index=i,a.value=t}),a=f.length,f.sort(r);a--;){var h=f[a];f[a]=h.value,o||l(h.criteria),c(h)}return f}function ce(t){return t&&"number"==typeof t.length?f(t):Yt(t)}function fe(t){for(var e=-1,n=t?t.length:0,i=[];++e<n;){var r=t[e];r&&i.push(r)}return i}function he(t){return J(t,tt(arguments,!0,!0,1))}function de(t,e,n){var i=-1,r=t?t.length:0;for(e=p.createCallback(e,n,3);++i<r;)if(e(t[i],i,t))return i;return-1}function pe(t,e,n){var i=t?t.length:0;for(e=p.createCallback(e,n,3);i--;)if(e(t[i],i,t))return i;return-1}function ge(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=p.createCallback(e,n,3);++o<r&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[0]:d;return f(t,0,Wn(Bn(0,i),r))}function me(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n="function"!=typeof e&&i&&i[e]===t?null:e,e=!1),null!=n&&(t=Kt(t,n,i)),tt(t,e)}function ve(e,n,i){if("number"==typeof i){var r=e?e.length:0;i=0>i?Bn(0,r+i):i||0}else if(i){var o=Te(e,n);return e[o]===n?o:-1}return t(e,n,i)}function ye(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=p.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else i=null==e||n?1:e||i;return f(t,0,Wn(Bn(0,r-i),r))}function be(){for(var n=[],i=-1,r=arguments.length,a=s(),u=ut(),f=u===t,h=s();++i<r;){var d=arguments[i];(Jn(d)||ht(d))&&(n.push(d),a.push(f&&d.length>=y&&o(i?n[i]:h)))}var p=n[0],g=-1,m=p?p.length:0,v=[];t:for(;++g<m;){var b=a[0];if(d=p[g],(b?e(b,d):u(h,d))<0){for(i=r,(b||h).push(d);--i;)if(b=a[i],(b?e(b,d):u(n[i],d))<0)continue t;v.push(d)}}for(;r--;)b=a[r],b&&c(b);return l(a),l(h),v}function we(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=p.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[r-1]:d;return f(t,Bn(0,r-i))}function _e(t,e,n){var i=t?t.length:0;for("number"==typeof n&&(i=(0>n?Bn(0,i+n):Wn(n,i-1))+1);i--;)if(t[i]===e)return i;return-1}function xe(t){for(var e=arguments,n=0,i=e.length,r=t?t.length:0;++n<i;)for(var o=-1,a=e[n];++o<r;)t[o]===a&&(Hn.call(t,o--,1),r--);return t}function ke(t,e,n){t=+t||0,n="number"==typeof n?n:+n||1,null==e&&(e=t,t=0);for(var i=-1,r=Bn(0,En((e-t)/(n||1))),o=pn(r);++i<r;)o[i]=t,t+=n;return o}function Me(t,e,n){var i=-1,r=t?t.length:0,o=[];for(e=p.createCallback(e,n,3);++i<r;){var a=t[i];e(a,i,t)&&(o.push(a),Hn.call(t,i--,1),r--)}return o}function Se(t,e,n){if("number"!=typeof e&&null!=e){var i=0,r=-1,o=t?t.length:0;for(e=p.createCallback(e,n,3);++r<o&&e(t[r],r,t);)i++}else i=null==e||n?1:Bn(0,e);return f(t,i)}function Te(t,e,n,i){var r=0,o=t?t.length:r;for(n=n?p.createCallback(n,i,1):Ze,e=n(e);o>r;){var a=r+o>>>1;n(t[a])<e?r=a+1:o=a}return r}function Ce(){return rt(tt(arguments,!0,!0))}function De(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n="function"!=typeof e&&i&&i[e]===t?null:e,e=!1),null!=n&&(n=p.createCallback(n,i,3)),rt(t,e,n)}function Ee(t){return J(t,f(arguments,1))}function Ne(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Jn(n)||ht(n))var i=i?rt(J(i,n).concat(J(n,i))):n}return i||[]}function $e(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,n=t?te(di(t,"length")):0,i=pn(0>n?0:n);++e<n;)i[e]=di(t,e);return i}function Ae(t,e){var n=-1,i=t?t.length:0,r={};for(e||!i||Jn(t[0])||(e=[]);++n<i;){var o=t[n];e?r[o]=e[n]:o&&(r[o[0]]=o[1])}return r}function je(t,e){if(!Et(e))throw new kn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Pe(t,e){return arguments.length>2?at(t,17,f(arguments,2),null,e):at(t,1,null,null,e)}function Re(t){for(var e=arguments.length>1?tt(arguments,!0,!1,1):wt(t),n=-1,i=e.length;++n<i;){var r=e[n];t[r]=at(t[r],1,null,null,t)}return t}function Ie(t,e){return arguments.length>2?at(e,19,f(arguments,2),null,t):at(e,3,null,null,t)}function He(){for(var t=arguments,e=t.length;e--;)if(!Et(t[e]))throw new kn;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function Le(t,e){return e="number"==typeof e?e:+e||t.length,at(t,4,null,null,null,e)}function ze(t,e,n){var i,r,o,a,s,u,l,c=0,f=!1,h=!0;if(!Et(t))throw new kn;if(e=Bn(0,e)||0,n===!0){var p=!0;h=!1}else Nt(n)&&(p=n.leading,f="maxWait"in n&&(Bn(e,n.maxWait)||0),h="trailing"in n?n.trailing:h);var g=function(){var n=e-(gi()-a);if(0>=n){r&&Nn(r);var f=l;r=u=l=d,f&&(c=gi(),o=t.apply(s,i),u||r||(i=s=null))}else u=In(g,n)},m=function(){u&&Nn(u),r=u=l=d,(h||f!==e)&&(c=gi(),o=t.apply(s,i),u||r||(i=s=null))};return function(){if(i=arguments,a=gi(),s=this,l=h&&(u||!p),f===!1)var n=p&&!u;else{r||p||(c=a);var d=f-(a-c),v=0>=d;v?(r&&(r=Nn(r)),c=a,o=t.apply(s,i)):r||(r=In(m,d))}return v&&u?u=Nn(u):u||e===f||(u=In(g,e)),n&&(v=!0,o=t.apply(s,i)),!v||u||r||(i=s=null),o}}function Oe(t){if(!Et(t))throw new kn;var e=f(arguments,1);return In(function(){t.apply(d,e)},1)}function qe(t,e){if(!Et(t))throw new kn;var n=f(arguments,2);return In(function(){t.apply(d,n)},e)}function Fe(t,e){if(!Et(t))throw new kn;var n=function(){var i=n.cache,r=e?e.apply(this,arguments):v+arguments[0];return Pn.call(i,r)?i[r]:i[r]=t.apply(this,arguments)};return n.cache={},n}function Ye(t){var e,n;if(!Et(t))throw new kn;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function Ve(t){return at(t,16,f(arguments,1))}function Be(t){return at(t,32,null,f(arguments,1))}function We(t,e,n){var i=!0,r=!0;if(!Et(t))throw new kn;return n===!1?i=!1:Nt(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),V.leading=i,V.maxWait=e,V.trailing=r,ze(t,e,V)}function Ue(t,e){return at(e,16,[t])}function Ge(t){return function(){return t}}function Xe(t,e,n){var i=typeof t;if(null==t||"function"==i)return Q(t,e,n);if("object"!=i)return en(t);var r=ti(t),o=r[0],a=t[o];return 1!=r.length||a!==a||Nt(a)?function(e){for(var n=r.length,i=!1;n--&&(i=et(e[r[n]],t[r[n]],null,!0)););return i}:function(t){var e=t[o];return a===e&&(0!==a||1/a==1/e)}}function Qe(t){return null==t?"":xn(t).replace(ri,st)}function Ze(t){return t}function Je(t,e,n){var i=!0,r=e&&wt(e);e&&(n||r.length)||(null==n&&(n=e),o=g,e=t,t=p,r=wt(e)),n===!1?i=!1:Nt(n)&&"chain"in n&&(i=n.chain);var o=t,a=Et(o);Qt(r,function(n){var r=t[n]=e[n];a&&(o.prototype[n]=function(){var e=this.__chain__,n=this.__wrapped__,a=[n];Rn.apply(a,arguments);var s=r.apply(t,a);if(i||e){if(n===s&&Nt(s))return this;s=new o(s),s.__chain__=e}return s})})}function Ke(){return n._=Tn,this}function tn(){}function en(t){return function(e){return e[t]}}function nn(t,e,n){var i=null==t,r=null==e;if(null==n&&("boolean"==typeof t&&r?(n=t,t=1):r||"boolean"!=typeof e||(n=e,r=!0)),i&&r&&(e=1),t=+t||0,r?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=Gn();return Wn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return it(t,e)}function rn(t,e){if(t){var n=t[e];return Et(n)?t[e]():n}}function on(t,e,n){var i=p.templateSettings;t=xn(t||""),n=ai({},n,i);var r,o=ai({},n.imports,i.imports),s=ti(o),u=Yt(o),l=0,c=n.interpolate||E,f="__p += '",h=_n((n.escape||E).source+"|"+c.source+"|"+(c===C?M:E).source+"|"+(n.evaluate||E).source+"|$","g");t.replace(h,function(e,n,i,o,s,u){return i||(i=o),f+=t.slice(l,u).replace($,a),n&&(f+="' +\n__e("+n+") +\n'"),s&&(r=!0,f+="';\n"+s+";\n__p += '"),i&&(f+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),f+="';\n";var g=n.variable,m=g;m||(g="obj",f="with ("+g+") {\n"+f+"\n}\n"),f=(r?f.replace(_,""):f).replace(x,"$1").replace(k,"$1;"),f="function("+g+") {\n"+(m?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+j++ +"]")+"\n*/";try{var y=vn(s,"return "+f+v).apply(d,u)}catch(t){throw t.source=f,t}return e?y(e):(y.source=f,y)}function an(t,e,n){t=(t=+t)>-1?t:0;var i=-1,r=pn(t);for(e=Q(e,n,1);++i<t;)r[i]=e(i);return r}function sn(t){return null==t?"":xn(t).replace(ii,ft)}function un(t){var e=++m;return xn(null==t?"":t)+e}function ln(t){return t=new g(t),t.__chain__=!0,t}function cn(t,e){return e(t),t}function fn(){return this.__chain__=!0,this}function hn(){return xn(this.__wrapped__)}function dn(){return this.__wrapped__}n=n?K.defaults(G.Object(),n,K.pick(G,A)):G;var pn=n.Array,gn=n.Boolean,mn=n.Date,vn=n.Function,yn=n.Math,bn=n.Number,wn=n.Object,_n=n.RegExp,xn=n.String,kn=n.TypeError,Mn=[],Sn=wn.prototype,Tn=n._,Cn=Sn.toString,Dn=_n("^"+xn(Cn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),En=yn.ceil,Nn=n.clearTimeout,$n=yn.floor,An=vn.prototype.toString,jn=lt(jn=wn.getPrototypeOf)&&jn,Pn=Sn.hasOwnProperty,Rn=Mn.push,In=n.setTimeout,Hn=Mn.splice,Ln=Mn.unshift,zn=function(){try{var t={},e=lt(e=wn.defineProperty)&&e,n=e(t,t,t)&&e}catch(t){}return n}(),On=lt(On=wn.create)&&On,qn=lt(qn=pn.isArray)&&qn,Fn=n.isFinite,Yn=n.isNaN,Vn=lt(Vn=wn.keys)&&Vn,Bn=yn.max,Wn=yn.min,Un=n.parseInt,Gn=yn.random,Xn={};Xn[R]=pn,Xn[I]=gn,Xn[H]=mn,Xn[L]=vn,Xn[O]=wn,Xn[z]=bn,Xn[q]=_n,Xn[F]=xn,g.prototype=p.prototype;var Qn=p.support={};Qn.funcDecomp=!lt(n.WinRTError)&&N.test(h),Qn.funcNames="string"==typeof vn.name,p.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:C,variable:"",imports:{_:p}},On||(X=function(){function t(){}return function(e){if(Nt(e)){t.prototype=e;var i=new t;t.prototype=null}return i||n.Object()}}());var Zn=zn?function(t,e){B.value=e,zn(t,"__bindData__",B)}:tn,Jn=qn||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Cn.call(t)==R||!1},Kn=function(t){var e,n=t,i=[];if(!n)return i;if(!W[typeof t])return i;for(e in n)Pn.call(n,e)&&i.push(e);return i},ti=Vn?function(t){return Nt(t)?Vn(t):[]}:Kn,ei={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ni=xt(ei),ii=_n("("+ti(ni).join("|")+")","g"),ri=_n("["+ti(ei).join("")+"]","g"),oi=function(t,e,n){var i,r=t,o=r;if(!r)return o;var a=arguments,s=0,u="number"==typeof n?2:a.length;if(u>3&&"function"==typeof a[u-2])var l=Q(a[--u-1],a[u--],2);else u>2&&"function"==typeof a[u-1]&&(l=a[--u]);for(;++s<u;)if(r=a[s],r&&W[typeof r])for(var c=-1,f=W[typeof r]&&ti(r),h=f?f.length:0;++c<h;)i=f[c],o[i]=l?l(o[i],r[i]):r[i];return o},ai=function(t,e,n){var i,r=t,o=r;if(!r)return o;for(var a=arguments,s=0,u="number"==typeof n?2:a.length;++s<u;)if(r=a[s],r&&W[typeof r])for(var l=-1,c=W[typeof r]&&ti(r),f=c?c.length:0;++l<f;)i=c[l],"undefined"==typeof o[i]&&(o[i]=r[i]);return o},si=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!W[typeof r])return o;e=e&&"undefined"==typeof n?e:Q(e,n,3);for(i in r)if(e(r[i],i,t)===!1)return o;return o},ui=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!W[typeof r])return o;e=e&&"undefined"==typeof n?e:Q(e,n,3);for(var a=-1,s=W[typeof r]&&ti(r),u=s?s.length:0;++a<u;)if(i=s[a],e(r[i],i,t)===!1)return o;return o},li=jn?function(t){if(!t||Cn.call(t)!=O)return!1;var e=t.valueOf,n=lt(e)&&(n=jn(e))&&jn(n);return n?t==n||jn(t)==n:ct(t)}:ct,ci=ot(function(t,e,n){Pn.call(t,n)?t[n]++:t[n]=1}),fi=ot(function(t,e,n){(Pn.call(t,n)?t[n]:t[n]=[]).push(e)}),hi=ot(function(t,e,n){t[n]=e}),di=Kt,pi=Ut,gi=lt(gi=mn.now)&&gi||function(){return(new mn).getTime()},mi=8==Un(w+"08")?Un:function(t,e){return Un(Rt(t)?t.replace(D,""):t,e||0)};return p.after=je,p.assign=oi,p.at=Vt,p.bind=Pe,p.bindAll=Re,p.bindKey=Ie,p.chain=ln,p.compact=fe,p.compose=He,p.constant=Ge,p.countBy=ci,p.create=gt,p.createCallback=Xe,p.curry=Le,p.debounce=ze,p.defaults=ai,p.defer=Oe,p.delay=qe,p.difference=he,p.filter=Ut,p.flatten=me,p.forEach=Qt,p.forEachRight=Zt,p.forIn=si,p.forInRight=yt,p.forOwn=ui,p.forOwnRight=bt,p.functions=wt,p.groupBy=fi,p.indexBy=hi,p.initial=ye,p.intersection=be,p.invert=xt,p.invoke=Jt,p.keys=ti,p.map=Kt,p.mapValues=Ht,p.max=te,p.memoize=Fe,p.merge=Lt,p.min=ee,p.omit=zt,p.once=Ye,p.pairs=Ot,p.partial=Ve,p.partialRight=Be,p.pick=qt,p.pluck=di,p.property=en,p.pull=xe,p.range=ke,p.reject=re,p.remove=Me,p.rest=Se,p.shuffle=ae,p.sortBy=le,p.tap=cn,p.throttle=We,p.times=an,p.toArray=ce,p.transform=Ft,p.union=Ce,p.uniq=De,p.values=Yt,p.where=pi,p.without=Ee,p.wrap=Ue,p.xor=Ne,p.zip=$e,p.zipObject=Ae,p.collect=Kt,p.drop=Se,p.each=Qt,p.eachRight=Zt,p.extend=oi,p.methods=wt,p.object=Ae,p.select=Ut,p.tail=Se,p.unique=De,p.unzip=$e,Je(p),p.clone=dt,p.cloneDeep=pt,p.contains=Bt,p.escape=Qe,p.every=Wt,p.find=Gt,p.findIndex=de,p.findKey=mt,p.findLast=Xt,p.findLastIndex=pe,p.findLastKey=vt,p.has=_t,p.identity=Ze,p.indexOf=ve,p.isArguments=ht,p.isArray=Jn,p.isBoolean=kt,p.isDate=Mt,p.isElement=St,p.isEmpty=Tt,p.isEqual=Ct,p.isFinite=Dt,p.isFunction=Et,p.isNaN=$t,p.isNull=At,p.isNumber=jt,p.isObject=Nt,p.isPlainObject=li,p.isRegExp=Pt,p.isString=Rt,p.isUndefined=It,p.lastIndexOf=_e,p.mixin=Je,p.noConflict=Ke,p.noop=tn,p.now=gi,p.parseInt=mi,p.random=nn,p.reduce=ne,p.reduceRight=ie,p.result=rn,p.runInContext=h,p.size=se,p.some=ue,p.sortedIndex=Te,p.template=on,p.unescape=sn,p.uniqueId=un,p.all=Wt,p.any=ue,p.detect=Gt,p.findWhere=Gt,p.foldl=ne,p.foldr=ie,p.include=Bt,p.inject=ne,Je(function(){var t={};return ui(p,function(e,n){p.prototype[n]||(t[n]=e)}),t}(),!1),p.first=ge,p.last=we,p.sample=oe,p.take=ge,p.head=ge,ui(p,function(t,e){var n="sample"!==e;p.prototype[e]||(p.prototype[e]=function(e,i){var r=this.__chain__,o=t(this.__wrapped__,e,i);return r||null!=e&&(!i||n&&"function"==typeof e)?new g(o,r):o})}),p.VERSION="2.4.1",p.prototype.chain=fn,p.prototype.toString=hn,p.prototype.value=dn,p.prototype.valueOf=dn,Qt(["join","pop","shift"],function(t){var e=Mn[t];p.prototype[t]=function(){var t=this.__chain__,n=e.apply(this.__wrapped__,arguments);return t?new g(n,t):n}}),Qt(["push","reverse","sort","unshift"],function(t){var e=Mn[t];p.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Qt(["concat","slice","splice"],function(t){var e=Mn[t];p.prototype[t]=function(){return new g(e.apply(this.__wrapped__,arguments),this.__chain__)}}),p}var d,p=[],g=[],m=0,v=+new Date+"",y=75,b=40,w=" 	\f\ufeff\n\r\u2028\u2029",_=/\b__p \+= '';/g,x=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g,M=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,S=/\w*$/,T=/^\s*function[ \n\r\t]+\w/,C=/<%=([\s\S]+?)%>/g,D=RegExp("^["+w+"]*0+(?=.$)"),E=/($^)/,N=/\bthis\b/,$=/['\n\r\t\u2028\u2029\\]/g,A=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],j=0,P="[object Arguments]",R="[object Array]",I="[object Boolean]",H="[object Date]",L="[object Function]",z="[object Number]",O="[object Object]",q="[object RegExp]",F="[object String]",Y={};Y[L]=!1,Y[P]=Y[R]=Y[I]=Y[H]=Y[z]=Y[O]=Y[q]=Y[F]=!0;var V={leading:!1,maxWait:0,trailing:!1},B={configurable:!1,enumerable:!1,value:null,writable:!1},W={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},G=W[typeof window]&&window||this,X=W[typeof exports]&&exports&&!exports.nodeType&&exports,Q=W[typeof module]&&module&&!module.nodeType&&module,Z=Q&&Q.exports===X&&X,J=W[typeof global]&&global;!J||J.global!==J&&J.window!==J||(G=J);var K=h();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(G._=K,define("underscore",[],function(){return K})):X&&Q?Z?(Q.exports=K)._=K:X._=K:G._=K}.call(this),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){var r=t.Backbone,o=[],a=(o.push,o.slice);o.splice,e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=e.Events={on:function(t,e,n){if(!l(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var r=this,o=n.once(function(){r.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var r,o,a,s,u,c,f,h;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(s=t?[t]:n.keys(this._events),u=0,c=s.length;c>u;u++)if(t=s[u],a=this._events[t]){if(this._events[t]=r=[],e||i)for(f=0,h=a.length;h>f;f++)o=a[f],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!l(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&c(n,e),i&&c(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t);for(var a in r)t=r[a],t.off(e,i,this),(o||n.isEmpty(t._events))&&delete this._listeningTo[a];return this}},u=/\s+/,l=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var o=n.split(u),a=0,s=o.length;s>a;a++)t[e].apply(t,[o[a]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},f={listenTo:"on",listenToOnce:"once"};n.each(f,function(t,e){s[e]=function(e,i,r){var o=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=n.uniqueId("l"));return o[a]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}}),s.bind=s.on,s.unbind=s.off,n.extend(e,s);var h=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,o,a,s,u,l,c,f;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;a=i.unset,u=i.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={}),f=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)e=o[r],n.isEqual(f[r],e)||s.push(r),n.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete f[r]:f[r]=e;if(!u){s.length&&(this._pending=i);for(var h=0,d=s.length;d>h;h++)this.trigger("change:"+s[h],this,f[s[h]],i)}if(l)return this;if(!u)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)n.isEqual(r[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return!!e.set(e.parse(n,t),t)&&(i&&i(e,n,t),void e.trigger("sync",e,n,t))},H(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,o,a,s=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},s,r)),void 0===i.parse&&(i.parse=!0);var u=this,l=i.success;return i.success=function(t){u.attributes=s;var e=u.parse(t,i);return i.wait&&(e=n.extend(r||{},e)),!(n.isObject(e)&&!u.set(e,i))&&(l&&l(u,t,i),void u.trigger("sync",u,t,i))},H(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=r),a=this.sync(o,this,i),r&&i.wait&&(this.attributes=s),a},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;H(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||I();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});var d=["keys","values","pairs","invert","pick","omit"];n.each(d,function(t){h.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(p.prototype,s,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var r,o,a,s;for(r=0,o=t.length;o>r;r++)s=t[r]=this.get(t[r]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,e.silent||(e.index=a,s.trigger("remove",s,this,e)),this._removeReference(s,e));return i?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var r,o,a,s,u,l,c,f=e.at,d=this.model,p=this.comparator&&null==f&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=e.add,_=e.merge,x=e.remove,k=!(p||!w||!x)&&[];for(r=0,o=t.length;o>r;r++){if(u=t[r]||{},a=u instanceof h?s=u:u[d.prototype.idAttribute||"id"],l=this.get(a))x&&(b[l.cid]=!0),_&&(u=u===s?s.attributes:u,e.parse&&(u=l.parse(u,e)),l.set(u,e),p&&!c&&l.hasChanged(m)&&(c=!0)),t[r]=l;else if(w){if(s=t[r]=this._prepareModel(u,e),!s)continue;v.push(s),this._addReference(s,e)}s=l||s,!k||!s.isNew()&&b[s.id]||k.push(s),b[s.id]=!0}if(x){for(r=0,o=this.length;o>r;++r)b[(s=this.models[r]).cid]||y.push(s);y.length&&this.remove(y,e)}if(v.length||k&&k.length)if(p&&(c=!0),this.length+=v.length,null!=f)for(r=0,o=v.length;o>r;r++)this.models.splice(f+r,0,v[r]);else{k&&(this.models.length=0);var M=k||v;for(r=0,o=M.length;o>r;r++)this.models.push(M[r])}if(c&&this.sort({silent:!0}),!e.silent){for(r=0,o=v.length;o>r;r++)(s=v[r]).trigger("add",s,this,e);(c||k&&k.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null!=t?this._byId[t]||this._byId[t.id]||this._byId[t.cid]:void 0},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},H(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(t){p.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}});var b=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(w),o=r[1],a=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,i):this.$el.on(o,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var o=k[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||I()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&x&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=e.ajax(n.extend(a,r));return i.trigger("request",i,u,r),u};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var M=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(M.prototype,s,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,function(n){var a=o._extractParameters(t,n);o.execute(r,a),o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),e.history.trigger("route",o,i,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(D,"\\$&").replace(S,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var E=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,$=/^\/+|\/+$/g,A=/msie [\w.]+/,j=/\/$/,P=/#.*$/;E.started=!1,n.extend(E.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(j,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(N,"")},start:function(t){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=A.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace($,"/"),o&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');

this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var s=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&s.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!E.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new E;var R=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};h.extend=p.extend=M.extend=b.extend=E.extend=R;var I=function(){throw new Error('A "url" property or function must be specified')},H=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),d3=function(){function t(t){return null!=t&&!isNaN(t)}function e(t){return t.length}function n(t){for(var e=1;t*e%1;)e*=10;return e}function i(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(n){t.prototype=e}}function r(){}function o(){}function a(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function s(){}function u(t){function e(){for(var e,i=n,r=-1,o=i.length;++r<o;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new r;return e.on=function(e,r){var o,a=i.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function l(){ao.event.stopPropagation(),ao.event.preventDefault()}function c(){for(var t,e=ao.event;t=e.sourceEvent;)e=t;return e}function f(t,e){function n(){t.on(e,null)}t.on(e,function(){l(),n()},!0),setTimeout(n,0)}function h(t){for(var e=new s,n=0,i=arguments.length;++n<i;)e[arguments[n]]=u(e);return e.of=function(n,i){return function(r){try{var o=r.sourceEvent=ao.event;r.target=t,ao.event=r,e[r.type].apply(n,i)}finally{ao.event=o}}},e}function d(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>go&&(uo.scrollX||uo.scrollY)){n=ao.select(so.body).append("svg").style("position","absolute").style("top",0).style("left",0);var r=n[0][0].getScreenCTM();go=!(r.f||r.e),n.remove()}return go?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function p(t){for(var e=-1,n=t.length,i=[];++e<n;)i.push(t[e]);return i}function g(t){return Array.prototype.slice.call(t)}function m(t){return vo(t,ko),t}function v(t){return function(){return yo(t,this)}}function y(t){return function(){return bo(t,this)}}function b(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=ao.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?s:a:t.local?o:r}function w(t){return t.trim().replace(/\s+/g," ")}function _(t){return new RegExp("(?:^|\\s+)"+ao.requote(t)+"(?:\\s+|$)","g")}function x(t,e){function n(){for(var n=-1;++n<r;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);++n<r;)t[n](this,i)}t=t.trim().split(/\s+/).map(k);var r=t.length;return"function"==typeof e?i:n}function k(t){var e=_(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",w(r+" "+t))):n.setAttribute("class",w(r.replace(e," ")))}}function M(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function o(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?o:r}function S(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function T(t){return{__data__:t}}function C(t){return function(){return xo(this,t)}}function D(t){return arguments.length||(t=ao.ascending),function(e,n){return!e-!n||t(e.__data__,n.__data__)}}function E(){}function N(t,e,n){function i(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function r(){var r=u(e,mo(arguments));i.call(this),this.addEventListener(t,this[a]=r,r.$=n),r._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+ao.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var a="__on"+t,s=t.indexOf("."),u=$;s>0&&(t=t.substring(0,s));var l=To.get(t);return l&&(t=l,u=A),s?e?r:i:e?E:o}function $(t,e){return function(n){var i=ao.event;ao.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{ao.event=i}}}function A(t,e){var n=$(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function j(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,o=t[n],a=0,s=o.length;s>a;a++)(r=o[a])&&e(r,a,n);return t}function P(t){return vo(t,Co),t}function R(){}function I(t,e,n){return new H(t,e,n)}function H(t,e,n){this.h=t,this.s=e,this.l=n}function L(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(a-o)*t/60:180>t?a:240>t?o+(a-o)*(240-t)/60:o}function r(t){return Math.round(255*i(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,a=.5>=n?n*(1+e):n+e-n*e,o=2*n-a,et(r(t+120),r(t),r(t-120))}function z(t){return t>0?1:0>t?-1:0}function O(t){return Math.acos(Math.max(-1,Math.min(1,t)))}function q(t){return t>1?jo/2:-1>t?-jo/2:Math.asin(t)}function F(t){return(Math.exp(t)-Math.exp(-t))/2}function Y(t){return(Math.exp(t)+Math.exp(-t))/2}function V(t){return(t=Math.sin(t/2))*t}function B(t,e,n){return new W(t,e,n)}function W(t,e,n){this.h=t,this.c=e,this.l=n}function U(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),G(n,Math.cos(t*=Ro)*e,Math.sin(t)*e)}function G(t,e,n){return new X(t,e,n)}function X(t,e,n){this.l=t,this.a=e,this.b=n}function Q(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return r=J(r)*zo,i=J(i)*Oo,o=J(o)*qo,et(tt(3.2404542*r-1.5371385*i-.4985314*o),tt(-.969266*r+1.8760108*i+.041556*o),tt(.0556434*r-.2040259*i+1.0572252*o))}function Z(t,e,n){return t>0?B(Math.atan2(n,e)*Io,Math.sqrt(e*e+n*n),t):B(0/0,0/0,t)}function J(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function K(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function tt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function et(t,e,n){return new nt(t,e,n)}function nt(t,e,n){this.r=t,this.g=e,this.b=n}function it(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function rt(t,e,n){var i,r,o,a=0,s=0,u=0;if(i=/([a-z]+)\((.*)\)/i.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(ut(r[0]),ut(r[1]),ut(r[2]))}return(o=Vo.get(t))?e(o.r,o.g,o.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(a=t.charAt(1),a+=a,s=t.charAt(2),s+=s,u=t.charAt(3),u+=u):7===t.length&&(a=t.substring(1,3),s=t.substring(3,5),u=t.substring(5,7)),a=parseInt(a,16),s=parseInt(s,16),u=parseInt(u,16)),e(a,s,u))}function ot(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,u=(a+o)/2;return s?(r=.5>u?s/(a+o):s/(2-a-o),i=t==a?(e-n)/s+(n>e?6:0):e==a?(n-t)/s+2:(t-e)/s+4,i*=60):(i=0/0,r=u>0&&1>u?0:i),I(i,r,u)}function at(t,e,n){t=st(t),e=st(e),n=st(n);var i=K((.4124564*t+.3575761*e+.1804375*n)/zo),r=K((.2126729*t+.7151522*e+.072175*n)/Oo),o=K((.0193339*t+.119192*e+.9503041*n)/qo);return G(116*r-16,500*(i-r),200*(r-o))}function st(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ut(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function lt(t){return"function"==typeof t?t:function(){return t}}function ct(t){return t}function ft(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),ht(e,n,t,i)}}function ht(t,e,n,i){function r(){var t,e=u.status;if(!e&&u.responseText||e>=200&&300>e||304===e){try{t=n.call(o,u)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,u)}var o={},a=ao.dispatch("progress","load","error"),s={},u=new(uo.XDomainRequest&&/^(http(s)?:)?\/\//.test(t)?XDomainRequest:XMLHttpRequest);return"onload"in u?u.onload=u.onerror=r:u.onreadystatechange=function(){u.readyState>3&&r()},u.onprogress=function(t){var e=ao.event;ao.event=t;try{a.progress.call(o,u)}finally{ao.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(mo(arguments)))}}),o.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),u.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),u.setRequestHeader)for(var a in s)u.setRequestHeader(a,s[a]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),u.send(null==i?null:i),o},o.abort=function(){return u.abort(),o},ao.rebind(o,a,"on"),null==i?o:o.get(dt(i))}function dt(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function pt(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var a=ao.xhr(t,e,o);return a.row=function(t){return arguments.length?a.response(null==(n=t)?i:r(t)):n},a.row(n)}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function a(e){return e.map(s).join(t)}function s(t){return u.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var u=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=u)return a;if(r)return r=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.substring(e+1,n).replace(/""/g,'"')}for(;u>c;){var i=t.charCodeAt(c++),s=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++s);else if(i!==l)continue;return t.substring(e,c-s)}return t.substring(e)}for(var i,r,o={},a={},s=[],u=t.length,c=0,f=0;(i=n())!==a;){for(var h=[];i!==o&&i!==a;)h.push(i),i=n();e&&!(h=e(h,f++))||s.push(h)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new o,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(s).join(t)].concat(e.map(function(e){return r.map(function(t){return s(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(a).join("\n")},n}function gt(){var t=mt(),e=vt()-t;e>24?(isFinite(e)&&(clearTimeout(Go),Go=setTimeout(gt,e)),Uo=0):(Uo=1,Xo(gt))}function mt(){for(var t=Date.now(),e=Bo;e;)t>=e.time&&(e.flush=e.callback(t-e.time)),e=e.next;return t}function vt(){for(var t,e=Bo,n=1/0;e;)e.flush?e=t?t.next=e.next:Bo=e.next:(e.time<n&&(n=e.time),e=(t=e).next);return Wo=t,n}function yt(t,e){var n=Math.pow(10,3*Math.abs(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function bt(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function wt(t){return t+""}function _t(t,e){t&&oa.hasOwnProperty(t.type)&&oa[t.type](t,e)}function xt(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1]);e.lineEnd()}function kt(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)xt(t[n],e,1);e.polygonEnd()}function Mt(){function t(t,e){t*=Ro,e=e*Ro/2+jo/4;var n=t-i,a=Math.cos(e),s=Math.sin(e),u=o*s,l=r*a+u*Math.cos(n),c=u*Math.sin(n);sa+=Math.atan2(c,l),i=t,r=a,o=s}var e,n,i,r,o;ua.point=function(a,s){ua.point=t,i=(e=a)*Ro,r=Math.cos(s=(n=s)*Ro/2+jo/4),o=Math.sin(s)},ua.lineEnd=function(){t(e,n)}}function St(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Tt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ct(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Dt(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Et(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Nt(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function $t(t){return[Math.atan2(t[1],t[0]),Math.asin(Math.max(-1,Math.min(1,t[2])))]}function At(t,e){return Math.abs(t[0]-e[0])<Po&&Math.abs(t[1]-e[1])<Po}function jt(t,e){if(!la){++ca,t*=Ro;var n=Math.cos(e*=Ro);fa+=(n*Math.cos(t)-fa)/ca,ha+=(n*Math.sin(t)-ha)/ca,da+=(Math.sin(e)-da)/ca}}function Pt(){var t,e;la=1,Rt(),la=2;var n=pa.point;pa.point=function(i,r){n(t=i,e=r)},pa.lineEnd=function(){pa.point(t,e),It(),pa.lineEnd=It}}function Rt(){function t(t,r){t*=Ro;var o=Math.cos(r*=Ro),a=o*Math.cos(t),s=o*Math.sin(t),u=Math.sin(r),l=Math.atan2(Math.sqrt((l=n*u-i*s)*l+(l=i*a-e*u)*l+(l=e*s-n*a)*l),e*a+n*s+i*u);ca+=l,fa+=l*(e+(e=a)),ha+=l*(n+(n=s)),da+=l*(i+(i=u))}var e,n,i;la>1||(1>la&&(la=1,ca=fa=ha=da=0),pa.point=function(r,o){r*=Ro;var a=Math.cos(o*=Ro);e=a*Math.cos(r),n=a*Math.sin(r),i=Math.sin(o),pa.point=t})}function It(){pa.point=jt}function Ht(){return!0}function Lt(t,e,n,i,r){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(At(n,i)){r.lineStart();for(var s=0;e>s;++s)r.point((n=t[s])[0],n[1]);return void r.lineEnd()}var u={point:n,points:t,other:null,visited:!1,entry:!0,subject:!0},l={point:n,points:[n],other:u,visited:!1,entry:!1,subject:!1};u.other=l,o.push(u),a.push(l),u={point:i,points:[i],other:null,visited:!1,entry:!1,subject:!0},l={point:i,points:[i],other:u,visited:!1,entry:!0,subject:!1},u.other=l,o.push(u),a.push(l)}}),a.sort(e),zt(o),zt(a),o.length){if(n)for(var s=1,u=!n(a[0].point),l=a.length;l>s;++s)a[s].entry=u=!u;for(var c,f,h,d=o[0];;){for(c=d;c.visited;)if((c=c.next)===d)return;f=c.points,r.lineStart();do{if(c.visited=c.other.visited=!0,c.entry){if(c.subject)for(var s=0;s<f.length;s++)r.point((h=f[s])[0],h[1]);else i(c.point,c.next.point,1,r);c=c.next}else{if(c.subject){f=c.prev.points;for(var s=f.length;--s>=0;)r.point((h=f[s])[0],h[1])}else i(c.point,c.prev.point,-1,r);c=c.prev}c=c.other,f=c.points}while(!c.visited);r.lineEnd()}}}function zt(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.next=n=t[i],n.prev=r,r=n;r.next=n=t[0],n.prev=r}}function Ot(t,e,n){return function(i){function r(e,n){t(e,n)&&i.point(e,n)}function o(t,e){m.point(t,e)}function a(){v.point=o,m.lineStart()}function s(){v.point=r,m.lineEnd()}function u(t,e){b.point(t,e),g.push([t,e])}function l(){b.lineStart(),g=[]}function c(){u(g[0][0],g[0][1]),b.lineEnd();var t,e=b.clean(),n=y.buffer(),r=n.length;if(!r)return p=!0,d+=Yt(g,-1),void(g=null);if(g=null,1&e){t=n[0],h+=Yt(t,1);var o,r=t.length-1,a=-1;for(i.lineStart();++a<r;)i.point((o=t[a])[0],o[1]);return void i.lineEnd()}r>1&&2&e&&n.push(n.pop().concat(n.shift())),f.push(n.filter(qt))}var f,h,d,p,g,m=e(i),v={point:r,lineStart:a,lineEnd:s,polygonStart:function(){v.point=u,v.lineStart=l,v.lineEnd=c,p=!1,d=h=0,f=[],i.polygonStart()},polygonEnd:function(){v.point=r,v.lineStart=a,v.lineEnd=s,f=ao.merge(f),f.length?Lt(f,Vt,null,n,i):(-Po>h||p&&-Po>d)&&(i.lineStart(),n(null,null,1,i),i.lineEnd()),i.polygonEnd(),f=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}},y=Ft(),b=e(y);return v}}function qt(t){return t.length>1}function Ft(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:E,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Yt(t,e){if(!(n=t.length))return 0;for(var n,i,r,o=0,a=0,s=t[0],u=s[0],l=s[1],c=Math.cos(l),f=Math.atan2(e*Math.sin(u)*c,Math.sin(l)),h=1-e*Math.cos(u)*c,d=f;++o<n;)s=t[o],c=Math.cos(l=s[1]),i=Math.atan2(e*Math.sin(u=s[0])*c,Math.sin(l)),r=1-e*Math.cos(u)*c,Math.abs(h-2)<Po&&Math.abs(r-2)<Po||(Math.abs(r)<Po||Math.abs(h)<Po||(Math.abs(Math.abs(i-f)-jo)<Po?r+h>2&&(a+=4*(i-f)):a+=Math.abs(h-2)<Po?4*(i-d):((3*jo+i-f)%(2*jo)-jo)*(h+r)),d=f,f=i,h=r);return a}function Vt(t,e){return((t=t.point)[0]<0?t[1]-jo/2-Po:jo/2-t[1])-((e=e.point)[0]<0?e[1]-jo/2-Po:jo/2-e[1])}function Bt(t){var e,n=0/0,i=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?jo:-jo,u=Math.abs(o-n);Math.abs(u-jo)<Po?(t.point(n,i=(i+a)/2>0?jo/2:-jo/2),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&u>=jo&&(Math.abs(n-r)<Po&&(n-=r*Po),Math.abs(o-s)<Po&&(o-=s*Po),i=Wt(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=0/0},clean:function(){return 2-e}}}function Wt(t,e,n,i){var r,o,a=Math.sin(t-n);return Math.abs(a)>Po?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*a)):(e+i)/2}function Ut(t,e,n,i){var r;if(null==t)r=n*jo/2,i.point(-jo,r),i.point(0,r),i.point(jo,r),i.point(jo,0),i.point(jo,-r),i.point(0,-r),i.point(-jo,-r),i.point(-jo,0),i.point(-jo,r);else if(Math.abs(t[0]-e[0])>Po){var o=(t[0]<e[0]?1:-1)*jo;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}function Gt(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(f,h){var d,p=[f,h],g=e(f,h),m=a?g?0:r(f,h):g?r(f+(0>f?jo:-jo),h):0;if(!n&&(l=u=g)&&t.lineStart(),g!==u&&(d=i(n,p),(At(n,d)||At(p,d))&&(p[0]+=Po,p[1]+=Po,g=e(p[0],p[1]))),g!==u)c=0,g?(t.lineStart(),d=i(p,n),t.point(d[0],d[1])):(d=i(n,p),t.point(d[0],d[1]),t.lineEnd()),n=d;else if(s&&n&&a^g){var v;m&o||!(v=i(p,n,!0))||(c=0,a?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||n&&At(n,p)||t.point(p[0],p[1]),n=p,u=g,o=m},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return c|(l&&u)<<1}}}function i(t,e,n){var i=St(t),r=St(e),a=[1,0,0],s=Ct(i,r),u=Tt(s,s),l=s[0],c=u-l*l;if(!c)return!n&&t;var f=o*u/c,h=-o*l/c,d=Ct(a,s),p=Et(a,f),g=Et(s,h);Dt(p,g);var m=d,v=Tt(p,m),y=Tt(m,m),b=v*v-y*(Tt(p,p)-1);if(!(0>b)){var w=Math.sqrt(b),_=Et(m,(-v-w)/y);if(Dt(_,p),_=$t(_),!n)return _;var x,k=t[0],M=e[0],S=t[1],T=e[1];k>M&&(x=k,k=M,M=x);var C=M-k,D=Math.abs(C-jo)<Po,E=D||Po>C;if(!D&&S>T&&(x=S,S=T,T=x),E?D?S+T>0^_[1]<(Math.abs(_[0]-k)<Po?S:T):S<=_[1]&&_[1]<=T:C>jo^(k<=_[0]&&_[0]<=M)){var N=Et(m,(-v+w)/y);return Dt(N,p),[_,$t(N)]}}}function r(e,n){var i=a?t:jo-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var o=Math.cos(t),a=o>0,s=Math.abs(o)>Po,u=se(t,6*Ro);return Ot(e,n,u)}function Xt(t,e,n,i){function r(i,r){return Math.abs(i[0]-t)<Po?r>0?0:3:Math.abs(i[0]-n)<Po?r>0?2:1:Math.abs(i[1]-e)<Po?r>0?1:0:r>0?3:2}function o(t,e){return a(t.point,e.point)}function a(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}function s(r,o){var a=o[0]-r[0],s=o[1]-r[1],u=[0,1];return Math.abs(a)<Po&&Math.abs(s)<Po?t<=r[0]&&r[0]<=n&&e<=r[1]&&r[1]<=i:!!(Qt(t-r[0],a,u)&&Qt(r[0]-n,-a,u)&&Qt(e-r[1],s,u)&&Qt(r[1]-i,-s,u))&&(u[1]<1&&(o[0]=r[0]+u[1]*a,o[1]=r[1]+u[1]*s),u[0]>0&&(r[0]+=u[0]*a,r[1]+=u[0]*s),!0)}return function(u){function l(o){var a=r(o,-1),s=c([0===a||3===a?t:n,a>1?i:e]);return s}function c(t){for(var e=0,n=b.length,i=t[1],r=0;n>r;++r)for(var o,a=1,s=b[r],u=s.length,l=s[0];u>a;++a)o=s[a],l[1]<=i?o[1]>i&&f(l,o,t)>0&&++e:o[1]<=i&&f(l,o,t)<0&&--e,l=o;return 0!==e}function f(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function h(o,s,u,l){var c=0,f=0;if(null==o||(c=r(o,u))!==(f=r(s,u))||a(o,s)<0^u>0){do l.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+u+4)%4)!==f)}else l.point(s[0],s[1])}function d(r,o){return r>=t&&n>=r&&o>=e&&i>=o}function p(t,e){d(t,e)&&u.point(t,e)}function g(){N.point=v,b&&b.push(w=[]),C=!0,T=!1,M=S=0/0}function m(){y&&(v(_,x),k&&T&&E.rejoin(),y.push(E.buffer())),N.point=p,T&&u.lineEnd()}function v(t,e){t=Math.max(-ma,Math.min(ma,t)),e=Math.max(-ma,Math.min(ma,e));var n=d(t,e);if(b&&w.push([t,e]),C)_=t,x=e,k=n,C=!1,n&&(u.lineStart(),u.point(t,e));else if(n&&T)u.point(t,e);else{var i=[M,S],r=[t,e];s(i,r)?(T||(u.lineStart(),u.point(i[0],i[1])),u.point(r[0],r[1]),n||u.lineEnd()):n&&(u.lineStart(),u.point(t,e))}M=t,S=e,T=n}var y,b,w,_,x,k,M,S,T,C,D=u,E=Ft(),N={point:p,lineStart:g,lineEnd:m,polygonStart:function(){u=E,y=[],b=[]},polygonEnd:function(){u=D,(y=ao.merge(y)).length?(u.polygonStart(),Lt(y,o,l,h,u),u.polygonEnd()):c([t,e])&&(u.polygonStart(),u.lineStart(),h(null,null,1,u),u.lineEnd(),u.polygonEnd()),y=b=w=null}};return N}}function Qt(t,e,n){if(Math.abs(e)<Po)return 0>=t;var i=t/e;if(e>0){if(i>n[1])return!1;i>n[0]&&(n[0]=i)}else{if(i<n[0])return!1;i<n[1]&&(n[1]=i)}return!0}function Zt(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function Jt(t){function e(e){function i(n,i){n=t(n,i),e.point(n[0],n[1])}function o(){c=0/0,g.point=a,e.lineStart()}function a(i,o){var a=St([i,o]),s=t(i,o);n(c,f,l,h,d,p,c=s[0],f=s[1],l=i,h=a[0],d=a[1],p=a[2],r,e),e.point(c,f)}function s(){g.point=i,e.lineEnd()}function u(){var t,i,u,m,v,y,b;o(),g.point=function(e,n){a(t=e,i=n),u=c,m=f,v=h,y=d,b=p,g.point=a},g.lineEnd=function(){n(c,f,l,h,d,p,u,m,t,v,y,b,r,e),g.lineEnd=s,s()}}var l,c,f,h,d,p,g={point:i,lineStart:o,lineEnd:s,polygonStart:function(){e.polygonStart(),g.lineStart=u},polygonEnd:function(){e.polygonEnd(),g.lineStart=o}};return g}function n(e,r,o,a,s,u,l,c,f,h,d,p,g,m){var v=l-e,y=c-r,b=v*v+y*y;if(b>4*i&&g--){var w=a+h,_=s+d,x=u+p,k=Math.sqrt(w*w+_*_+x*x),M=Math.asin(x/=k),S=Math.abs(Math.abs(x)-1)<Po?(o+f)/2:Math.atan2(_,w),T=t(S,M),C=T[0],D=T[1],E=C-e,N=D-r,$=y*E-v*N;($*$/b>i||Math.abs((v*E+y*N)/b-.5)>.3)&&(n(e,r,o,a,s,u,C,D,S,w/=k,_/=k,x,g,m),m.point(C,D),n(C,D,S,w,_,x,l,c,f,h,d,p,g,m))}}var i=.5,r=16;return e.precision=function(t){return arguments.length?(r=(i=t*t)>0&&16,e):Math.sqrt(i)},e}function Kt(t){return te(function(){return t})()}function te(t){function e(t){return t=a(t[0]*Ro,t[1]*Ro),[t[0]*c+s,u-t[1]*c]}function n(t){return t=a.invert((t[0]-s)/c,(u-t[1])/c),t&&[t[0]*Io,t[1]*Io]}function i(){a=Zt(o=ie(g,m,v),r);var t=r(d,p);return s=f-t[0]*c,u=h+t[1]*c,e}var r,o,a,s,u,l=Jt(function(t,e){return t=r(t,e),[t[0]*c+s,u-t[1]*c]}),c=150,f=480,h=250,d=0,p=0,g=0,m=0,v=0,y=ga,b=ct,w=null,_=null;return e.stream=function(t){return ee(o,y(l(b(t))))},e.clipAngle=function(t){return arguments.length?(y=null==t?(w=t,ga):Gt((w=+t)*Ro),e):w},e.clipExtent=function(t){return arguments.length?(_=t,b=null==t?ct:Xt(t[0][0],t[0][1],t[1][0],t[1][1]),e):_},e.scale=function(t){return arguments.length?(c=+t,i()):c},e.translate=function(t){return arguments.length?(f=+t[0],h=+t[1],i()):[f,h]},e.center=function(t){return arguments.length?(d=t[0]%360*Ro,p=t[1]%360*Ro,i()):[d*Io,p*Io]},e.rotate=function(t){return arguments.length?(g=t[0]%360*Ro,m=t[1]%360*Ro,v=t.length>2?t[2]%360*Ro:0,i()):[g*Io,m*Io,v*Io]},ao.rebind(e,l,"precision"),function(){return r=t.apply(this,arguments),e.invert=r.invert&&n,i()}}function ee(t,e){return{point:function(n,i){i=t(n*Ro,i*Ro),n=i[0],e.point(n>jo?n-2*jo:-jo>n?n+2*jo:n,i[1])},sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function ne(t,e){return[t,e]}function ie(t,e,n){return t?e||n?Zt(oe(t),ae(e,n)):oe(t):e||n?ae(e,n):ne}function re(t){return function(e,n){return e+=t,[e>jo?e-2*jo:-jo>e?e+2*jo:e,n]}}function oe(t){var e=re(t);return e.invert=re(-t),e}function ae(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*i+s*r;return[Math.atan2(u*o-c*a,s*i-l*r),Math.asin(Math.max(-1,Math.min(1,c*o+u*a)))]}var i=Math.cos(t),r=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*o-u*a;return[Math.atan2(u*o+l*a,s*i+c*r),Math.asin(Math.max(-1,Math.min(1,c*i-s*r)))]},n}function se(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,a,s){null!=r?(r=ue(n,r),o=ue(n,o),(a>0?o>r:r>o)&&(r+=2*a*jo)):(r=t+2*a*jo,o=t);for(var u,l=a*e,c=r;a>0?c>o:o>c;c-=l)s.point((u=$t([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function ue(t,e){var n=St(e);n[0]-=t,Nt(n);var i=O(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-Po)%(2*Math.PI)}function le(t,e,n){var i=ao.range(t,e-Po,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function ce(t,e,n){var i=ao.range(t,e-Po,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function fe(t){return t.source}function he(t){return t.target}function de(t,e,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),s=Math.sin(i),u=r*Math.cos(t),l=r*Math.sin(t),c=a*Math.cos(n),f=a*Math.sin(n),h=2*Math.asin(Math.sqrt(V(i-e)+r*a*V(n-t))),d=1/Math.sin(h),p=h?function(t){var e=Math.sin(t*=h)*d,n=Math.sin(h-t)*d,i=n*u+e*c,r=n*l+e*f,a=n*o+e*s;return[Math.atan2(r,i)*Io,Math.atan2(a,Math.sqrt(i*i+r*r))*Io]}:function(){return[t*Io,e*Io]};return p.distance=h,p}function pe(){function t(t,r){var o=Math.sin(r*=Ro),a=Math.cos(r),s=Math.abs((t*=Ro)-e),u=Math.cos(s);va+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=i*o-n*a*u)*s),n*o+i*a*u),e=t,n=o,i=a}var e,n,i;ya.point=function(r,o){e=r*Ro,n=Math.sin(o*=Ro),i=Math.cos(o),ya.point=t},ya.lineEnd=function(){ya.point=ya.lineEnd=E}}function ge(t){var e=0,n=jo/3,i=te(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*jo/180,n=t[1]*jo/180):[e/jo*180,n/jo*180]},r}function me(t,e){function n(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),a-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,o=1+i*(2*r-i),a=Math.sqrt(o)/r;return n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,q((o-(t*t+n*n)*r*r)/(2*r))]},n}function ve(){function t(t,e){wa+=r*t-i*e,i=t,r=e}var e,n,i,r;Sa.point=function(o,a){Sa.point=t,e=i=o,n=r=a},Sa.lineEnd=function(){t(e,n)}}function ye(t,e){_a>t&&(_a=t),t>ka&&(ka=t),xa>e&&(xa=e),e>Ma&&(Ma=e)}function be(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=n}function n(t,e){a.push("L",t,",",e)}function i(){s.point=t}function r(){a.push("Z")}var o=we(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return o=we(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function we(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function _e(t,e){la||(fa+=t,ha+=e,++da)}function xe(){function t(t,i){var r=t-e,o=i-n,a=Math.sqrt(r*r+o*o);fa+=a*(e+t)/2,ha+=a*(n+i)/2,da+=a,e=t,n=i}var e,n;if(1!==la){if(!(1>la))return;la=1,fa=ha=da=0}Ca.point=function(i,r){Ca.point=t,e=i,n=r}}function ke(){Ca.point=_e}function Me(){function t(t,e){var n=r*t-i*e;fa+=n*(i+t),ha+=n*(r+e),da+=3*n,i=t,r=e}var e,n,i,r;2>la&&(la=2,fa=ha=da=0),Ca.point=function(o,a){Ca.point=t,e=i=o,n=r=a},Ca.lineEnd=function(){t(e,n)}}function Se(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,a,0,2*jo)}function n(e,n){t.moveTo(e,n),s.point=i}function i(e,n){t.lineTo(e,n)}function r(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(t){return a=t,s},result:E};return s}function Te(t){var e=Jt(function(e,n){return t([e*Io,n*Io])});return function(t){return t=e(t),{point:function(e,n){t.point(e*Ro,n*Ro)},sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}}function Ce(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*o,i*a),Math.asin(i&&n*o/i)]},n}function De(t,e){function n(t,e){var n=Math.abs(Math.abs(e)-jo/2)<Po?0:a/Math.pow(r(e),o);return[n*Math.sin(o*t),a-n*Math.cos(o*t)]}var i=Math.cos(t),r=function(t){return Math.tan(jo/4+t/2)},o=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),a=i*Math.pow(r(t),o)/o;return o?(n.invert=function(t,e){var n=a-e,i=z(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(a/i,1/o))-jo/2]},n):Ne}function Ee(t,e){function n(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),o=i/r+t;return Math.abs(r)<Po?ne:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-z(r)*Math.sqrt(t*t+n*n)]},n)}function Ne(t,e){return[t,Math.log(Math.tan(jo/4+e/2))]}function $e(t){var e,n=Kt(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=jo*i(),u=r();o([[u[0]-s,u[1]-s],[u[0]+s,u[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}function Ae(t,e){var n=Math.cos(e)*Math.sin(t);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(e),Math.cos(t))]}function je(t){function e(e){function a(){l.push("M",o(t(c),s))}for(var u,l=[],c=[],f=-1,h=e.length,d=lt(n),p=lt(i);++f<h;)r.call(this,u=e[f],f)?c.push([+d.call(this,u,f),+p.call(this,u,f)]):c.length&&(a(),c=[]);return c.length&&a(),l.length?l.join(""):null}var n=Pe,i=Re,r=Ht,o=Ie,a=o.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){
return arguments.length?(a="function"==typeof t?o=t:(o=ja.get(t)||Ie).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function Pe(t){return t[0]}function Re(t){return t[1]}function Ie(t){return t.join("L")}function He(t){return Ie(t)+"Z"}function Le(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function ze(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Oe(t,e){return t.length<4?Ie(t):t[1]+Ye(t.slice(1,t.length-1),Ve(t,e))}function qe(t,e){return t.length<3?Ie(t):t[0]+Ye((t.push(t[0]),t),Ve([t[t.length-2]].concat(t,[t[1]]),e))}function Fe(t,e){return t.length<3?Ie(t):t[0]+Ye(t,Ve(t,e))}function Ye(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return Ie(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],a=e[0],s=a,u=1;if(n&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=t[1],u=2),e.length>1){s=e[1],o=t[u],u++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var l=2;l<e.length;l++,u++)o=t[u],s=e[l],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[u];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function Ve(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],a=t[1],s=1,u=t.length;++s<u;)n=o,o=a,a=t[s],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function Be(t){if(t.length<3)return Ie(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],a=[r,r,r,(i=t[1])[0]],s=[o,o,o,i[1]],u=[r,",",o];for(Qe(u,a,s);++e<n;)i=t[e],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),Qe(u,a,s);for(e=-1;++e<2;)a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),Qe(u,a,s);return u.join("")}function We(t){if(t.length<4)return Ie(t);for(var e,n=[],i=-1,r=t.length,o=[0],a=[0];++i<3;)e=t[i],o.push(e[0]),a.push(e[1]);for(n.push(Xe(Ia,o)+","+Xe(Ia,a)),--i;++i<r;)e=t[i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Qe(n,o,a);return n.join("")}function Ue(t){for(var e,n,i=-1,r=t.length,o=r+4,a=[],s=[];++i<4;)n=t[i%r],a.push(n[0]),s.push(n[1]);for(e=[Xe(Ia,a),",",Xe(Ia,s)],--i;++i<o;)n=t[i%r],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),Qe(e,a,s);return e.join("")}function Ge(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],a=t[0][1],s=t[n][0]-o,u=t[n][1]-a,l=-1;++l<=n;)i=t[l],r=l/n,i[0]=e*i[0]+(1-e)*(o+r*s),i[1]=e*i[1]+(1-e)*(a+r*u);return Be(t)}function Xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Qe(t,e,n){t.push("C",Xe(Pa,e),",",Xe(Pa,n),",",Xe(Ra,e),",",Xe(Ra,n),",",Xe(Ia,e),",",Xe(Ia,n))}function Ze(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Je(t){for(var e=0,n=t.length-1,i=[],r=t[0],o=t[1],a=i[0]=Ze(r,o);++e<n;)i[e]=(a+(a=Ze(r=o,o=t[e+1])))/2;return i[e]=a,i}function Ke(t){for(var e,n,i,r,o=[],a=Je(t),s=-1,u=t.length-1;++s<u;)e=Ze(t[s],t[s+1]),Math.abs(e)<1e-6?a[s]=a[s+1]=0:(n=a[s]/e,i=a[s+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),a[s]=r*n,a[s+1]=r*i));for(s=-1;++s<=u;)r=(t[Math.min(u,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function tn(t){return t.length<3?Ie(t):t[0]+Ye(t,Ke(t))}function en(t,e,n,i){var r,o,a,s,u,l,c;return r=i[t],o=r[0],a=r[1],r=i[e],s=r[0],u=r[1],r=i[n],l=r[0],c=r[1],(c-a)*(s-o)-(u-a)*(l-o)>0}function nn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function rn(t,e,n,i){var r=t[0],o=n[0],a=e[0]-r,s=i[0]-o,u=t[1],l=n[1],c=e[1]-u,f=i[1]-l,h=(s*(u-l)-f*(r-o))/(f*a-s*c);return[r+h*a,u+h*c]}function on(t,e){var n={list:t.map(function(t,e){return{index:e,x:t[0],y:t[1]}}).sort(function(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0}),bottomSite:null},i={list:[],leftEnd:null,rightEnd:null,init:function(){i.leftEnd=i.createHalfEdge(null,"l"),i.rightEnd=i.createHalfEdge(null,"l"),i.leftEnd.r=i.rightEnd,i.rightEnd.l=i.leftEnd,i.list.unshift(i.leftEnd,i.rightEnd)},createHalfEdge:function(t,e){return{edge:t,side:e,vertex:null,l:null,r:null}},insert:function(t,e){e.l=t,e.r=t.r,t.r.l=e,t.r=e},leftBound:function(t){var e=i.leftEnd;do e=e.r;while(e!=i.rightEnd&&r.rightOf(e,t));return e=e.l},del:function(t){t.l.r=t.r,t.r.l=t.l,t.edge=null},right:function(t){return t.r},left:function(t){return t.l},leftRegion:function(t){return null==t.edge?n.bottomSite:t.edge.region[t.side]},rightRegion:function(t){return null==t.edge?n.bottomSite:t.edge.region[Ha[t.side]]}},r={bisect:function(t,e){var n={region:{l:t,r:e},ep:{l:null,r:null}},i=e.x-t.x,r=e.y-t.y,o=i>0?i:-i,a=r>0?r:-r;return n.c=t.x*i+t.y*r+.5*(i*i+r*r),o>a?(n.a=1,n.b=r/i,n.c/=i):(n.b=1,n.a=i/r,n.c/=r),n},intersect:function(t,e){var n=t.edge,i=e.edge;if(!n||!i||n.region.r==i.region.r)return null;var r=n.a*i.b-n.b*i.a;if(Math.abs(r)<1e-10)return null;var o,a,s=(n.c*i.b-i.c*n.b)/r,u=(i.c*n.a-n.c*i.a)/r,l=n.region.r,c=i.region.r;l.y<c.y||l.y==c.y&&l.x<c.x?(o=t,a=n):(o=e,a=i);var f=s>=a.region.r.x;return f&&"l"===o.side||!f&&"r"===o.side?null:{x:s,y:u}},rightOf:function(t,e){var n=t.edge,i=n.region.r,r=e.x>i.x;if(r&&"l"===t.side)return 1;if(!r&&"r"===t.side)return 0;if(1===n.a){var o=e.y-i.y,a=e.x-i.x,s=0,u=0;if(!r&&n.b<0||r&&n.b>=0?u=s=o>=n.b*a:(u=e.x+e.y*n.b>n.c,n.b<0&&(u=!u),u||(s=1)),!s){var l=i.x-n.region.l.x;u=n.b*(a*a-o*o)<l*o*(1+2*a/l+n.b*n.b),n.b<0&&(u=!u)}}else{var c=n.c-n.a*e.x,f=e.y-c,h=e.x-i.x,d=c-i.y;u=f*f>h*h+d*d}return"l"===t.side?u:!u},endPoint:function(t,n,i){t.ep[n]=i,t.ep[Ha[n]]&&e(t)},distance:function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},o={list:[],insert:function(t,e,n){t.vertex=e,t.ystar=e.y+n;for(var i=0,r=o.list,a=r.length;a>i;i++){var s=r[i];if(!(t.ystar>s.ystar||t.ystar==s.ystar&&e.x>s.vertex.x))break}r.splice(i,0,t)},del:function(t){for(var e=0,n=o.list,i=n.length;i>e&&n[e]!=t;++e);n.splice(e,1)},empty:function(){return 0===o.list.length},nextEvent:function(t){for(var e=0,n=o.list,i=n.length;i>e;++e)if(n[e]==t)return n[e+1];return null},min:function(){var t=o.list[0];return{x:t.vertex.x,y:t.ystar}},extractMin:function(){return o.list.shift()}};i.init(),n.bottomSite=n.list.shift();for(var a,s,u,l,c,f,h,d,p,g,m,v,y,b=n.list.shift();;)if(o.empty()||(a=o.min()),b&&(o.empty()||b.y<a.y||b.y==a.y&&b.x<a.x))s=i.leftBound(b),u=i.right(s),h=i.rightRegion(s),v=r.bisect(h,b),f=i.createHalfEdge(v,"l"),i.insert(s,f),g=r.intersect(s,f),g&&(o.del(s),o.insert(s,g,r.distance(g,b))),s=f,f=i.createHalfEdge(v,"r"),i.insert(s,f),g=r.intersect(f,u),g&&o.insert(f,g,r.distance(g,b)),b=n.list.shift();else{if(o.empty())break;s=o.extractMin(),l=i.left(s),u=i.right(s),c=i.right(u),h=i.leftRegion(s),d=i.rightRegion(u),m=s.vertex,r.endPoint(s.edge,s.side,m),r.endPoint(u.edge,u.side,m),i.del(s),o.del(u),i.del(u),y="l",h.y>d.y&&(p=h,h=d,d=p,y="r"),v=r.bisect(h,d),f=i.createHalfEdge(v,y),i.insert(l,f),r.endPoint(v,Ha[y],m),g=r.intersect(l,f),g&&(o.del(l),o.insert(l,g,r.distance(g,h))),g=r.intersect(f,c),g&&o.insert(f,g,r.distance(g,h))}for(s=i.right(i.leftEnd);s!=i.rightEnd;s=i.right(s))e(s.edge)}function an(t){return t.x}function sn(t){return t.y}function un(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ln(t,e,n,i,r,o){if(!t(e,n,i,r,o)){var a=.5*(n+r),s=.5*(i+o),u=e.nodes;u[0]&&ln(t,u[0],n,i,a,s),u[1]&&ln(t,u[1],a,i,r,s),u[2]&&ln(t,u[2],n,s,a,o),u[3]&&ln(t,u[3],a,s,r,o)}}function cn(t,e){t=ao.rgb(t),e=ao.rgb(e);var n=t.r,i=t.g,r=t.b,o=e.r-n,a=e.g-i,s=e.b-r;return function(t){return"#"+it(Math.round(n+o*t))+it(Math.round(i+a*t))+it(Math.round(r+s*t))}}function fn(t){var e=[t.a,t.b],n=[t.c,t.d],i=dn(e),r=hn(e,n),o=dn(pn(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Io,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*Io:0}function hn(t,e){return t[0]*e[0]+t[1]*e[1]}function dn(t){var e=Math.sqrt(hn(t,t));return e&&(t[0]/=e,t[1]/=e),e}function pn(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function gn(t,e){return e-=t=+t,function(n){return t+e*n}}function mn(t,e){var n,i=[],r=[],o=ao.transform(t),a=ao.transform(e),s=o.translate,u=a.translate,l=o.rotate,c=a.rotate,f=o.skew,h=a.skew,d=o.scale,p=a.scale;return s[0]!=u[0]||s[1]!=u[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:gn(s[0],u[0])},{i:3,x:gn(s[1],u[1])})):i.push(u[0]||u[1]?"translate("+u+")":""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:gn(l,c)})):c&&i.push(i.pop()+"rotate("+c+")"),f!=h?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:gn(f,h)}):h&&i.push(i.pop()+"skewX("+h+")"),d[0]!=p[0]||d[1]!=p[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:gn(d[0],p[0])},{i:n-2,x:gn(d[1],p[1])})):1==p[0]&&1==p[1]||i.push(i.pop()+"scale("+p+")"),n=r.length,function(t){for(var e,o=-1;++o<n;)i[(e=r[o]).i]=e.x(t);return i.join("")}}function vn(t,e){var n,i={},r={};for(n in t)n in e?i[n]=wn(n)(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function yn(t,e){var n,i,r,o,a,s=0,u=0,l=[],c=[];for(t+="",e+="",za.lastIndex=0,i=0;n=za.exec(e);++i)n.index&&l.push(e.substring(s,u=n.index)),c.push({i:l.length,x:n[0]}),l.push(null),s=za.lastIndex;for(s<e.length&&l.push(e.substring(s)),i=0,o=c.length;(n=za.exec(t))&&o>i;++i)if(a=c[i],a.x==n[0]){if(a.i)if(null==l[a.i+1])for(l[a.i-1]+=a.x,l.splice(a.i,1),r=i+1;o>r;++r)c[r].i--;else for(l[a.i-1]+=a.x+l[a.i+1],l.splice(a.i,2),r=i+1;o>r;++r)c[r].i-=2;else if(null==l[a.i+1])l[a.i]=a.x;else for(l[a.i]=a.x+l[a.i+1],l.splice(a.i+1,1),r=i+1;o>r;++r)c[r].i--;c.splice(i,1),o--,i--}else a.x=gn(parseFloat(n[0]),parseFloat(a.x));for(;o>i;)a=c.pop(),null==l[a.i+1]?l[a.i]=a.x:(l[a.i]=a.x+l[a.i+1],l.splice(a.i+1,1)),o--;return 1===l.length?null==l[0]?(a=c[0].x,function(t){return a(t)+""}):function(){return e}:function(t){for(i=0;o>i;++i)l[(a=c[i]).i]=a.x(t);return l.join("")}}function bn(t,e){for(var n,i=ao.interpolators.length;--i>=0&&!(n=ao.interpolators[i](t,e)););return n}function wn(t){return"transform"==t?mn:bn}function _n(t,e){var n,i=[],r=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;s>n;++n)i.push(bn(t[n],e[n]));for(;o>n;++n)r[n]=t[n];for(;a>n;++n)r[n]=e[n];return function(t){for(n=0;s>n;++n)r[n]=i[n](t);return r}}function xn(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function kn(t){return function(e){return 1-t(1-e)}}function Mn(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Sn(t){return t*t}function Tn(t){return t*t*t}function Cn(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Dn(t){return function(e){return Math.pow(e,t)}}function En(t){return 1-Math.cos(t*jo/2)}function Nn(t){return Math.pow(2,10*(t-1))}function $n(t){return 1-Math.sqrt(1-t*t)}function An(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/(2*jo)*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,10*-i)*Math.sin(2*(i-n)*jo/e)}}function jn(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Pn(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Rn(t,e){t=ao.hcl(t),e=ao.hcl(e);var n=t.h,i=t.c,r=t.l,o=e.h-n,a=e.c-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.c:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return U(n+o*t,i+a*t,r+s*t)+""}}function In(t,e){t=ao.hsl(t),e=ao.hsl(e);var n=t.h,i=t.s,r=t.l,o=e.h-n,a=e.s-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.s:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return L(n+o*t,i+a*t,r+s*t)+""}}function Hn(t,e){t=ao.lab(t),e=ao.lab(e);var n=t.l,i=t.a,r=t.b,o=e.l-n,a=e.a-i,s=e.b-r;return function(t){return Q(n+o*t,i+a*t,r+s*t)+""}}function Ln(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function zn(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function On(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function qn(t){for(var e=t.source,n=t.target,i=Yn(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function Fn(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Yn(t,e){if(t===e)return t;for(var n=Fn(t),i=Fn(e),r=n.pop(),o=i.pop(),a=null;r===o;)a=r,r=n.pop(),o=i.pop();return a}function Vn(t){t.fixed|=2}function Bn(t){t.fixed&=-7}function Wn(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Un(t){t.fixed&=-5}function Gn(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,u=-1;++u<s;)o=a[u],null!=o&&(Gn(o,e,n),t.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=e*n[t.point.index];t.charge+=t.pointCharge=l,i+=l*t.point.x,r+=l*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function Xn(t,e){return ao.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Kn,t}function Qn(t){return t.children}function Zn(t){return t.value}function Jn(t,e){return e.value-t.value}function Kn(t){return ao.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ti(t){return t.x}function ei(t){return t.y}function ni(t,e,n){t.y0=e,t.y=n}function ii(t){return ao.range(t.length)}function ri(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function oi(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;o>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function ai(t){return t.reduce(si,0)}function si(t,e){return t+e[1]}function ui(t,e){return li(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function li(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function ci(t){return[ao.min(t),ao.max(t)]}function fi(t,e){return t.parent==e.parent?1:2}function hi(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function di(t){var e,n=t.children;return n&&(e=n.length)?n[e-1]:t._tree.thread}function pi(t,e){var n=t.children;if(n&&(r=n.length))for(var i,r,o=-1;++o<r;)e(i=pi(n[o],e),t)>0&&(t=i);return t}function gi(t,e){return t.x-e.x}function mi(t,e){return e.x-t.x}function vi(t,e){return t.depth-e.depth}function yi(t,e){function n(t,i){var r=t.children;if(r&&(a=r.length))for(var o,a,s=null,u=-1;++u<a;)o=r[u],n(o,s),s=o;e(t,i)}n(t,null)}function bi(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)e=r[o]._tree,e.prelim+=n,e.mod+=n,n+=e.shift+(i+=e.change)}function wi(t,e,n){t=t._tree,e=e._tree;var i=n/(e.number-t.number);t.change+=i,e.change-=i,e.shift+=n,e.prelim+=n,e.mod+=n}function _i(t,e,n){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:n}function xi(t,e){return t.value-e.value}function ki(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Mi(t,e){t._pack_next=e,e._pack_prev=t}function Si(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return r*r-n*n-i*i>.001}function Ti(t){function e(t){c=Math.min(t.x-t.r,c),f=Math.max(t.x+t.r,f),h=Math.min(t.y-t.r,h),d=Math.max(t.y+t.r,d)}if((n=t.children)&&(l=n.length)){var n,i,r,o,a,s,u,l,c=1/0,f=-(1/0),h=1/0,d=-(1/0);if(n.forEach(Ci),i=n[0],i.x=-i.r,i.y=0,e(i),l>1&&(r=n[1],r.x=r.r,r.y=0,e(r),l>2))for(o=n[2],Ni(i,r,o),e(o),ki(i,o),i._pack_prev=o,ki(o,r),r=i._pack_next,a=3;l>a;a++){Ni(i,r,o=n[a]);var p=0,g=1,m=1;for(s=r._pack_next;s!==r;s=s._pack_next,g++)if(Si(s,o)){p=1;break}if(1==p)for(u=i._pack_prev;u!==s._pack_prev&&!Si(u,o);u=u._pack_prev,m++);p?(m>g||g==m&&r.r<i.r?Mi(i,r=s):Mi(i=u,r),a--):(ki(i,o),r=o,e(o))}var v=(c+f)/2,y=(h+d)/2,b=0;for(a=0;l>a;a++)o=n[a],o.x-=v,o.y-=y,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=b,n.forEach(Di)}}function Ci(t){t._pack_next=t._pack_prev=t}function Di(t){delete t._pack_next,delete t._pack_prev}function Ei(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var o=-1,a=r.length;++o<a;)Ei(r[o],e,n,i)}function Ni(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var a=e.r+n.r,s=r*r+o*o;a*=a,i*=i;var u=.5+(i-a)/(2*s),l=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);n.x=t.x+u*r+l*o,n.y=t.y+u*o-l*r}else n.x=t.x+i,n.y=t.y}function $i(t){return 1+ao.max(t,function(t){return t.y})}function Ai(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function ji(t){var e=t.children;return e&&e.length?ji(e[0]):t}function Pi(t){var e,n=t.children;return n&&(e=n.length)?Pi(n[e-1]):t}function Ri(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Ii(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>o&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Hi(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Li(t){return t.rangeExtent?t.rangeExtent():Hi(t.range())}function zi(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function Oi(t,e){var n,i=0,r=t.length-1,o=t[i],a=t[r];return o>a&&(n=i,i=r,r=n,n=o,o=a,a=n),(e=e(a-o))&&(t[i]=e.floor(o),t[r]=e.ceil(a)),t}function qi(t,e,n,i){var r=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)r.push(n(t[a-1],t[a])),o.push(i(e[a-1],e[a]));return function(e){var n=ao.bisect(t,e,1,s)-1;return o[n](r[n](e))}}function Fi(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?qi:zi,u=i?On:zn;return a=r(t,e,u,n),s=r(e,t,u,bn),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(Ln)},o.clamp=function(t){return arguments.length?(i=t,r()):i},o.interpolate=function(t){return arguments.length?(n=t,r()):n},o.ticks=function(e){return Wi(t,e)},o.tickFormat=function(e,n){return Ui(t,e,n)},o.nice=function(){return Oi(t,Vi),r()},o.copy=function(){return Fi(t,e,n,i)},r()}function Yi(t,e){return ao.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Vi(t){return t=Math.pow(10,Math.round(Math.log(t)/Math.LN10)-1),t&&{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}}function Bi(t,e){var n=Hi(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Wi(t,e){return ao.range.apply(ao,Bi(t,e))}function Ui(t,e,n){var i=-Math.floor(Math.log(Bi(t,e)[2])/Math.LN10+.01);return ao.format(n?n.replace(ta,function(t,e,n,r,o,a,s,u,l,c){return[e,n,r,o,a,s,u,l||"."+(i-2*("%"===c)),c].join("")}):",."+i+"f")}function Gi(t,e,n,i,r){function o(e){return t(n(e))}function a(){return n===Xi?{floor:s,ceil:u}:{floor:function(t){return-u(-t)},ceil:function(t){return-s(-t)}}}function s(t){return Math.pow(e,Math.floor(Math.log(t)/Math.log(e)))}function u(t){return Math.pow(e,Math.ceil(Math.log(t)/Math.log(e)))}return o.invert=function(e){return i(t.invert(e))},o.domain=function(e){return arguments.length?(e[0]<0?(n=Zi,i=Ji):(n=Xi,i=Qi),t.domain((r=e.map(Number)).map(n)),o):r},o.base=function(t){return arguments.length?(e=+t,o):e},o.nice=function(){return t.domain(Oi(r,a).map(n)),o},o.ticks=function(){var r=Hi(t.domain()),o=[];if(r.every(isFinite)){var a=Math.log(e),s=Math.floor(r[0]/a),u=Math.ceil(r[1]/a),l=i(r[0]),c=i(r[1]),f=e%1?2:e;if(n===Zi)for(o.push(-Math.pow(e,-s));s++<u;)for(var h=f-1;h>0;h--)o.push(-Math.pow(e,-s)*h);else{for(;u>s;s++)for(var h=1;f>h;h++)o.push(Math.pow(e,s)*h);o.push(Math.pow(e,s))}for(s=0;o[s]<l;s++);for(u=o.length;o[u-1]>c;u--);o=o.slice(s,u)}return o},o.tickFormat=function(t,r){if(arguments.length<2&&(r=Ga),!arguments.length)return r;var a,s=Math.log(e),u=Math.max(.1,t/o.ticks().length),l=n===Zi?(a=-1e-12,Math.floor):(a=1e-12,Math.ceil);return function(t){return t/i(s*l(n(t)/s+a))<=u?r(t):""}},o.copy=function(){return Gi(t.copy(),e,n,i,r)},Yi(o,t)}function Xi(t){return Math.log(0>t?0:t)}function Qi(t){return Math.exp(t)}function Zi(t){return-Math.log(t>0?0:-t)}function Ji(t){return-Math.exp(-t)}function Ki(t,e,n){function i(e){return t(r(e))}var r=tr(e),o=tr(1/e);return i.invert=function(e){return o(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return Wi(n,t)},i.tickFormat=function(t,e){return Ui(n,t,e)},i.nice=function(){return i.domain(Oi(n,Vi))},i.exponent=function(a){return arguments.length?(r=tr(e=a),o=tr(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return Ki(t.copy(),e,n)},Yi(i,t)}function tr(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function er(t,e){function n(e){return a[((o.get(e)||o.set(e,t.push(e)))-1)%a.length]}function i(e,n){return ao.range(t.length).map(function(t){return e+n*t})}var o,a,s;return n.domain=function(i){if(!arguments.length)return t;t=[],o=new r;for(var a,s=-1,u=i.length;++s<u;)o.has(a=i[s])||o.set(a,t.push(a));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(a=t,s=0,e={t:"range",a:arguments},n):a},n.rangePoints=function(r,o){arguments.length<2&&(o=0);var u=r[0],l=r[1],c=(l-u)/(Math.max(1,t.length-1)+o);return a=i(t.length<2?(u+l)/2:u+c*o/2,c),s=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,o,u){arguments.length<2&&(o=0),arguments.length<3&&(u=o);var l=r[1]<r[0],c=r[l-0],f=r[1-l],h=(f-c)/(t.length-o+2*u);return a=i(c+h*u,h),l&&a.reverse(),s=h*(1-o),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,o,u){arguments.length<2&&(o=0),arguments.length<3&&(u=o);var l=r[1]<r[0],c=r[l-0],f=r[1-l],h=Math.floor((f-c)/(t.length-o+2*u)),d=f-c-(t.length-o)*h;return a=i(c+Math.round(d/2),h),l&&a.reverse(),s=Math.round(h*(1-o)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return s},n.rangeExtent=function(){return Hi(e.a[0])},n.copy=function(){return er(t,e)},n.domain(t)}function nr(t,e){function n(){var n=0,o=e.length;for(r=[];++n<o;)r[n-1]=ao.quantile(t,n/o);return i}function i(t){return isNaN(t=+t)?0/0:e[ao.bisect(r,t)]}var r;return i.domain=function(e){return arguments.length?(t=e.filter(function(t){return!isNaN(t)}).sort(ao.ascending),n()):t},i.range=function(t){return arguments.length?(e=t,n()):e},i.quantiles=function(){return r},i.copy=function(){return nr(t,e)},n()}function ir(t,e,n){function i(e){return n[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function r(){return o=n.length/(e-t),a=n.length-1,i}var o,a;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.copy=function(){return ir(t,e,n)},r()}function rr(t,e){function n(n){return e[ao.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return rr(t,e)},n}function or(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Wi(t,e)},e.tickFormat=function(e,n){return Ui(t,e,n)},e.copy=function(){return or(t)},e}function ar(t){return t.innerRadius}function sr(t){return t.outerRadius}function ur(t){return t.startAngle}function lr(t){return t.endAngle}function cr(t){for(var e,n,i,r=-1,o=t.length;++r<o;)e=t[r],n=e[0],i=e[1]+Ka,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function fr(t){function e(e){function u(){g.push("M",s(t(v),f),c,l(t(m.reverse()),f),"Z")}for(var h,d,p,g=[],m=[],v=[],y=-1,b=e.length,w=lt(n),_=lt(r),x=n===i?function(){return d}:lt(i),k=r===o?function(){return p}:lt(o);++y<b;)a.call(this,h=e[y],y)?(m.push([d=+w.call(this,h,y),p=+_.call(this,h,y)]),v.push([+x.call(this,h,y),+k.call(this,h,y)])):m.length&&(u(),m=[],v=[]);return m.length&&u(),g.length?g.join(""):null}var n=Pe,i=Pe,r=0,o=Re,a=Ht,s=Ie,u=s.key,l=s,c="L",f=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=o=t,e):o},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(u="function"==typeof t?s=t:(s=ja.get(t)||Ie).key,l=s.reverse||s,c=s.closed?"M":"L",e):u},e.tension=function(t){return arguments.length?(f=t,e):f},e}function hr(t){return t.radius}function dr(t){return[t.x,t.y]}function pr(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]+Ka;return[n*Math.cos(i),n*Math.sin(i)]}}function gr(){return 64}function mr(){return"circle"}function vr(t){var e=Math.sqrt(t/jo);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function yr(t,e){return vo(t,os),t.id=e,t}function br(t,e,n,i){var r=t.id;return j(t,"function"==typeof n?function(t,o,a){t.__transition__[r].tween.set(e,i(n.call(t,t.__data__,o,a)))}:(n=i(n),function(t){t.__transition__[r].tween.set(e,n)}))}function wr(t){return null==t&&(t=""),function(){this.textContent=t}}function _r(t,e,n,i){var o=t.__transition__||(t.__transition__={active:0,count:0}),a=o[n];if(!a){var s=i.time;return a=o[n]={tween:new r,event:ao.dispatch("start","end"),time:s,ease:i.ease,delay:i.delay,duration:i.duration},++o.count,ao.timer(function(i){function r(i){return o.active>n?l():(o.active=n,h.start.call(t,c,e),a.tween.forEach(function(n,i){(i=i.call(t,c,e))&&g.push(i)}),u(i)||ao.timer(u,0,s),1)}function u(i){if(o.active!==n)return l();for(var r=(i-d)/p,a=f(r),s=g.length;s>0;)g[--s].call(t,a);return r>=1?(l(),h.end.call(t,c,e),1):void 0}function l(){return--o.count?delete o[n]:delete t.__transition__,1}var c=t.__data__,f=a.ease,h=a.event,d=a.delay,p=a.duration,g=[];return i>=d?r(i):ao.timer(r,d,s),1},0,s),a}}function xr(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function kr(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function Mr(t,e,n){if(i=[],n&&e.length>1){for(var i,r,o,a=Hi(t.domain()),s=-1,u=e.length,l=(e[1]-e[0])/++n;++s<u;)for(r=n;--r>0;)(o=+e[s]-r*l)>=a[0]&&i.push(o);for(--s,r=0;++r<n&&(o=+e[s]+r*l)<a[1];)i.push(o)}return i}function Sr(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Tr(t,e,n){function i(e){var n=t(e),i=o(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new hs(n-1)),1),n}function o(t,n){return e(t=new hs(+t),n),t}function a(t,i,o){var a=r(t),s=[];if(o>1)for(;i>a;)n(a)%o||s.push(new Date(+a)),e(a,1);else for(;i>a;)s.push(new Date(+a)),e(a,1);return s}function s(t,e,n){try{hs=Sr;var i=new Sr;return i._=t,a(i,e,n)}finally{hs=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=a;var u=t.utc=Cr(t);return u.floor=u,u.round=Cr(i),u.ceil=Cr(r),u.offset=Cr(o),u.range=s,t}function Cr(t){return function(e,n){try{hs=Sr;var i=new Sr;return i._=e,t(i,n)._}finally{hs=Date}}}function Dr(t,e,n,i){for(var r,o,a=0,s=e.length,u=n.length;s>a;){if(i>=u)return-1;if(r=e.charCodeAt(a++),37===r){if(o=Ns[e.charAt(a++)],!o||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function Er(t){return new RegExp("^(?:"+t.map(ao.requote).join("|")+")","i")}function Nr(t){for(var e=new r,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function $r(t,e,n){t+="";var i=t.length;return n>i?new Array(n-i+1).join(e)+t:t}function Ar(t,e,n){ks.lastIndex=0;var i=ks.exec(e.substring(n));return i?n+=i[0].length:-1}function jr(t,e,n){xs.lastIndex=0;var i=xs.exec(e.substring(n));return i?n+=i[0].length:-1}function Pr(t,e,n){Ts.lastIndex=0;var i=Ts.exec(e.substring(n));return i?(t.m=Cs.get(i[0].toLowerCase()),n+=i[0].length):-1}function Rr(t,e,n){Ms.lastIndex=0;var i=Ms.exec(e.substring(n));return i?(t.m=Ss.get(i[0].toLowerCase()),n+=i[0].length):-1}function Ir(t,e,n){return Dr(t,Es.c.toString(),e,n)}function Hr(t,e,n){return Dr(t,Es.x.toString(),e,n)}function Lr(t,e,n){return Dr(t,Es.X.toString(),e,n)}function zr(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+4));return i?(t.y=+i[0],n+=i[0].length):-1}function Or(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.y=qr(+i[0]),n+=i[0].length):-1}function qr(t){return t+(t>68?1900:2e3)}function Fr(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.m=i[0]-1,n+=i[0].length):-1}function Yr(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.d=+i[0],n+=i[0].length):-1}function Vr(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.H=+i[0],n+=i[0].length):-1}function Br(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.M=+i[0],n+=i[0].length):-1}function Wr(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+2));return i?(t.S=+i[0],n+=i[0].length):-1}function Ur(t,e,n){$s.lastIndex=0;var i=$s.exec(e.substring(n,n+3));return i?(t.L=+i[0],n+=i[0].length):-1}function Gr(t,e,n){var i=As.get(e.substring(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}function Xr(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=~~(Math.abs(e)/60),r=Math.abs(e)%60;return n+$r(i,"0",2)+$r(r,"0",2)}function Qr(t){return t.toISOString()}function Zr(t,e,n){function i(e){return t(e)}return i.invert=function(e){return Jr(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Jr)},i.nice=function(t){return i.domain(Oi(i.domain(),function(){return t}))},i.ticks=function(n,r){var o=Hi(i.domain());if("function"!=typeof n){var a=o[1]-o[0],s=a/n,u=ao.bisect(Ps,s);if(u==Ps.length)return e.year(o,n);if(!u)return t.ticks(n).map(Jr);Math.log(s/Ps[u-1])<Math.log(Ps[u]/s)&&--u,n=e[u],r=n[1],n=n[0].range}return n(o[0],new Date(+o[1]+1),r)},i.tickFormat=function(){return n},i.copy=function(){return Zr(t.copy(),e,n)},Yi(i,t)}function Jr(t){return new Date(t)}function Kr(t){return function(e){for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}function to(t){var e=new Date(t,0,1);return e.setFullYear(t),e}function eo(t){var e=t.getFullYear(),n=to(e),i=to(e+1);return e+(t-n)/(i-n)}function no(t){var e=new Date(Date.UTC(t,0,1));return e.setUTCFullYear(t),e}function io(t){var e=t.getUTCFullYear(),n=no(e),i=no(e+1);return e+(t-n)/(i-n)}function ro(t){return JSON.parse(t.responseText)}function oo(t){var e=so.createRange();return e.selectNode(so.body),e.createContextualFragment(t.responseText)}var ao={version:"3.1.10"};Date.now||(Date.now=function(){return+new Date});var so=document,uo=window;try{so.createElement("div").style.setProperty("opacity",0,"")}catch(t){var lo=uo.CSSStyleDeclaration.prototype,co=lo.setProperty;lo.setProperty=function(t,e,n){co.call(this,t,e+"",n)}}ao.ascending=function(t,e){return e>t?-1:t>e?1:t>=e?0:0/0},ao.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},ao.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&(null==(n=t[r])||n!=n);)n=void 0;for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o&&(null==(n=e.call(t,t[r],r))||n!=n);)n=void 0;for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},ao.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&(null==(n=t[r])||n!=n);)n=void 0;for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o&&(null==(n=e.call(t,t[r],r))||n!=n);)n=void 0;for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},ao.extent=function(t,e){var n,i,r,o=-1,a=t.length;if(1===arguments.length){for(;++o<a&&(null==(n=r=t[o])||n!=n);)n=r=void 0;for(;++o<a;)null!=(i=t[o])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;++o<a&&(null==(n=r=e.call(t,t[o],o))||n!=n);)n=void 0;for(;++o<a;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},ao.sum=function(t,e){var n,i=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)isNaN(n=+t[o])||(i+=n);else for(;++o<r;)isNaN(n=+e.call(t,t[o],o))||(i+=n);return i},ao.mean=function(e,n){var i,r=e.length,o=0,a=-1,s=0;if(1===arguments.length)for(;++a<r;)t(i=e[a])&&(o+=(i-o)/++s);else for(;++a<r;)t(i=n.call(e,e[a],a))&&(o+=(i-o)/++s);return s?o:void 0},ao.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},ao.median=function(e,n){return arguments.length>1&&(e=e.map(n)),e=e.filter(t),e.length?ao.quantile(e.sort(ao.ascending),.5):void 0},ao.bisector=function(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;t.call(e,e[o],o)<n?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),
arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;n<t.call(e,e[o],o)?r=o:i=o+1}return i}}};var fo=ao.bisector(function(t){return t});ao.bisectLeft=fo.left,ao.bisect=ao.bisectRight=fo.right,ao.shuffle=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t},ao.permute=function(t,e){for(var n=[],i=-1,r=e.length;++i<r;)n[i]=t[e[i]];return n},ao.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,n=ao.min(arguments,e),i=new Array(n);++t<n;)for(var r,o=-1,a=i[t]=new Array(r);++o<r;)a[o]=arguments[o][t];return i},ao.transpose=function(t){return ao.zip.apply(ao,t)},ao.keys=function(t){var e=[];for(var n in t)e.push(n);return e},ao.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},ao.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},ao.merge=function(t){return Array.prototype.concat.apply([],t)},ao.range=function(t,e,i){if(arguments.length<3&&(i=1,arguments.length<2&&(e=t,t=0)),(e-t)/i===1/0)throw new Error("infinite range");var r,o=[],a=n(Math.abs(i)),s=-1;if(t*=a,e*=a,i*=a,0>i)for(;(r=t+i*++s)>e;)o.push(r/a);else for(;(r=t+i*++s)<e;)o.push(r/a);return o},ao.map=function(t){var e=new r;for(var n in t)e.set(n,t[n]);return e},i(r,{has:function(t){return ho+t in this},get:function(t){return this[ho+t]},set:function(t,e){return this[ho+t]=e},remove:function(t){return t=ho+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===po&&t.call(this,e.substring(1),this[e])}});var ho="\x00",po=ho.charCodeAt(0);ao.nest=function(){function t(e,s,u){if(u>=a.length)return i?i.call(o,s):n?s.sort(n):s;for(var l,c,f,h,d=-1,p=s.length,g=a[u++],m=new r;++d<p;)(h=m.get(l=g(c=s[d])))?h.push(c):m.set(l,[c]);return e?(c=e(),f=function(n,i){c.set(n,t(e,i,u))}):(c={},f=function(n,i){c[n]=t(e,i,u)}),m.forEach(f),c}function e(t,n){if(n>=a.length)return t;var i=[],r=s[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,o={},a=[],s=[];return o.map=function(e,n){return t(n,e,0)},o.entries=function(n){return e(t(ao.map,n,0),0)},o.key=function(t){return a.push(t),o},o.sortKeys=function(t){return s[a.length-1]=t,o},o.sortValues=function(t){return n=t,o},o.rollup=function(t){return i=t,o},o},ao.set=function(t){var e=new o;if(t)for(var n=0;n<t.length;n++)e.add(t[n]);return e},i(o,{has:function(t){return ho+t in this},add:function(t){return this[ho+t]=!0,t},remove:function(t){return t=ho+t,t in this&&delete this[t]},values:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===po&&t.call(this,e.substring(1))}}),ao.behavior={},ao.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=a(t,e,e[n]);return t},ao.dispatch=function(){for(var t=new s,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=u(t);return t},s.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.substring(n+1),t=t.substring(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},ao.event=null,ao.mouse=function(t){return d(t,c())};var go=/WebKit/.test(uo.navigator.userAgent)?-1:0,mo=g;try{mo(so.documentElement.childNodes)[0].nodeType}catch(t){mo=p}var vo=[].__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};ao.touches=function(t,e){return arguments.length<2&&(e=c().touches),e?mo(e).map(function(e){var n=d(t,e);return n.identifier=e.identifier,n}):[]},ao.behavior.drag=function(){function t(){this.on("mousedown.drag",e).on("touchstart.drag",e)}function e(){function t(){var t=a.parentNode;return null!=c?ao.touches(t).filter(function(t){return t.identifier===c})[0]:ao.mouse(t)}function e(){if(!a.parentNode)return r();var e=t(),n=e[0]-h[0],i=e[1]-h[1];d|=n|i,h=e,l(),s({type:"drag",x:e[0]+o[0],y:e[1]+o[1],dx:n,dy:i})}function r(){s({type:"dragend"}),d&&(l(),ao.event.target===u&&f(p,"click")),p.on(null!=c?"touchmove.drag-"+c:"mousemove.drag",null).on(null!=c?"touchend.drag-"+c:"mouseup.drag",null)}var o,a=this,s=n.of(a,arguments),u=ao.event.target,c=ao.event.touches?ao.event.changedTouches[0].identifier:null,h=t(),d=0,p=ao.select(uo).on(null!=c?"touchmove.drag-"+c:"mousemove.drag",e).on(null!=c?"touchend.drag-"+c:"mouseup.drag",r,!0);i?(o=i.apply(a,arguments),o=[o.x-h[0],o.y-h[1]]):o=[0,0],null==c&&l(),s({type:"dragstart"})}var n=h(t,"drag","dragstart","dragend"),i=null;return t.origin=function(e){return arguments.length?(i=e,t):i},ao.rebind(t,n,"on")};var yo=function(t,e){return e.querySelector(t)},bo=function(t,e){return e.querySelectorAll(t)},wo=so.documentElement,_o=wo.matchesSelector||wo.webkitMatchesSelector||wo.mozMatchesSelector||wo.msMatchesSelector||wo.oMatchesSelector,xo=function(t,e){return _o.call(t,e)};"function"==typeof Sizzle&&(yo=function(t,e){return Sizzle(t,e)[0]||null},bo=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},xo=Sizzle.matchesSelector),ao.selection=function(){return Do};var ko=ao.selection.prototype=[];ko.select=function(t){var e,n,i,r,o=[];"function"!=typeof t&&(t=v(t));for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var u=-1,l=i.length;++u<l;)(r=i[u])?(e.push(n=t.call(r,r.__data__,u)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return m(o)},ko.selectAll=function(t){var e,n,i=[];"function"!=typeof t&&(t=y(t));for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,u=a.length;++s<u;)(n=a[s])&&(i.push(e=mo(t.call(n,n.__data__,s))),e.parentNode=n);return m(i)};var Mo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ao.ns={prefix:Mo,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),Mo.hasOwnProperty(n)?{space:Mo[n],local:t}:t}},ko.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=ao.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(b(e,t[e]));return this}return this.each(b(t,e))},ao.requote=function(t){return t.replace(So,"\\$&")};var So=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;ko.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=t.trim().split(/^|\s+/g)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!_(t[r]).test(e))return!1;return!0}for(e in t)this.each(x(e,t[e]));return this}return this.each(x(t,e))},ko.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.each(M(n,t[n],e));return this}if(2>i)return uo.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(M(t,e,n))},ko.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(S(e,t[e]));return this}return this.each(S(t,e))},ko.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ko.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ko.append=function(t){function e(){return this.appendChild(so.createElementNS(this.namespaceURI,t))}function n(){return this.appendChild(so.createElementNS(t.space,t.local))}return t=ao.ns.qualify(t),this.select(t.local?n:e)},ko.insert=function(t,e){function n(n,i){return this.insertBefore(so.createElementNS(this.namespaceURI,t),e.call(this,n,i))}function i(n,i){return this.insertBefore(so.createElementNS(t.space,t.local),e.call(this,n,i))}return t=ao.ns.qualify(t),"function"!=typeof e&&(e=v(e)),this.select(t.local?i:n)},ko.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ko.data=function(t,e){function n(t,n){var i,o,a,s=t.length,f=n.length,h=Math.min(s,f),d=new Array(f),p=new Array(f),g=new Array(s);if(e){var m,v=new r,y=new r,b=[];for(i=-1;++i<s;)m=e.call(o=t[i],o.__data__,i),v.has(m)?g[i]=o:v.set(m,o),b.push(m);for(i=-1;++i<f;)m=e.call(n,a=n[i],i),(o=v.get(m))?(d[i]=o,o.__data__=a):y.has(m)||(p[i]=T(a)),y.set(m,a),v.remove(m);for(i=-1;++i<s;)v.has(b[i])&&(g[i]=t[i])}else{for(i=-1;++i<h;)o=t[i],a=n[i],o?(o.__data__=a,d[i]=o):p[i]=T(a);for(;f>i;++i)p[i]=T(n[i]);for(;s>i;++i)g[i]=t[i]}p.update=d,p.parentNode=d.parentNode=g.parentNode=t.parentNode,u.push(p),l.push(d),c.push(g)}var i,o,a=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(i=this[0]).length);++a<s;)(o=i[a])&&(t[a]=o.__data__);return t}var u=P([]),l=m([]),c=m([]);if("function"==typeof t)for(;++a<s;)n(i=this[a],t.call(i,i.parentNode.__data__,a));else for(;++a<s;)n(i=this[a],t);return l.enter=function(){return u},l.exit=function(){return c},l},ko.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ko.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=C(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,u=n.length;u>s;s++)(i=n[s])&&t.call(i,i.__data__,s)&&e.push(i)}return m(r)},ko.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},ko.sort=function(t){t=D.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},ko.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(N(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(N(t,e,n))};var To=ao.map({mouseenter:"mouseover",mouseleave:"mouseout"});To.forEach(function(t){"on"+t in so&&To.remove(t)}),ko.each=function(t){return j(this,function(e,n,i){t.call(e,e.__data__,n,i)})},ko.call=function(t){var e=mo(arguments);return t.apply(e[0]=this,e),this},ko.empty=function(){return!this.node()},ko.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var o=n[i];if(o)return o}return null};var Co=[];ao.selection.enter=P,ao.selection.enter.prototype=Co,Co.append=ko.append,Co.insert=ko.insert,Co.empty=ko.empty,Co.node=ko.node,Co.select=function(t){for(var e,n,i,r,o,a=[],s=-1,u=this.length;++s<u;){i=(r=this[s]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var l=-1,c=r.length;++l<c;)(o=r[l])?(e.push(i[l]=n=t.call(r.parentNode,o.__data__,l)),n.__data__=o.__data__):e.push(null)}return m(a)},ko.transition=function(){var t,e,n=ns||++as,i=[],r=Object.create(ss);r.time=Date.now();for(var o=-1,a=this.length;++o<a;){i.push(t=[]);for(var s=this[o],u=-1,l=s.length;++u<l;)(e=s[u])&&_r(e,u,n,r),t.push(e)}return yr(i,n)},ao.select=function(t){var e=["string"==typeof t?yo(t,so):t];return e.parentNode=wo,m([e])},ao.selectAll=function(t){var e=mo("string"==typeof t?bo(t,so):t);return e.parentNode=wo,m([e])};var Do=ao.select(wo);ao.behavior.zoom=function(){function t(){this.on("mousedown.zoom",s).on("mousemove.zoom",c).on($o+".zoom",u).on("dblclick.zoom",d).on("touchstart.zoom",p).on("touchmove.zoom",g).on("touchend.zoom",p)}function e(t){return[(t[0]-k[0])/M,(t[1]-k[1])/M]}function n(t){return[t[0]*M+k[0],t[1]*M+k[1]]}function i(t){M=Math.max(S[0],Math.min(S[1],t))}function r(t,e){e=n(e),k[0]+=t[0]-e[0],k[1]+=t[1]-e[1]}function o(){b&&b.domain(y.range().map(function(t){return(t-k[0])/M}).map(y.invert)),_&&_.domain(w.range().map(function(t){return(t-k[1])/M}).map(w.invert))}function a(t){o(),ao.event.preventDefault(),t({type:"zoom",scale:M,translate:k})}function s(){function t(){u=1,r(ao.mouse(i),h),a(o)}function n(){u&&l(),c.on("mousemove.zoom",null).on("mouseup.zoom",null),u&&ao.event.target===s&&f(c,"click.zoom")}var i=this,o=T.of(i,arguments),s=ao.event.target,u=0,c=ao.select(uo).on("mousemove.zoom",t).on("mouseup.zoom",n),h=e(ao.mouse(i));uo.focus(),l()}function u(){m||(m=e(ao.mouse(this))),i(Math.pow(2,.002*Eo())*M),r(ao.mouse(this),m),a(T.of(this,arguments))}function c(){m=null}function d(){var t=ao.mouse(this),n=e(t),o=Math.log(M)/Math.LN2;i(Math.pow(2,ao.event.shiftKey?Math.ceil(o)-1:Math.floor(o)+1)),r(t,n),a(T.of(this,arguments))}function p(){var t=ao.touches(this),n=Date.now();if(v=M,m={},t.forEach(function(t){m[t.identifier]=e(t)}),l(),1===t.length){if(500>n-x){var o=t[0],s=e(t[0]);i(2*M),r(o,s),a(T.of(this,arguments))}x=n}}function g(){var t=ao.touches(this),e=t[0],n=m[e.identifier];if(o=t[1]){var o,s=m[o.identifier];e=[(e[0]+o[0])/2,(e[1]+o[1])/2],n=[(n[0]+s[0])/2,(n[1]+s[1])/2],i(ao.event.scale*v)}r(e,n),x=null,a(T.of(this,arguments))}var m,v,y,b,w,_,x,k=[0,0],M=1,S=No,T=h(t,"zoom");return t.translate=function(e){return arguments.length?(k=e.map(Number),o(),t):k},t.scale=function(e){return arguments.length?(M=+e,o(),t):M},t.scaleExtent=function(e){return arguments.length?(S=null==e?No:e.map(Number),t):S},t.x=function(e){return arguments.length?(b=e,y=e.copy(),k=[0,0],M=1,t):b},t.y=function(e){return arguments.length?(_=e,w=e.copy(),k=[0,0],M=1,t):_},ao.rebind(t,T,"on")};var Eo,No=[0,1/0],$o="onwheel"in so?(Eo=function(){return-ao.event.deltaY*(ao.event.deltaMode?120:1)},"wheel"):"onmousewheel"in so?(Eo=function(){return ao.event.wheelDelta},"mousewheel"):(Eo=function(){return-ao.event.detail},"MozMousePixelScroll");R.prototype.toString=function(){return this.rgb()+""},ao.hsl=function(t,e,n){return 1===arguments.length?t instanceof H?I(t.h,t.s,t.l):rt(""+t,ot,I):I(+t,+e,+n)};var Ao=H.prototype=new R;Ao.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),I(this.h,this.s,this.l/t)},Ao.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),I(this.h,this.s,t*this.l)},Ao.rgb=function(){return L(this.h,this.s,this.l)};var jo=Math.PI,Po=1e-6,Ro=jo/180,Io=180/jo;ao.hcl=function(t,e,n){return 1===arguments.length?t instanceof W?B(t.h,t.c,t.l):t instanceof X?Z(t.l,t.a,t.b):Z((t=at((t=ao.rgb(t)).r,t.g,t.b)).l,t.a,t.b):B(+t,+e,+n)};var Ho=W.prototype=new R;Ho.brighter=function(t){return B(this.h,this.c,Math.min(100,this.l+Lo*(arguments.length?t:1)))},Ho.darker=function(t){return B(this.h,this.c,Math.max(0,this.l-Lo*(arguments.length?t:1)))},Ho.rgb=function(){return U(this.h,this.c,this.l).rgb()},ao.lab=function(t,e,n){return 1===arguments.length?t instanceof X?G(t.l,t.a,t.b):t instanceof W?U(t.l,t.c,t.h):at((t=ao.rgb(t)).r,t.g,t.b):G(+t,+e,+n)};var Lo=18,zo=.95047,Oo=1,qo=1.08883,Fo=X.prototype=new R;Fo.brighter=function(t){return G(Math.min(100,this.l+Lo*(arguments.length?t:1)),this.a,this.b)},Fo.darker=function(t){return G(Math.max(0,this.l-Lo*(arguments.length?t:1)),this.a,this.b)},Fo.rgb=function(){return Q(this.l,this.a,this.b)},ao.rgb=function(t,e,n){return 1===arguments.length?t instanceof nt?et(t.r,t.g,t.b):rt(""+t,et,L):et(~~t,~~e,~~n)};var Yo=nt.prototype=new R;Yo.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),et(Math.min(255,Math.floor(e/t)),Math.min(255,Math.floor(n/t)),Math.min(255,Math.floor(i/t)))):et(r,r,r)},Yo.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),et(Math.floor(t*this.r),Math.floor(t*this.g),Math.floor(t*this.b))},Yo.hsl=function(){return ot(this.r,this.g,this.b)},Yo.toString=function(){return"#"+it(this.r)+it(this.g)+it(this.b)};var Vo=ao.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});Vo.forEach(function(t,e){Vo.set(t,rt(e,et,L))}),ao.functor=lt,ao.xhr=ft(ct),ao.csv=pt(",","text/csv"),ao.tsv=pt("	","text/tab-separated-values");var Bo,Wo,Uo,Go;ao.timer=function(t,e,n){if(arguments.length<3){if(arguments.length<2)e=0;else if(!isFinite(e))return;n=Date.now()}var i=n+e,r={callback:t,time:i,next:null};Wo?Wo.next=r:Bo=r,Wo=r,Uo||(Go=clearTimeout(Go),Uo=1,Xo(gt))},ao.timer.flush=function(){mt(),vt()};var Xo=uo.requestAnimationFrame||uo.webkitRequestAnimationFrame||uo.mozRequestAnimationFrame||uo.oRequestAnimationFrame||uo.msRequestAnimationFrame||function(t){setTimeout(t,17)},Qo=".",Zo=",",Jo=[3,3],Ko=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(yt);ao.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=ao.round(t,bt(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((0>=n?n+1:n-1)/3)))),Ko[8+n/3]},ao.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},ao.format=function(t){var e=ta.exec(t),n=e[1]||" ",i=e[2]||">",r=e[3]||"",o=e[4]||"",a=e[5],s=+e[6],u=e[7],l=e[8],c=e[9],f=1,h="",d=!1;switch(l&&(l=+l.substring(1)),(a||"0"===n&&"="===i)&&(a=n="0",i="=",u&&(s-=Math.floor((s-1)/4))),c){case"n":u=!0,c="g";break;case"%":f=100,h="%",c="f";break;case"p":f=100,h="%",c="r";break;case"b":case"o":case"x":case"X":o&&(o="0"+c.toLowerCase());case"c":case"d":d=!0,l=0;break;case"s":f=-1,c="r"}"#"===o&&(o=""),"r"!=c||l||(c="g"),null!=l&&("g"==c?l=Math.max(1,Math.min(21,l)):"e"!=c&&"f"!=c||(l=Math.max(0,Math.min(20,l)))),c=ea.get(c)||wt;var p=a&&u;return function(t){if(d&&t%1)return"";var e=0>t||0===t&&0>1/t?(t=-t,"-"):r;if(0>f){var g=ao.formatPrefix(t,l);t=g.scale(t),h=g.symbol}else t*=f;t=c(t,l),!a&&u&&(t=na(t));var m=o.length+t.length+(p?0:e.length),v=s>m?new Array(m=s-m+1).join(n):"";return p&&(t=na(v+t)),Qo&&t.replace(".",Qo),e+=o,("<"===i?e+t+v:">"===i?v+e+t:"^"===i?v.substring(0,m>>=1)+e+t+v.substring(m):e+(p?t:v+t))+h}};var ta=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ea=ao.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=ao.round(t,bt(t,e))).toFixed(Math.max(0,Math.min(20,bt(t*(1+1e-15),e))))}}),na=ct;if(Jo){var ia=Jo.length;na=function(t){for(var e=t.lastIndexOf("."),n=e>=0?"."+t.substring(e+1):(e=t.length,""),i=[],r=0,o=Jo[0];e>0&&o>0;)i.push(t.substring(e-=o,e+o)),o=Jo[r=(r+1)%ia];return i.reverse().join(Zo||"")+n}}ao.geo={},ao.geo.stream=function(t,e){t&&ra.hasOwnProperty(t.type)?ra[t.type](t,e):_t(t,e)};var ra={Feature:function(t,e){_t(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)_t(n[i].geometry,e)}},oa={Sphere:function(t,e){e.sphere()},Point:function(t,e){var n=t.coordinates;e.point(n[0],n[1])},MultiPoint:function(t,e){for(var n,i=t.coordinates,r=-1,o=i.length;++r<o;)n=i[r],e.point(n[0],n[1])},LineString:function(t,e){xt(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)xt(n[i],e,0)},Polygon:function(t,e){kt(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)kt(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)_t(n[i],e)}};ao.geo.area=function(t){return aa=0,ao.geo.stream(t,ua),aa};var aa,sa,ua={sphere:function(){aa+=4*jo},point:E,lineStart:E,lineEnd:E,polygonStart:function(){sa=0,ua.lineStart=Mt},polygonEnd:function(){var t=2*sa;aa+=0>t?4*jo+t:t,ua.lineStart=ua.lineEnd=ua.point=E}};ao.geo.bounds=function(){function t(t,e){b.push(w=[c=t,h=t]),f>e&&(f=e),e>d&&(d=e)}function e(e,n){var i=St([e*Ro,n*Ro]);if(v){var r=Ct(v,i),o=[r[1],-r[0],0],a=Ct(o,r);Nt(a),a=$t(a);var u=e-p,l=u>0?1:-1,g=a[0]*Io*l,m=Math.abs(u)>180;if(m^(g>l*p&&l*e>g)){var y=a[1]*Io;y>d&&(d=y)}else if(g=(g+360)%360-180,m^(g>l*p&&l*e>g)){var y=-a[1]*Io;f>y&&(f=y)}else f>n&&(f=n),n>d&&(d=n);m?p>e?s(c,e)>s(c,h)&&(h=e):s(e,h)>s(c,h)&&(c=e):h>=c?(c>e&&(c=e),e>h&&(h=e)):e>p?s(c,e)>s(c,h)&&(h=e):s(e,h)>s(c,h)&&(c=e)}else t(e,n);v=i,p=e}function n(){_.point=e}function i(){w[0]=c,w[1]=h,_.point=t,v=null}function r(t,n){if(v){var i=t-p;y+=Math.abs(i)>180?i+(i>0?360:-360):i}else g=t,m=n;ua.point(t,n),e(t,n)}function o(){ua.lineStart()}function a(){r(g,m),ua.lineEnd(),Math.abs(y)>Po&&(c=-(h=180)),w[0]=c,w[1]=h,v=null}function s(t,e){return(e-=t)<0?e+360:e}function u(t,e){return t[0]-e[0]}function l(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,f,h,d,p,g,m,v,y,b,w,_={point:t,lineStart:n,lineEnd:i,polygonStart:function(){_.point=r,_.lineStart=o,_.lineEnd=a,y=0,ua.polygonStart()},polygonEnd:function(){ua.polygonEnd(),_.point=t,_.lineStart=n,_.lineEnd=i,0>sa?(c=-(h=180),f=-(d=90)):y>Po?d=90:-Po>y&&(f=-90),w[0]=c,w[1]=h}};return function(t){d=h=-(c=f=1/0),b=[],ao.geo.stream(t,_),b.sort(u);for(var e,n=1,i=b.length,r=b[0],o=[r];i>n;++n)e=b[n],l(e[0],r)||l(e[1],r)?(s(r[0],e[1])>s(r[0],r[1])&&(r[1]=e[1]),s(e[0],r[1])>s(r[0],r[1])&&(r[0]=e[0])):o.push(r=e);for(var a,e,p=-(1/0),i=o.length-1,n=0,r=o[i];i>=n;r=e,++n)e=o[n],(a=s(r[1],e[0]))>p&&(p=a,c=e[0],h=r[1]);return b=w=null,[[c,f],[h,d]]}}(),ao.geo.centroid=function(t){la=ca=fa=ha=da=0,ao.geo.stream(t,pa);var e;return ca&&Math.abs(e=Math.sqrt(fa*fa+ha*ha+da*da))>Po?[Math.atan2(ha,fa)*Io,Math.asin(Math.max(-1,Math.min(1,da/e)))*Io]:void 0};var la,ca,fa,ha,da,pa={sphere:function(){2>la&&(la=2,ca=fa=ha=da=0)},point:jt,lineStart:Rt,lineEnd:It,polygonStart:function(){2>la&&(la=2,ca=fa=ha=da=0),pa.lineStart=Pt},polygonEnd:function(){pa.lineStart=Rt}},ga=Ot(Ht,Bt,Ut),ma=1e9;ao.geo.projection=Kt,ao.geo.projectionMutator=te,(ao.geo.equirectangular=function(){return Kt(ne)}).raw=ne.invert=ne,ao.geo.rotation=function(t){function e(e){return e=t(e[0]*Ro,e[1]*Ro),e[0]*=Io,e[1]*=Io,e}return t=ie(t[0]%360*Ro,t[1]*Ro,t.length>2?t[2]*Ro:0),e.invert=function(e){return e=t.invert(e[0]*Ro,e[1]*Ro),e[0]*=Io,e[1]*=Io,e},e},ao.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=ie(-t[0]*Ro,-t[1]*Ro,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Io,t[1]*=Io}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=se((e=+i)*Ro,r*Ro),t):e},t.precision=function(i){return arguments.length?(n=se(e*Ro,(r=+i)*Ro),t):r},t.angle(90)},ao.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Ro,r=t[1]*Ro,o=e[1]*Ro,a=Math.sin(i),s=Math.cos(i),u=Math.sin(r),l=Math.cos(r),c=Math.sin(o),f=Math.cos(o);return Math.atan2(Math.sqrt((n=f*a)*n+(n=l*c-u*f*s)*n),u*c+l*f*s)},ao.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return ao.range(Math.ceil(o/m)*m,r,m).map(h).concat(ao.range(Math.ceil(l/v)*v,u,v).map(d)).concat(ao.range(Math.ceil(i/p)*p,n,p).filter(function(t){return Math.abs(t%m)>Po}).map(c)).concat(ao.range(Math.ceil(s/g)*g,a,g).filter(function(t){return Math.abs(t%v)>Po}).map(f))}var n,i,r,o,a,s,u,l,c,f,h,d,p=10,g=p,m=90,v=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[h(o).concat(d(u).slice(1),h(r).reverse().slice(1),d(l).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],l=+e[0][1],u=+e[1][1],o>r&&(e=o,o=r,r=e),l>u&&(e=l,l=u,u=e),t.precision(y)):[[o,l],[r,u]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],i>n&&(e=i,i=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(y)):[[i,s],[n,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(m=+e[0],v=+e[1],t):[m,v]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(y=+e,c=le(s,a,90),f=ce(i,n,y),h=le(l,u,90),d=ce(o,r,y),t):y},t.majorExtent([[-180,-90+Po],[180,90-Po]]).minorExtent([[-180,-80-Po],[180,80+Po]])},ao.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=fe,r=he;return t.distance=function(){return ao.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},ao.geo.interpolate=function(t,e){return de(t[0]*Ro,t[1]*Ro,e[0]*Ro,e[1]*Ro)},ao.geo.length=function(t){return va=0,ao.geo.stream(t,ya),va};var va,ya={sphere:E,point:E,lineStart:pe,lineEnd:E,polygonStart:E,polygonEnd:E};(ao.geo.conicEqualArea=function(){return ge(me)}).raw=me,ao.geo.albers=function(){return ao.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ao.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(i(o,a),e)||r(o,a),e}var e,n,i,r,o=ao.geo.albers(),a=ao.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=ao.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?a:r>=.166&&.234>r&&i>=-.214&&-.115>i?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=a.stream(t),i=s.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var l=o.scale(),c=+e[0],f=+e[1];return n=o.translate(e).clipExtent([[c-.455*l,f-.238*l],[c+.455*l,f+.238*l]]).stream(u).point,i=a.translate([c-.307*l,f+.201*l]).clipExtent([[c-.425*l+Po,f+.12*l+Po],[c-.214*l-Po,f+.234*l-Po]]).stream(u).point,r=s.translate([c-.205*l,f+.212*l]).clipExtent([[c-.214*l+Po,f+.166*l+Po],[c-.115*l-Po,f+.234*l-Po]]).stream(u).point,t},t.scale(1070)};var ba,wa,_a,xa,ka,Ma,Sa={point:E,lineStart:E,lineEnd:E,polygonStart:function(){wa=0,Sa.lineStart=ve},polygonEnd:function(){Sa.lineStart=Sa.lineEnd=Sa.point=E,ba+=Math.abs(wa/2)}},Ta={point:ye,lineStart:E,lineEnd:E,polygonStart:E,polygonEnd:E},Ca={point:_e,lineStart:xe,lineEnd:ke,polygonStart:function(){Ca.lineStart=Me},polygonEnd:function(){Ca.point=_e,Ca.lineStart=xe,Ca.lineEnd=ke}};ao.geo.path=function(){function t(t){return t&&ao.geo.stream(t,i(r.pointRadius("function"==typeof o?+o.apply(this,arguments):o))),r.result()}var e,n,i,r,o=4.5;return t.area=function(t){return ba=0,ao.geo.stream(t,i(Sa)),ba},t.centroid=function(t){return la=fa=ha=da=0,ao.geo.stream(t,i(Ca)),da?[fa/da,ha/da]:void 0},t.bounds=function(t){return ka=Ma=-(_a=xa=1/0),ao.geo.stream(t,i(Ta)),[[_a,xa],[ka,Ma]]},t.projection=function(n){return arguments.length?(i=(e=n)?n.stream||Te(n):ct,t):e},t.context=function(e){return arguments.length?(r=null==(n=e)?new be:new Se(e),t):n},t.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:+e,t):o},t.projection(ao.geo.albersUsa()).context(null)};var Da=Ce(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(ao.geo.azimuthalEqualArea=function(){return Kt(Da)}).raw=Da;var Ea=Ce(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},ct);(ao.geo.azimuthalEquidistant=function(){return Kt(Ea)}).raw=Ea,(ao.geo.conicConformal=function(){return ge(De)}).raw=De,(ao.geo.conicEquidistant=function(){return ge(Ee)}).raw=Ee;var Na=Ce(function(t){return 1/t},Math.atan);(ao.geo.gnomonic=function(){return Kt(Na)}).raw=Na,Ne.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-jo/2]},(ao.geo.mercator=function(){return $e(Ne)}).raw=Ne;var $a=Ce(function(){return 1},Math.asin);(ao.geo.orthographic=function(){return Kt($a)}).raw=$a;var Aa=Ce(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(ao.geo.stereographic=function(){return Kt(Aa)}).raw=Aa,Ae.invert=function(t,e){return[Math.atan2(F(t),Math.cos(e)),q(Math.sin(e)/Y(t))]},(ao.geo.transverseMercator=function(){return $e(Ae)}).raw=Ae,ao.geom={},ao.svg={},ao.svg.line=function(){return je(ct)};var ja=ao.map({linear:Ie,"linear-closed":He,"step-before":Le,"step-after":ze,basis:Be,"basis-open":We,"basis-closed":Ue,bundle:Ge,cardinal:Fe,"cardinal-open":Oe,"cardinal-closed":qe,monotone:tn});ja.forEach(function(t,e){
e.key=t,e.closed=/-closed$/.test(t)});var Pa=[0,2/3,1/3,0],Ra=[0,1/3,2/3,0],Ia=[0,1/6,2/3,1/6];ao.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r,o,a,s,u,l,c,f,h,d,p,g=lt(n),m=lt(i),v=t.length,y=v-1,b=[],w=[],_=0;if(g===Pe&&i===Re)e=t;else for(o=0,e=[];v>o;++o)e.push([+g.call(this,r=t[o],o),+m.call(this,r,o)]);for(o=1;v>o;++o)(e[o][1]<e[_][1]||e[o][1]==e[_][1]&&e[o][0]<e[_][0])&&(_=o);for(o=0;v>o;++o)o!==_&&(u=e[o][1]-e[_][1],s=e[o][0]-e[_][0],b.push({angle:Math.atan2(u,s),index:o}));for(b.sort(function(t,e){return t.angle-e.angle}),d=b[0].angle,h=b[0].index,f=0,o=1;y>o;++o){if(a=b[o].index,d==b[o].angle){if(s=e[h][0]-e[_][0],u=e[h][1]-e[_][1],l=e[a][0]-e[_][0],c=e[a][1]-e[_][1],s*s+u*u>=l*l+c*c){b[o].index=-1;continue}b[f].index=-1}d=b[o].angle,f=o,h=a}for(w.push(_),o=0,a=0;2>o;++a)b[a].index>-1&&(w.push(b[a].index),o++);for(p=w.length;y>a;++a)if(!(b[a].index<0)){for(;!en(w[p-2],w[p-1],b[a].index,e);)--p;w[p++]=b[a].index}var x=[];for(o=p-1;o>=0;--o)x.push(t[w[o]]);return x}var n=Pe,i=Re;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},ao.geom.polygon=function(t){return t.area=function(){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return.5*i},t.centroid=function(e){var n,i,r=-1,o=t.length,a=0,s=0,u=t[o-1];for(arguments.length||(e=-1/(6*t.area()));++r<o;)n=u,u=t[r],i=n[0]*u[1]-u[0]*n[1],a+=(n[0]+u[0])*i,s+=(n[1]+u[1])*i;return[a*e,s*e]},t.clip=function(e){for(var n,i,r,o,a,s,u=-1,l=t.length,c=t[l-1];++u<l;){for(n=e.slice(),e.length=0,o=t[u],a=n[(r=n.length)-1],i=-1;++i<r;)s=n[i],nn(s,c,o)?(nn(a,c,o)||e.push(rn(a,s,c,o)),e.push(s)):nn(a,c,o)&&e.push(rn(a,s,c,o)),a=s;c=o}return e},t},ao.geom.delaunay=function(t){var e=t.map(function(){return[]}),n=[];return on(t,function(n){e[n.region.l.index].push(t[n.region.r.index])}),e.forEach(function(e,i){var r=t[i],o=r[0],a=r[1];e.forEach(function(t){t.angle=Math.atan2(t[0]-o,t[1]-a)}),e.sort(function(t,e){return t.angle-e.angle});for(var s=0,u=e.length-1;u>s;s++)n.push([r,e[s],e[s+1]])}),n},ao.geom.voronoi=function(t){function e(t){var e,i,a,s=t.map(function(){return[]}),u=lt(r),l=lt(o),c=t.length,f=1e6;if(u===Pe&&l===Re)e=t;else for(e=[],a=0;c>a;++a)e.push([+u.call(this,i=t[a],a),+l.call(this,i,a)]);if(on(e,function(t){var e,n,i,r,o,a;1===t.a&&t.b>=0?(e=t.ep.r,n=t.ep.l):(e=t.ep.l,n=t.ep.r),1===t.a?(o=e?e.y:-f,i=t.c-t.b*o,a=n?n.y:f,r=t.c-t.b*a):(i=e?e.x:-f,o=t.c-t.a*i,r=n?n.x:f,a=t.c-t.a*r);var u=[i,o],l=[r,a];s[t.region.l.index].push(u,l),s[t.region.r.index].push(u,l)}),s=s.map(function(t,n){var i=e[n][0],r=e[n][1],o=t.map(function(t){return Math.atan2(t[0]-i,t[1]-r)}),a=ao.range(t.length).sort(function(t,e){return o[t]-o[e]});return a.filter(function(t,e){return!e||o[t]-o[a[e-1]]>Po}).map(function(e){return t[e]})}),s.forEach(function(t,n){var i=t.length;if(!i)return t.push([-f,-f],[-f,f],[f,f],[f,-f]);if(!(i>2)){var r=e[n],o=t[0],a=t[1],s=r[0],u=r[1],l=o[0],c=o[1],h=a[0],d=a[1],p=Math.abs(h-l),g=d-c;if(Math.abs(g)<Po){var m=c>u?-f:f;t.push([-f,m],[f,m])}else if(Po>p){var v=l>s?-f:f;t.push([v,-f],[v,f])}else{var m=(l-s)*(d-c)>(h-l)*(c-u)?f:-f,y=Math.abs(g)-p;Math.abs(y)<Po?t.push([0>g?m:-m,m]):(y>0&&(m*=-1),t.push([-f,m],[f,m]))}}}),n)for(a=0;c>a;++a)n(s[a]);for(a=0;c>a;++a)s[a].point=t[a];return s}var n,i=null,r=Pe,o=Re;return arguments.length?e(t):(e.x=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(o=t,e):o},e.size=function(t){return arguments.length?(null==t?n=null:(i=[+t[0],+t[1]],n=ao.geom.polygon([[0,0],[0,i[1]],i,[i[0],0]]).clip),e):i},e.links=function(t){var e,n,i,a=t.map(function(){return[]}),s=[],u=lt(r),l=lt(o),c=t.length;if(u===Pe&&l===Re)e=t;else for(i=0;c>i;++i)e.push([+u.call(this,n=t[i],i),+l.call(this,n,i)]);return on(e,function(e){var n=e.region.l.index,i=e.region.r.index;a[n][i]||(a[n][i]=a[i][n]=!0,s.push({source:t[n],target:t[i]}))}),s},e.triangles=function(t){if(r===Pe&&o===Re)return ao.geom.delaunay(t);var e,n,i,a,s,u=lt(r),l=lt(o);for(a=0,e=[],s=t.length;s>a;++a)n=[+u.call(this,i=t[a],a),+l.call(this,i,a)],n.data=i,e.push(n);return ao.geom.delaunay(e).map(function(t){return t.map(function(t){return t.data})})},e)};var Ha={l:"r",r:"l"};ao.geom.quadtree=function(t,e,n,i,r){function o(t){function o(t,e,n,i,r,o,a,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(Math.abs(u-n)+Math.abs(c-i)<.01)l(t,e,n,i,r,o,a,s);else{var f=t.point;t.x=t.y=t.point=null,l(t,f,u,c,r,o,a,s),l(t,e,n,i,r,o,a,s)}else t.x=n,t.y=i,t.point=e}else l(t,e,n,i,r,o,a,s)}function l(t,e,n,i,r,a,s,u){var l=.5*(r+s),c=.5*(a+u),f=n>=l,h=i>=c,d=(h<<1)+f;t.leaf=!1,t=t.nodes[d]||(t.nodes[d]=un()),f?r=l:s=l,h?a=c:u=c,o(t,e,n,i,r,a,s,u)}var c,f,h,d,p,g,m,v,y,b=lt(s),w=lt(u);if(null!=e)g=e,m=n,v=i,y=r;else if(v=y=-(g=m=1/0),f=[],h=[],p=t.length,a)for(d=0;p>d;++d)c=t[d],c.x<g&&(g=c.x),c.y<m&&(m=c.y),c.x>v&&(v=c.x),c.y>y&&(y=c.y),f.push(c.x),h.push(c.y);else for(d=0;p>d;++d){var _=+b(c=t[d],d),x=+w(c,d);g>_&&(g=_),m>x&&(m=x),_>v&&(v=_),x>y&&(y=x),f.push(_),h.push(x)}var k=v-g,M=y-m;k>M?y=m+k:v=g+M;var S=un();if(S.add=function(t){o(S,t,+b(t,++d),+w(t,d),g,m,v,y)},S.visit=function(t){ln(t,S,g,m,v,y)},d=-1,null==e){for(;++d<p;)o(S,t[d],f[d],h[d],g,m,v,y);--d}else t.forEach(S.add);return f=h=t=c=null,S}var a,s=Pe,u=Re;return(a=arguments.length)?(s=an,u=sn,3===a&&(r=n,i=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(u=t,o):u},o.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),o):null==e?null:[i,r]},o)},ao.interpolateRgb=cn,ao.transform=function(t){var e=so.createElementNS(ao.ns.prefix.svg,"g");return(ao.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new fn(n?n.matrix:La)})(t)},fn.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var La={a:1,b:0,c:0,d:1,e:0,f:0};ao.interpolateNumber=gn,ao.interpolateTransform=mn,ao.interpolateObject=vn,ao.interpolateString=yn;var za=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;ao.interpolate=bn,ao.interpolators=[function(t,e){var n=typeof e;return("string"===n?Vo.has(e)||/^(#|rgb\(|hsl\()/.test(e)?cn:yn:e instanceof R?cn:"object"===n?Array.isArray(e)?_n:vn:gn)(t,e)}],ao.interpolateArray=_n;var Oa=function(){return ct},qa=ao.map({linear:Oa,poly:Dn,quad:function(){return Sn},cubic:function(){return Tn},sin:function(){return En},exp:function(){return Nn},circle:function(){return $n},elastic:An,back:jn,bounce:function(){return Pn}}),Fa=ao.map({"in":ct,out:kn,"in-out":Mn,"out-in":function(t){return Mn(kn(t))}});ao.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.substring(0,e):t,i=e>=0?t.substring(e+1):"in";return n=qa.get(n)||Oa,i=Fa.get(i)||ct,xn(i(n.apply(null,Array.prototype.slice.call(arguments,1))))},ao.interpolateHcl=Rn,ao.interpolateHsl=In,ao.interpolateLab=Hn,ao.interpolateRound=Ln,ao.layout={},ao.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(qn(t[n]));return e}},ao.layout.chord=function(){function t(){var t,l,f,h,d,p={},g=[],m=ao.range(o),v=[];for(n=[],i=[],t=0,h=-1;++h<o;){for(l=0,d=-1;++d<o;)l+=r[h][d];g.push(l),v.push(ao.range(o)),t+=l}for(a&&m.sort(function(t,e){return a(g[t],g[e])}),s&&v.forEach(function(t,e){t.sort(function(t,n){return s(r[e][t],r[e][n])})}),t=(2*jo-c*o)/t,l=0,h=-1;++h<o;){for(f=l,d=-1;++d<o;){var y=m[h],b=v[y][d],w=r[y][b],_=l,x=l+=w*t;p[y+"-"+b]={index:y,subindex:b,startAngle:_,endAngle:x,value:w}}i[y]={index:y,startAngle:f,endAngle:l,value:(l-f)/t},l+=c}for(h=-1;++h<o;)for(d=h-1;++d<o;){var k=p[h+"-"+d],M=p[d+"-"+h];(k.value||M.value)&&n.push(k.value<M.value?{source:M,target:k}:{source:k,target:M})}u&&e()}function e(){n.sort(function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,o,a,s,u,l={},c=0;return l.matrix=function(t){return arguments.length?(o=(r=t)&&r.length,n=i=null,l):r},l.padding=function(t){return arguments.length?(c=t,n=i=null,l):c},l.sortGroups=function(t){return arguments.length?(a=t,n=i=null,l):a},l.sortSubgroups=function(t){return arguments.length?(s=t,n=null,l):s},l.sortChords=function(t){return arguments.length?(u=t,n&&e(),l):u},l.chords=function(){return n||t(),n},l.groups=function(){return i||t(),i},l},ao.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=1/Math.sqrt(o*o+a*a);if(g>(r-n)*s){var u=e.charge*s*s;return t.px-=o*u,t.py-=a*u,!0}if(e.point&&isFinite(s)){var u=e.pointCharge*s*s;t.px-=o*u,t.py-=a*u}}return!e.charge}}function e(t){t.px=ao.event.x,t.py=ao.event.y,s.resume()}var n,i,r,o,a,s={},u=ao.dispatch("start","tick","end"),l=[1,1],c=.9,f=Ya,h=Va,d=-30,p=.1,g=.8,m=[],v=[];return s.tick=function(){if((i*=.99)<.005)return u.end({type:"end",alpha:i=0}),!0;var e,n,s,f,h,g,y,b,w,_=m.length,x=v.length;for(n=0;x>n;++n)s=v[n],f=s.source,h=s.target,b=h.x-f.x,w=h.y-f.y,(g=b*b+w*w)&&(g=i*o[n]*((g=Math.sqrt(g))-r[n])/g,b*=g,w*=g,h.x-=b*(y=f.weight/(h.weight+f.weight)),h.y-=w*y,f.x+=b*(y=1-y),f.y+=w*y);if((y=i*p)&&(b=l[0]/2,w=l[1]/2,n=-1,y))for(;++n<_;)s=m[n],s.x+=(b-s.x)*y,s.y+=(w-s.y)*y;if(d)for(Gn(e=ao.geom.quadtree(m),i,a),n=-1;++n<_;)(s=m[n]).fixed||e.visit(t(s));for(n=-1;++n<_;)s=m[n],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*c,s.y-=(s.py-(s.py=s.y))*c);u.tick({type:"tick",alpha:i})},s.nodes=function(t){return arguments.length?(m=t,s):m},s.links=function(t){return arguments.length?(v=t,s):v},s.size=function(t){return arguments.length?(l=t,s):l},s.linkDistance=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.gravity=function(t){return arguments.length?(p=+t,s):p},s.theta=function(t){return arguments.length?(g=+t,s):g},s.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(u.start({type:"start",alpha:i=t}),ao.timer(s.tick)),s):i},s.start=function(){function t(t,i){for(var r,o=e(n),a=-1,s=o.length;++a<s;)if(!isNaN(r=o[a][t]))return r;return Math.random()*i}function e(){if(!u){for(u=[],i=0;p>i;++i)u[i]=[];for(i=0;g>i;++i){var t=v[i];u[t.source.index].push(t.target),u[t.target.index].push(t.source)}}return u[n]}var n,i,u,c,p=m.length,g=v.length,y=l[0],b=l[1];for(n=0;p>n;++n)(c=m[n]).index=n,c.weight=0;for(n=0;g>n;++n)c=v[n],"number"==typeof c.source&&(c.source=m[c.source]),"number"==typeof c.target&&(c.target=m[c.target]),++c.source.weight,++c.target.weight;for(n=0;p>n;++n)c=m[n],isNaN(c.x)&&(c.x=t("x",y)),isNaN(c.y)&&(c.y=t("y",b)),isNaN(c.px)&&(c.px=c.x),isNaN(c.py)&&(c.py=c.y);if(r=[],"function"==typeof f)for(n=0;g>n;++n)r[n]=+f.call(this,v[n],n);else for(n=0;g>n;++n)r[n]=f;if(o=[],"function"==typeof h)for(n=0;g>n;++n)o[n]=+h.call(this,v[n],n);else for(n=0;g>n;++n)o[n]=h;if(a=[],"function"==typeof d)for(n=0;p>n;++n)a[n]=+d.call(this,m[n],n);else for(n=0;p>n;++n)a[n]=d;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return n||(n=ao.behavior.drag().origin(ct).on("dragstart.force",Vn).on("drag.force",e).on("dragend.force",Bn)),arguments.length?void this.on("mouseover.force",Wn).on("mouseout.force",Un).call(n):n},ao.rebind(s,u,"on")};var Ya=20,Va=1;ao.layout.hierarchy=function(){function t(e,a,s){var u=r.call(n,e,a);if(e.depth=a,s.push(e),u&&(l=u.length)){for(var l,c,f=-1,h=e.children=[],d=0,p=a+1;++f<l;)c=t(u[f],p,s),c.parent=e,h.push(c),d+=c.value;i&&h.sort(i),o&&(e.value=d)}else o&&(e.value=+o.call(n,e,a)||0);return e}function e(t,i){var r=t.children,a=0;if(r&&(s=r.length))for(var s,u=-1,l=i+1;++u<s;)a+=e(r[u],l);else o&&(a=+o.call(n,t,i)||0);return o&&(t.value=a),a}function n(e){var n=[];return t(e,0,n),n}var i=Jn,r=Qn,o=Zn;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(t){return arguments.length?(o=t,n):o},n.revalue=function(t){return e(t,0),t},n},ao.layout.partition=function(){function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(a=o.length)){var a,s,u,l=-1;for(i=e.value?i/e.value:0;++l<a;)t(s=o[l],n,u=s.value*i,r),n+=u}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,e(n[o]));return 1+i}function n(n,o){var a=i.call(this,n,o);return t(a[0],0,r[0],r[1]/e(a[0])),a}var i=ao.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},Xn(n,i)},ao.layout.pie=function(){function t(o){var a=o.map(function(n,i){return+e.call(t,n,i)}),s=+("function"==typeof i?i.apply(this,arguments):i),u=(("function"==typeof r?r.apply(this,arguments):r)-s)/ao.sum(a),l=ao.range(o.length);null!=n&&l.sort(n===Ba?function(t,e){return a[e]-a[t]}:function(t,e){return n(o[t],o[e])});var c=[];return l.forEach(function(t){var e;c[t]={data:o[t],value:e=a[t],startAngle:s,endAngle:s+=e*u}}),c}var e=Number,n=Ba,i=0,r=2*jo;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var Ba={};ao.layout.stack=function(){function t(s,u){var l=s.map(function(n,i){return e.call(t,n,i)}),c=l.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),a.call(t,e,n)]})}),f=n.call(t,c,u);l=ao.permute(l,f),c=ao.permute(c,f);var h,d,p,g=i.call(t,c,u),m=l.length,v=l[0].length;for(d=0;v>d;++d)for(r.call(t,l[0][d],p=g[d],c[0][d][1]),h=1;m>h;++h)r.call(t,l[h][d],p+=c[h-1][d][1],c[h][d][1]);return s}var e=ct,n=ii,i=ri,r=ni,o=ti,a=ei;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:Wa.get(e)||ii,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:Ua.get(e)||ri,t):i},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(r=e,t):r},t};var Wa=ao.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(oi),o=t.map(ai),a=ao.range(i).sort(function(t,e){return r[t]-r[e]}),s=0,u=0,l=[],c=[];for(e=0;i>e;++e)n=a[e],u>s?(s+=o[n],l.push(n)):(u+=o[n],c.push(n));return c.reverse().concat(l)},reverse:function(t){return ao.range(t.length).reverse()},"default":ii}),Ua=ao.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,a=[],s=0,u=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>s&&(s=i),a.push(i)}for(n=0;o>n;++n)u[n]=(s-a[n])/2;return u},wiggle:function(t){var e,n,i,r,o,a,s,u,l,c=t.length,f=t[0],h=f.length,d=[];for(d[0]=u=l=0,n=1;h>n;++n){for(e=0,r=0;c>e;++e)r+=t[e][n][1];for(e=0,o=0,s=f[n][0]-f[n-1][0];c>e;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);e>i;++i)a+=(t[i][n][1]-t[i][n-1][1])/s;o+=a*t[e][n][1]}d[n]=u-=r?o/r*s:0,l>u&&(l=u)}for(n=0;h>n;++n)d[n]-=l;return d},expand:function(t){var e,n,i,r=t.length,o=t[0].length,a=1/r,s=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=a}for(n=0;o>n;++n)s[n]=0;return s},zero:ri});ao.layout.histogram=function(){function t(t,o){for(var a,s,u=[],l=t.map(n,this),c=i.call(this,l,o),f=r.call(this,c,l,o),o=-1,h=l.length,d=f.length-1,p=e?1:1/h;++o<d;)a=u[o]=[],a.dx=f[o+1]-(a.x=f[o]),a.y=0;if(d>0)for(o=-1;++o<h;)s=l[o],s>=c[0]&&s<=c[1]&&(a=u[ao.bisect(f,s,1,d)-1],a.y+=p,a.push(t[o]));return u}var e=!0,n=Number,i=ci,r=ui;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=lt(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return li(t,e)}:lt(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},ao.layout.tree=function(){function t(t,r){function o(t,e){var i=t.children,r=t._tree;if(i&&(a=i.length)){for(var a,u,l,c=i[0],f=c,h=-1;++h<a;)l=i[h],o(l,u),f=s(l,u,f),u=l;bi(t);var d=.5*(c._tree.prelim+l._tree.prelim);e?(r.prelim=e._tree.prelim+n(t,e),r.mod=r.prelim-d):r.prelim=d}else e&&(r.prelim=e._tree.prelim+n(t,e))}function a(t,e){t.x=t._tree.prelim+e;var n=t.children;if(n&&(i=n.length)){var i,r=-1;for(e+=t._tree.mod;++r<i;)a(n[r],e)}}function s(t,e,i){if(e){for(var r,o=t,a=t,s=e,u=t.parent.children[0],l=o._tree.mod,c=a._tree.mod,f=s._tree.mod,h=u._tree.mod;s=di(s),o=hi(o),s&&o;)u=hi(u),a=di(a),a._tree.ancestor=t,r=s._tree.prelim+f-o._tree.prelim-l+n(s,o),r>0&&(wi(_i(s,t,i),t,r),l+=r,c+=r),f+=s._tree.mod,l+=o._tree.mod,h+=u._tree.mod,c+=a._tree.mod;s&&!di(a)&&(a._tree.thread=s,a._tree.mod+=f-c),o&&!hi(u)&&(u._tree.thread=o,u._tree.mod+=l-h,i=t)}return i}var u=e.call(this,t,r),l=u[0];yi(l,function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}}),o(l),a(l,-l._tree.prelim);var c=pi(l,mi),f=pi(l,gi),h=pi(l,vi),d=c.x-n(c,f)/2,p=f.x+n(f,c)/2,g=h.depth||1;return yi(l,function(t){t.x=(t.x-d)/(p-d)*i[0],t.y=t.depth/g*i[1],delete t._tree}),u}var e=ao.layout.hierarchy().sort(null).value(null),n=fi,i=[1,1];return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=e,t):i},Xn(t,e)},ao.layout.pack=function(){function t(t,r){var o=e.call(this,t,r),a=o[0];a.x=0,a.y=0,yi(a,function(t){t.r=Math.sqrt(t.value)}),yi(a,Ti);var s=i[0],u=i[1],l=Math.max(2*a.r/s,2*a.r/u);if(n>0){var c=n*l/2;yi(a,function(t){t.r+=c}),yi(a,Ti),yi(a,function(t){t.r-=c}),l=Math.max(2*a.r/s,2*a.r/u)}return Ei(a,s/2,u/2,1/l),o}var e=ao.layout.hierarchy().sort(xi),n=0,i=[1,1];return t.size=function(e){return arguments.length?(i=e,t):i},t.padding=function(e){return arguments.length?(n=+e,t):n},Xn(t,e)},ao.layout.cluster=function(){function t(t,r){var o,a=e.call(this,t,r),s=a[0],u=0;yi(s,function(t){var e=t.children;e&&e.length?(t.x=Ai(e),t.y=$i(e)):(t.x=o?u+=n(t,o):0,t.y=0,o=t)});var l=ji(s),c=Pi(s),f=l.x-n(l,c)/2,h=c.x+n(c,l)/2;return yi(s,function(t){t.x=(t.x-f)/(h-f)*i[0],t.y=(1-(s.y?t.y/s.y:1))*i[1]}),a}var e=ao.layout.hierarchy().sort(null).value(null),n=fi,i=[1,1];return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=e,t):i},Xn(t,e)},ao.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var o=n.children;if(o&&o.length){var a,s,u,l=f(n),c=[],h=o.slice(),p=1/0,g="slice"===d?l.dx:"dice"===d?l.dy:"slice-dice"===d?1&n.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(t(h,l.dx*l.dy/n.value),c.area=0;(u=h.length)>0;)c.push(a=h[u-1]),c.area+=a.area,"squarify"!==d||(s=i(c,g))<=p?(h.pop(),p=s):(c.area-=c.pop().area,r(c,g,l,!1),g=Math.min(l.dx,l.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,g,l,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var o,a=f(e),s=i.slice(),u=[];for(t(s,a.dx*a.dy/e.value),u.area=0;o=s.pop();)u.push(o),u.area+=o.area,null!=o.z&&(r(u,o.z?a.dx:a.dy,a,!s.length),u.length=u.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(o>n&&(o=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*p/i,i/(e*o*p)):1/0}function r(t,e,n,i){var r,o=-1,a=t.length,s=n.x,l=n.y,c=e?u(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);++o<a;)r=t[o],r.x=s,r.y=l,r.dy=c,s+=r.dx=Math.min(n.x+n.dx-s,c?u(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++o<a;)r=t[o],r.x=s,r.y=l,r.dx=c,l+=r.dy=Math.min(n.y+n.dy-l,c?u(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-l,n.x+=c,n.dx-=c}}function o(i){var r=a||s(i),o=r[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?n:e)(o),h&&(a=r),r}var a,s=ao.layout.hierarchy(),u=Math.round,l=[1,1],c=null,f=Ri,h=!1,d="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(l=t,o):l},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Ri(e):Ii(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Ii(e,t)}if(!arguments.length)return c;var i;return f=null==(c=t)?Ri:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(u=t?Math.round:Number,o):u!=Number},o.sticky=function(t){return arguments.length?(h=t,a=null,o):h},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(d=t+"",o):d},Xn(o,s)},ao.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=ao.random.normal.apply(ao,arguments);return function(){return Math.exp(t())}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e/t}}},ao.scale={},ao.scale.linear=function(){return Fi([0,1],[0,1],bn,!1)},ao.scale.log=function(){return Gi(ao.scale.linear().domain([0,Math.LN10]),10,Xi,Qi,[1,10])};var Ga=ao.format(".0e");ao.scale.pow=function(){return Ki(ao.scale.linear(),1,[0,1])},ao.scale.sqrt=function(){return ao.scale.pow().exponent(.5)},ao.scale.ordinal=function(){return er([],{t:"range",a:[[]]})},ao.scale.category10=function(){return ao.scale.ordinal().range(Xa)},ao.scale.category20=function(){return ao.scale.ordinal().range(Qa)},ao.scale.category20b=function(){return ao.scale.ordinal().range(Za)},ao.scale.category20c=function(){return ao.scale.ordinal().range(Ja)};var Xa=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Qa=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Za=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Ja=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];ao.scale.quantile=function(){return nr([],[])},ao.scale.quantize=function(){return ir(0,1,[0,1])},ao.scale.threshold=function(){return rr([.5],[0,1])},ao.scale.identity=function(){return or([0,1])},ao.svg.arc=function(){function t(){var t=e.apply(this,arguments),o=n.apply(this,arguments),a=i.apply(this,arguments)+Ka,s=r.apply(this,arguments)+Ka,u=(a>s&&(u=a,a=s,s=u),s-a),l=jo>u?"0":"1",c=Math.cos(a),f=Math.sin(a),h=Math.cos(s),d=Math.sin(s);return u>=ts?t?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":t?"M"+o*c+","+o*f+"A"+o+","+o+" 0 "+l+",1 "+o*h+","+o*d+"L"+t*h+","+t*d+"A"+t+","+t+" 0 "+l+",0 "+t*c+","+t*f+"Z":"M"+o*c+","+o*f+"A"+o+","+o+" 0 "+l+",1 "+o*h+","+o*d+"L0,0Z"}var e=ar,n=sr,i=ur,r=lr;return t.innerRadius=function(n){return arguments.length?(e=lt(n),t):e},t.outerRadius=function(e){return arguments.length?(n=lt(e),t):n},t.startAngle=function(e){return arguments.length?(i=lt(e),t):i},t.endAngle=function(e){return arguments.length?(r=lt(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,o=(i.apply(this,arguments)+r.apply(this,arguments))/2+Ka;return[Math.cos(o)*t,Math.sin(o)*t]},t};var Ka=-jo/2,ts=2*jo-1e-6;ao.svg.line.radial=function(){var t=je(cr);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Le.reverse=ze,ze.reverse=Le,ao.svg.area=function(){return fr(ct)},ao.svg.area.radial=function(){var t=fr(cr);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},ao.svg.chord=function(){function t(t,s){var u=e(this,o,t,s),l=e(this,a,t,s);return"M"+u.p0+i(u.r,u.p1,u.a1-u.a0)+(n(u,l)?r(u.r,u.p1,u.r,u.p0):r(u.r,u.p1,l.r,l.p0)+i(l.r,l.p1,l.a1-l.a0)+r(l.r,l.p1,u.r,u.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),o=s.call(t,r,i),a=u.call(t,r,i)+Ka,c=l.call(t,r,i)+Ka;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>jo)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var o=fe,a=he,s=hr,u=ur,l=lr;return t.radius=function(e){return arguments.length?(s=lt(e),t):s},t.source=function(e){return arguments.length?(o=lt(e),t):o},t.target=function(e){return arguments.length?(a=lt(e),t):a},t.startAngle=function(e){return arguments.length?(u=lt(e),t):u},t.endAngle=function(e){return arguments.length?(l=lt(e),t):l},t},ao.svg.diagonal=function(){function t(t,r){var o=e.call(this,t,r),a=n.call(this,t,r),s=(o.y+a.y)/2,u=[o,{x:o.x,y:s},{x:a.x,y:s},a];return u=u.map(i),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var e=fe,n=he,i=dr;return t.source=function(n){return arguments.length?(e=lt(n),t):e},t.target=function(e){return arguments.length?(n=lt(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},ao.svg.diagonal.radial=function(){var t=ao.svg.diagonal(),e=dr,n=t.projection;return t.projection=function(t){return arguments.length?n(pr(e=t)):e},t},ao.svg.symbol=function(){function t(t,i){return(es.get(e.call(this,t,i))||vr)(n.call(this,t,i))}var e=mr,n=gr;return t.type=function(n){return arguments.length?(e=lt(n),t):e},t.size=function(e){return arguments.length?(n=lt(e),t):n},t};var es=ao.map({circle:vr,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*rs)),n=e*rs;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/is),n=e*is/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/is),n=e*is/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});ao.svg.symbolTypes=es.keys();var ns,is=Math.sqrt(3),rs=Math.tan(30*Ro),os=[],as=0,ss={ease:Cn,delay:0,duration:250};os.call=ko.call,os.empty=ko.empty,os.node=ko.node,ao.transition=function(t){return arguments.length?ns?t.transition():t:Do.transition()},ao.transition.prototype=os,os.select=function(t){var e,n,i,r=this.id,o=[];"function"!=typeof t&&(t=v(t));for(var a=-1,s=this.length;++a<s;){o.push(e=[]);for(var u=this[a],l=-1,c=u.length;++l<c;)(i=u[l])&&(n=t.call(i,i.__data__,l))?("__data__"in i&&(n.__data__=i.__data__),_r(n,l,r,i.__transition__[r]),e.push(n)):e.push(null)}return yr(o,r)},os.selectAll=function(t){var e,n,i,r,o,a=this.id,s=[];"function"!=typeof t&&(t=y(t));for(var u=-1,l=this.length;++u<l;)for(var c=this[u],f=-1,h=c.length;++f<h;)if(i=c[f]){o=i.__transition__[a],n=t.call(i,i.__data__,f),s.push(e=[]);for(var d=-1,p=n.length;++d<p;)_r(r=n[d],d,a,o),e.push(r)}return yr(s,a)},os.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=C(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]);for(var n=this[o],s=0,u=n.length;u>s;s++)(i=n[s])&&t.call(i,i.__data__,s)&&e.push(i)}return yr(r,this.id,this.time).ease(this.ease())},os.tween=function(t,e){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(t):j(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(i){i.__transition__[n].tween.set(t,e)})},os.attr=function(t,e){function n(){this.removeAttribute(s)}function i(){this.removeAttributeNS(s.space,s.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(s);return n!==t&&(e=a(n,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(s.space,s.local);return n!==t&&(e=a(n,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a=wn(t),s=ao.ns.qualify(t);return br(this,"attr."+t,e,s.local?o:r)},os.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=ao.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},os.style=function(t,e,n){function i(){this.style.removeProperty(t)}function r(e){return null==e?i:(e+="",function(){var i,r=uo.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=a(r,e),function(e){this.style.setProperty(t,i(e),n)})})}var o=arguments.length;if(3>o){if("string"!=typeof t){2>o&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}var a=wn(t);return br(this,"style."+t,e,r)},os.styleTween=function(t,e,n){function i(i,r){var o=e.call(this,i,r,uo.getComputedStyle(this,null).getPropertyValue(t));return o&&function(e){this.style.setProperty(t,o(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,i)},os.text=function(t){return br(this,"text",t,wr)},os.remove=function(){return this.each("end.transition",function(){var t;!this.__transition__&&(t=this.parentNode)&&t.removeChild(this)})},os.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=ao.ease.apply(ao,arguments)),j(this,function(n){n.__transition__[e].ease=t}))},os.delay=function(t){var e=this.id;return j(this,"function"==typeof t?function(n,i,r){n.__transition__[e].delay=0|t.call(n,n.__data__,i,r)}:(t|=0,function(n){n.__transition__[e].delay=t}))},os.duration=function(t){var e=this.id;return j(this,"function"==typeof t?function(n,i,r){n.__transition__[e].duration=Math.max(1,0|t.call(n,n.__data__,i,r))}:(t=Math.max(1,0|t),function(n){n.__transition__[e].duration=t}))},os.each=function(t,e){var n=this.id;if(arguments.length<2){var i=ss,r=ns;ns=n,j(this,function(e,i,r){ss=e.__transition__[n],t.call(e,e.__data__,i,r)}),ss=i,ns=r}else j(this,function(i){i.__transition__[n].event.on(t,e)});return this},os.transition=function(){for(var t,e,n,i,r=this.id,o=++as,a=[],s=0,u=this.length;u>s;s++){a.push(t=[]);for(var e=this[s],l=0,c=e.length;c>l;l++)(n=e[l])&&(i=Object.create(n.__transition__[r]),i.delay+=i.duration,_r(n,l,o,i)),t.push(n)}return yr(a,o)},ao.svg.axis=function(){function t(t){t.each(function(){var t,f=ao.select(this),h=null==l?n.ticks?n.ticks.apply(n,u):n.domain():l,d=null==e?n.tickFormat?n.tickFormat.apply(n,u):String:e,p=Mr(n,h,c),g=f.selectAll(".tick.minor").data(p,String),m=g.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1e-6),v=ao.transition(g.exit()).style("opacity",1e-6).remove(),y=ao.transition(g).style("opacity",1),b=f.selectAll(".tick.major").data(h,String),w=b.enter().insert("g","path").attr("class","tick major").style("opacity",1e-6),_=ao.transition(b.exit()).style("opacity",1e-6).remove(),x=ao.transition(b).style("opacity",1),k=Li(n),M=f.selectAll(".domain").data([0]),S=(M.enter().append("path").attr("class","domain"),ao.transition(M)),T=n.copy(),C=this.__chart__||T;this.__chart__=T,w.append("line"),w.append("text");var D=w.select("line"),E=x.select("line"),N=b.select("text").text(d),$=w.select("text"),A=x.select("text");switch(i){case"bottom":t=xr,m.attr("y2",o),y.attr("x2",0).attr("y2",o),D.attr("y2",r),$.attr("y",Math.max(r,0)+s),E.attr("x2",0).attr("y2",r),A.attr("x",0).attr("y",Math.max(r,0)+s),N.attr("dy",".71em").style("text-anchor","middle"),S.attr("d","M"+k[0]+","+a+"V0H"+k[1]+"V"+a);break;case"top":t=xr,m.attr("y2",-o),y.attr("x2",0).attr("y2",-o),D.attr("y2",-r),$.attr("y",-(Math.max(r,0)+s)),E.attr("x2",0).attr("y2",-r),A.attr("x",0).attr("y",-(Math.max(r,0)+s)),N.attr("dy","0em").style("text-anchor","middle"),S.attr("d","M"+k[0]+","+-a+"V0H"+k[1]+"V"+-a);break;case"left":t=kr,m.attr("x2",-o),
y.attr("x2",-o).attr("y2",0),D.attr("x2",-r),$.attr("x",-(Math.max(r,0)+s)),E.attr("x2",-r).attr("y2",0),A.attr("x",-(Math.max(r,0)+s)).attr("y",0),N.attr("dy",".32em").style("text-anchor","end"),S.attr("d","M"+-a+","+k[0]+"H0V"+k[1]+"H"+-a);break;case"right":t=kr,m.attr("x2",o),y.attr("x2",o).attr("y2",0),D.attr("x2",r),$.attr("x",Math.max(r,0)+s),E.attr("x2",r).attr("y2",0),A.attr("x",Math.max(r,0)+s).attr("y",0),N.attr("dy",".32em").style("text-anchor","start"),S.attr("d","M"+a+","+k[0]+"H0V"+k[1]+"H"+a)}if(n.ticks)w.call(t,C),x.call(t,T),_.call(t,T),m.call(t,C),y.call(t,T),v.call(t,T);else{var j=T.rangeBand()/2,P=function(t){return T(t)+j};w.call(t,P),x.call(t,P)}})}var e,n=ao.scale.linear(),i=us,r=6,o=6,a=6,s=3,u=[10],l=null,c=0;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in ls?e+"":us,t):i},t.ticks=function(){return arguments.length?(u=arguments,t):u},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e,n){if(!arguments.length)return r;var i=arguments.length-1;return r=+e,o=i>1?+n:r,a=i>0?+arguments[i]:r,t},t.tickPadding=function(e){return arguments.length?(s=+e,t):s},t.tickSubdivide=function(e){return arguments.length?(c=+e,t):c},t};var us="bottom",ls={top:1,right:1,bottom:1,left:1};ao.svg.brush=function(){function t(o){o.each(function(){var o,a=ao.select(this),l=a.selectAll(".background").data([0]),f=a.selectAll(".extent").data([0]),h=a.selectAll(".resize").data(c,String);a.style("pointer-events","all").on("mousedown.brush",r).on("touchstart.brush",r),l.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.enter().append("rect").attr("class","extent").style("cursor","move"),h.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return cs[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",t.empty()?"none":null),h.exit().remove(),s&&(o=Li(s),l.attr("x",o[0]).attr("width",o[1]-o[0]),n(a)),u&&(o=Li(u),l.attr("y",o[0]).attr("height",o[1]-o[0]),i(a)),e(a)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+f[+/e$/.test(t)][0]+","+f[+/^s/.test(t)][1]+")"})}function n(t){t.select(".extent").attr("x",f[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1][0]-f[0][0])}function i(t){t.select(".extent").attr("y",f[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1][1]-f[0][1])}function r(){function r(){var t=ao.event.changedTouches;return t?ao.touches(y,t)[0]:ao.mouse(y)}function c(){32==ao.event.keyCode&&(S||(m=null,T[0]-=f[1][0],T[1]-=f[1][1],S=2),l())}function h(){32==ao.event.keyCode&&2==S&&(T[0]+=f[1][0],T[1]+=f[1][1],S=0,l())}function d(){var t=r(),o=!1;v&&(t[0]+=v[0],t[1]+=v[1]),S||(ao.event.altKey?(m||(m=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]),T[0]=f[+(t[0]<m[0])][0],T[1]=f[+(t[1]<m[1])][1]):m=null),k&&p(t,s,0)&&(n(_),o=!0),M&&p(t,u,1)&&(i(_),o=!0),o&&(e(_),w({type:"brush",mode:S?"move":"resize"}))}function p(t,e,n){var i,r,a=Li(e),s=a[0],u=a[1],l=T[n],c=f[1][n]-f[0][n];return S&&(s-=l,u-=c+l),i=Math.max(s,Math.min(u,t[n])),S?r=(i+=l)+c:(m&&(l=Math.max(s,Math.min(u,2*m[n]-i))),i>l?(r=i,i=l):r=l),f[0][n]!==i||f[1][n]!==r?(o=null,f[0][n]=i,f[1][n]=r,!0):void 0}function g(){d(),_.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),ao.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),w({type:"brushend"}),l()}var m,v,y=this,b=ao.select(ao.event.target),w=a.of(y,arguments),_=ao.select(y),x=b.datum(),k=!/^(n|s)$/.test(x)&&s,M=!/^(e|w)$/.test(x)&&u,S=b.classed("extent"),T=r(),C=ao.select(uo).on("mousemove.brush",d).on("mouseup.brush",g).on("touchmove.brush",d).on("touchend.brush",g).on("keydown.brush",c).on("keyup.brush",h);if(S)T[0]=f[0][0]-T[0],T[1]=f[0][1]-T[1];else if(x){var D=+/w$/.test(x),E=+/^n/.test(x);v=[f[1-D][0]-T[0],f[1-E][1]-T[1]],T[0]=f[D][0],T[1]=f[E][1]}else ao.event.altKey&&(m=T.slice());_.style("pointer-events","none").selectAll(".resize").style("display",null),ao.select("body").style("cursor",b.style("cursor")),w({type:"brushstart"}),d(),l()}var o,a=h(t,"brushstart","brush","brushend"),s=null,u=null,c=fs[0],f=[[0,0],[0,0]];return t.x=function(e){return arguments.length?(s=e,c=fs[!s<<1|!u],t):s},t.y=function(e){return arguments.length?(u=e,c=fs[!s<<1|!u],t):u},t.extent=function(e){var n,i,r,a,l;return arguments.length?(o=[[0,0],[0,0]],s&&(n=e[0],i=e[1],u&&(n=n[0],i=i[0]),o[0][0]=n,o[1][0]=i,s.invert&&(n=s(n),i=s(i)),n>i&&(l=n,n=i,i=l),f[0][0]=0|n,f[1][0]=0|i),u&&(r=e[0],a=e[1],s&&(r=r[1],a=a[1]),o[0][1]=r,o[1][1]=a,u.invert&&(r=u(r),a=u(a)),r>a&&(l=r,r=a,a=l),f[0][1]=0|r,f[1][1]=0|a),t):(e=o||f,s&&(n=e[0][0],i=e[1][0],o||(n=f[0][0],i=f[1][0],s.invert&&(n=s.invert(n),i=s.invert(i)),n>i&&(l=n,n=i,i=l))),u&&(r=e[0][1],a=e[1][1],o||(r=f[0][1],a=f[1][1],u.invert&&(r=u.invert(r),a=u.invert(a)),r>a&&(l=r,r=a,a=l))),s&&u?[[n,r],[i,a]]:s?[n,i]:u&&[r,a])},t.clear=function(){return o=null,f[0][0]=f[0][1]=f[1][0]=f[1][1]=0,t},t.empty=function(){return s&&f[0][0]===f[1][0]||u&&f[0][1]===f[1][1]},ao.rebind(t,a,"on")};var cs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},fs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];ao.time={};var hs=Date,ds=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Sr.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ps.setUTCDate.apply(this._,arguments)},setDay:function(){ps.setUTCDay.apply(this._,arguments)},setFullYear:function(){ps.setUTCFullYear.apply(this._,arguments)},setHours:function(){ps.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ps.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ps.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ps.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ps.setUTCSeconds.apply(this._,arguments)},setTime:function(){ps.setTime.apply(this._,arguments)}};var ps=Date.prototype,gs="%A, %e %B %Y . %X",ms="%d.%m.%Y",vs="%H:%M:%S",ys=["","","","","","",""],bs=["","","","","","",""],ws=["","","","","","","","","","","",""],_s=["","","","","","","","","","","",""];ao.time.year=Tr(function(t){return t=ao.time.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),ao.time.years=ao.time.year.range,ao.time.years.utc=ao.time.year.utc.range,ao.time.day=Tr(function(t){var e=new hs(1970,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),ao.time.days=ao.time.day.range,ao.time.days.utc=ao.time.day.utc.range,ao.time.dayOfYear=function(t){var e=ao.time.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},ds.forEach(function(t,e){t=t.toLowerCase(),e=7-e;var n=ao.time[t]=Tr(function(t){return(t=ao.time.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=ao.time.year(t).getDay();return Math.floor((ao.time.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});ao.time[t+"s"]=n.range,ao.time[t+"s"].utc=n.utc.range,ao.time[t+"OfYear"]=function(t){var n=ao.time.year(t).getDay();return Math.floor((ao.time.dayOfYear(t)+(n+e)%7)/7)}}),ao.time.week=ao.time.sunday,ao.time.weeks=ao.time.sunday.range,ao.time.weeks.utc=ao.time.sunday.utc.range,ao.time.weekOfYear=ao.time.sundayOfYear,ao.time.format=function(t){function e(e){for(var i,r,o,a=[],s=-1,u=0;++s<n;)37===t.charCodeAt(s)&&(a.push(t.substring(u,s)),null!=(r=Ds[i=t.charAt(++s)])&&(i=t.charAt(++s)),(o=Es[i])&&(i=o(e,null==r?"e"===i?" ":"0":r)),a.push(i),u=s+1);return a.push(t.substring(u,s)),a.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},i=Dr(n,t,e,0);if(i!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=new hs;return r.setFullYear(n.y,n.m,n.d),r.setHours(n.H,n.M,n.S,n.L),r},e.toString=function(){return t},e};var xs=Er(ys),ks=Er(bs),Ms=Er(ws),Ss=Nr(ws),Ts=Er(_s),Cs=Nr(_s),Ds={"-":"",_:" ",0:"0"},Es={a:function(t){return bs[t.getDay()]},A:function(t){return ys[t.getDay()]},b:function(t){return _s[t.getMonth()]},B:function(t){return ws[t.getMonth()]},c:ao.time.format(gs),d:function(t,e){return $r(t.getDate(),e,2)},e:function(t,e){return $r(t.getDate(),e,2)},H:function(t,e){return $r(t.getHours(),e,2)},I:function(t,e){return $r(t.getHours()%12||12,e,2)},j:function(t,e){return $r(1+ao.time.dayOfYear(t),e,3)},L:function(t,e){return $r(t.getMilliseconds(),e,3)},m:function(t,e){return $r(t.getMonth()+1,e,2)},M:function(t,e){return $r(t.getMinutes(),e,2)},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t,e){return $r(t.getSeconds(),e,2)},U:function(t,e){return $r(ao.time.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return $r(ao.time.mondayOfYear(t),e,2)},x:ao.time.format(ms),X:ao.time.format(vs),y:function(t,e){return $r(t.getFullYear()%100,e,2)},Y:function(t,e){return $r(t.getFullYear()%1e4,e,4)},Z:Xr,"%":function(){return"%"}},Ns={a:Ar,A:jr,b:Pr,B:Rr,c:Ir,d:Yr,e:Yr,H:Vr,I:Vr,L:Ur,m:Fr,M:Br,p:Gr,S:Wr,x:Hr,X:Lr,y:Or,Y:zr},$s=/^\s*\d+/,As=ao.map({am:0,pm:1});ao.time.format.utc=function(t){function e(t){try{hs=Sr;var e=new hs;return e._=t,n(e)}finally{hs=Date}}var n=ao.time.format(t);return e.parse=function(t){try{hs=Sr;var e=n.parse(t);return e&&e._}finally{hs=Date}},e.toString=n.toString,e};var js=ao.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");ao.time.format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Qr:js,Qr.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Qr.toString=js.toString,ao.time.second=Tr(function(t){return new hs(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),ao.time.seconds=ao.time.second.range,ao.time.seconds.utc=ao.time.second.utc.range,ao.time.minute=Tr(function(t){return new hs(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),ao.time.minutes=ao.time.minute.range,ao.time.minutes.utc=ao.time.minute.utc.range,ao.time.hour=Tr(function(t){var e=t.getTimezoneOffset()/60;return new hs(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),ao.time.hours=ao.time.hour.range,ao.time.hours.utc=ao.time.hour.utc.range,ao.time.month=Tr(function(t){return t=ao.time.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),ao.time.months=ao.time.month.range,ao.time.months.utc=ao.time.month.utc.range;var Ps=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Rs=[[ao.time.second,1],[ao.time.second,5],[ao.time.second,15],[ao.time.second,30],[ao.time.minute,1],[ao.time.minute,5],[ao.time.minute,15],[ao.time.minute,30],[ao.time.hour,1],[ao.time.hour,3],[ao.time.hour,6],[ao.time.hour,12],[ao.time.day,1],[ao.time.day,2],[ao.time.week,1],[ao.time.month,1],[ao.time.month,3],[ao.time.year,1]],Is=[[ao.time.format("%Y"),Ht],[ao.time.format("%B"),function(t){return t.getMonth()}],[ao.time.format("%b %d"),function(t){return 1!=t.getDate()}],[ao.time.format("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[ao.time.format("%I %p"),function(t){return t.getHours()}],[ao.time.format("%I:%M"),function(t){return t.getMinutes()}],[ao.time.format(":%S"),function(t){return t.getSeconds()}],[ao.time.format(".%L"),function(t){return t.getMilliseconds()}]],Hs=ao.scale.linear(),Ls=Kr(Is);Rs.year=function(t,e){return Hs.domain(t.map(eo)).ticks(e).map(to)},ao.time.scale=function(){return Zr(ao.scale.linear(),Rs,Ls)};var zs=Rs.map(function(t){return[t[0].utc,t[1]]}),Os=[[ao.time.format.utc("%Y"),Ht],[ao.time.format.utc("%B"),function(t){return t.getUTCMonth()}],[ao.time.format.utc("%b %d"),function(t){return 1!=t.getUTCDate()}],[ao.time.format.utc("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[ao.time.format.utc("%I %p"),function(t){return t.getUTCHours()}],[ao.time.format.utc("%I:%M"),function(t){return t.getUTCMinutes()}],[ao.time.format.utc(":%S"),function(t){return t.getUTCSeconds()}],[ao.time.format.utc(".%L"),function(t){return t.getUTCMilliseconds()}]],qs=Kr(Os);return zs.year=function(t,e){return Hs.domain(t.map(io)).ticks(e).map(no)},ao.time.scale.utc=function(){return Zr(ao.scale.linear(),zs,qs)},ao.text=ft(function(t){return t.responseText}),ao.json=function(t,e){return ht(t,"application/json",ro,e)},ao.html=function(t,e){return ht(t,"text/html",oo,e)},ao.xml=ft(function(t){return t.responseXML}),ao}(),define("d3",function(t){return function(){var e;return e||t.d3}}(this)),function(){function t(t,e){return t.name=e}function e(t,e){return t.href=e}function n(t){St.set(t)}function i(t){return"function"==typeof t}function r(t){return"[object Array]"==Object[st].toString[pt](Object(t))}function o(t){return void 0!=t&&-1<(t.constructor+"")[Q]("String")}function a(t,e){return 0==t[Q](e)}function s(t){var e=Nt[et]("img");return e.width=1,e.height=1,e.src=t,e}function u(){}function l(t){return L instanceof Function?L(t):(n(28),t)}function c(t){return l(t)[W](/\(/g,"%28")[W](/\)/g,"%29")}function f(t,e){if(t){var n=Nt[et]("script");n.type="text/javascript",n.async=!0,n.src=t,n.id=e;var i=Nt.getElementsByTagName("script")[0];i[xt].insertBefore(n,i)}}function h(){return fe||"https:"==Nt[ct][gt]?"https:":"http:"}function d(){var t=""+Nt[ct][ft];return 0==t[Q]("www.")?t[yt](4):t}function p(t){var e=Nt.referrer;if(/^https?:\/\//i[V](e)){if(t)return e;t="//"+Nt[ct][ft];var n=e[Q](t);if((5==n||6==n)&&(t=e[X](n+t[at]),"/"==t||"?"==t||""==t||":"==t))return;return e}}function g(t,e){if(1==e[at]&&null!=e[0]&&"object"==typeof e[0])return e[0];for(var n={},i=q.min(t[at]+1,e[at]),r=0;i>r;r++){if("object"==typeof e[r]){for(var o in e[r])e[r].hasOwnProperty(o)&&(n[o]=e[r][o]);break}r<t[at]&&(n[t[r]]=e[r])}return n}function m(t,e){for(var n=0;n<t[at];n++)if(e==t[n])return!0;return!1}function v(t){if(100!=t.get($n)&&H(Jt(t,bn))%1e4>=100*Kt(t,$n))throw"abort"}function y(t){if($t(Jt(t,_n)))throw"abort"}function b(){var t=Nt[ct][gt];if("http:"!=t&&"https:"!=t)throw"abort"}function w(t){try{Et.XMLHttpRequest&&"withCredentials"in new Et.XMLHttpRequest?n(40):Et.XDomainRequest&&n(41),Et[_t].sendBeacon&&n(42)}catch(t){}t.set(ye,Kt(t,ye)+1);var e=[];Qt.map(function(n,i){if(i.p){var r=t.get(n);void 0!=r&&r!=i[J]&&("boolean"==typeof r&&(r*=1),e[F](i.p+"="+l(""+r)))}}),e[F]("z="+Gt()),t.set(ve,e[kt]("&"),!0)}function _(t){qt(Jt(t,ve),t.get(me)),t.set(me,u,!0)}function x(t){var e=Et.gaData;e&&(e.expId&&t.set(Ge,e.expId),e.expVar&&t.set(Xe,e.expVar))}function k(){if(Et[_t]&&"preview"==Et[_t].loadPurpose)throw"abort"}function M(t){var e=Et.gaDevIds;r(e)&&0!=e[at]&&t.set("&did",e[kt](","),!0)}function S(t){ci[V](t.get(_n))||n(44)}function T(t){var e=Kt(t,Ke);e>=500&&n(15);var i=Jt(t,ge);if("transaction"!=i&&"item"!=i){var i=Kt(t,en),r=(new Date)[rt](),o=Kt(t,tn);if(0==o&&t.set(tn,r),o=q.round(2*(r-o)/1e3),o>0&&(i=q.min(i+o,20),t.set(tn,r)),0>=i)throw"abort";t.set(en,--i)}t.set(Ke,++e)}function C(t,e,n,i){e[t]=function(){try{return i&&e(i),n[wt](this,arguments)}catch(e){var r=e&&e[it];if(!(1<=100*q.random()||$t("?"))){var o=["t=error","_e=exc","_v=j22","sr=1"];t&&o[F]("_f="+t),r&&o[F]("_m="+l(r[yt](0,100))),o[F]("aip=1"),o[F]("z="+Ut()),qt(o[kt]("&"))}throw e}}}function D(){var t,e,n;if((n=(n=Et[_t])?n.plugins:null)&&n[at])for(var i=0;i<n[at]&&!e;i++){var r=n[i];-1<r[it][Q]("Shockwave Flash")&&(e=r.description)}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=t.GetVariable("$version")}catch(t){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e="WIN 6,0,21,0",t.AllowScriptAccess="always",e=t.GetVariable("$version")}catch(t){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e=t.GetVariable("$version")}catch(t){}return e&&(t=e[Z](/[\d]+/g))&&3<=t[at]&&(e=t[0]+"."+t[1]+" r"+t[2]),e||void 0}function E(t,e,n){"none"==e&&(e="");var i=[],r=jt(t);t="__utma"==t?6:2;for(var o=0;o<r[at];o++){var a=(""+r[o])[lt](".");a[at]>=t&&i[F]({hash:a[0],R:r[o],O:a})}return 0==i[at]?void 0:1==i[at]?i[0]:N(e,i)||N(n,i)||N(null,i)||i[0]}function N(t,e){var n,i;null==t?n=i=1:(n=H(t),i=H(a(t,".")?t[yt](1):"."+t));for(var r=0;r<e[at];r++)if(e[r][Y]==n||e[r][Y]==i)return e[r]}function $(t){t=t.get(bn);var e=A(t,0);return"_ga=1."+l(e+"."+t)}function A(t,e){for(var n=new Date,i=Et[_t],r=i.plugins||[],n=[t,i.userAgent,n.getTimezoneOffset(),n.getYear(),n.getDate(),n.getHours(),n.getMinutes()+e],i=0;i<r[at];++i)n[F](r[i].description);return H(n[kt]("."))}function j(t,e){if(e==Nt[ct][ft])return!1;for(var n=0;n<t[at];n++)if(0<=e[Q](t[n]))return!0;return!1}function P(){var t=Et.gaGlobal=Et.gaGlobal||{};return t.hid=t.hid||Ut()}function R(t){return 0<=t[Q](".")||0<=t[Q](":")}function I(t){function n(t){var e=(t[ft]||"")[lt](":")[0][Mt](),n=(t[gt]||"")[Mt](),n=1*t[tt]||("http:"==n?80:"https:"==n?443:"");return t=t.pathname||"",a(t,"/")||(t="/"+t),[e,""+n,t]}var i=Nt[et]("a");e(i,Nt[ct][vt]);var r=(i[gt]||"")[Mt](),o=n(i),s=i[ht]||"",u=r+"//"+o[0]+(o[1]?":"+o[1]:"");return a(t,"//")?t=r+t:a(t,"/")?t=u+t:!t||a(t,"?")?t=u+o[2]+(t||s):0>t[lt]("/")[0][Q](":")&&(t=u+o[2][yt](0,o[2].lastIndexOf("/"))+"/"+t),e(i,t),r=n(i),{protocol:(i[gt]||"")[Mt](),host:r[0],port:r[1],path:r[2],G:i[ht]||"",url:t||""}}function H(t){var e,n=1,i=0;if(t)for(n=0,e=t[at]-1;e>=0;e--)i=t.charCodeAt(e),n=(n<<6&268435455)+i+(i<<14),i=266338304&n,n=0!=i?n^i>>21:n;return n}var L=encodeURIComponent,z=window,O=setTimeout,q=Math,F="push",Y="hash",V="test",B="slice",W="replace",U="data",G="cookie",X="charAt",Q="indexOf",Z="match",J="defaultValue",K="send",tt="port",et="createElement",nt="setAttribute",it="name",rt="getTime",ot="host",at="length",st="prototype",ut="clientWidth",lt="split",ct="location",ft="hostname",ht="search",dt="target",pt="call",gt="protocol",mt="clientHeight",vt="href",yt="substring",bt="action",wt="apply",_t="navigator",xt="parentNode",kt="join",Mt="toLowerCase",St=new function(){var t=[];this.set=function(e){t[e]=!0},this.M=function(){for(var e=[],n=0;n<t[at];n++)t[n]&&(e[q.floor(n/6)]=e[q.floor(n/6)]^1<<n%6);for(n=0;n<e[at];n++)e[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[X](e[n]||0);return e[kt]("")+"~"}},Tt=function(t,e,i,r){try{t.addEventListener?t.addEventListener(e,i,!!r):t.attachEvent&&t.attachEvent("on"+e,i)}catch(t){n(27)}},Ct=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n)},Dt=function(){this.keys=[],this.w={},this.m={}};Dt[st].set=function(t,e,n){this.keys[F](t),n?this.m[":"+t]=e:this.w[":"+t]=e},Dt[st].get=function(t){return this.m.hasOwnProperty(":"+t)?this.m[":"+t]:this.w[":"+t]},Dt[st].map=function(t){for(var e=0;e<this.keys[at];e++){var n=this.keys[e],i=this.get(n);i&&t(n,i)}};var Et=z,Nt=document,$t=function(t){var e=Et._gaUserPrefs;if(e&&e.ioo&&e.ioo()||t&&!0===Et["ga-disable-"+t])return!0;try{var n=Et.external;if(n&&n._gaUserPrefs&&"oo"==n._gaUserPrefs)return!0}catch(t){}return!1},At=function(t){O(t,100)},jt=function(t){var e=[],n=Nt[G][lt](";");t=new RegExp("^\\s*"+t+"=\\s*(.*?)\\s*$");for(var i=0;i<n[at];i++){var r=n[i][Z](t);r&&e[F](r[1])}return e},Pt=function(t,e,i,r,o,a){return(o=!$t(o)&&!(It[V](Nt[ct][ft])||"/"==i&&Rt[V](r)))&&(e&&1200<e[at]&&(e=e[yt](0,1200),n(24)),i=t+"="+e+"; path="+i+"; ",a&&(i+="expires="+new Date((new Date)[rt]()+a).toGMTString()+"; "),r&&"none"!=r&&(i+="domain="+r+";"),r=Nt[G],Nt.cookie=i,r!=Nt[G]||m(jt(t),e))},Rt=new RegExp(/^(www\.)?google(\.com?)?(\.[a-z]{2})?$/),It=new RegExp(/(^|\.)doubleclick\.net$/i),Ht=function(){for(var t=Et[_t],t=t.appName+t.version+t.platform+t.userAgent+(Nt[G]?Nt[G]:"")+(Nt.referrer?Nt.referrer:""),e=t[at],n=Et.history[at];n>0;)t+=n--^e++;return H(t)},Lt=function(){return h()+"//www.google-analytics.com"},zt=function(e){t(this,"len"),this.message=e+"-8192"},Ot=function(e){t(this,"ff2post"),this.message=e+"-2036"},qt=function(t,e){if(e=e||u,2036>=t[at])Ft(t,e);else{if(!(8192>=t[at]))throw new zt(t[at]);var n=e;if(0<=Et[_t].userAgent[Q]("Firefox")&&![].reduce)throw new Ot(t[at]);Vt(t,n)||Yt(t,n)||Bt(t,n)||n()}},Ft=function(t,e){var n=s(Lt()+"/collect?"+t);n.onload=n.onerror=function(){n.onload=null,n.onerror=null,e()}},Yt=function(t,e){var n;return!!(n=Et.XDomainRequest)&&(n=new n,n.open("POST",Lt()+"/collect"),n.onerror=function(){e()},n.onload=e,n[K](t),!0)},Vt=function(t,e){var n=Et.XMLHttpRequest;if(!n)return!1;var i=new n;return"withCredentials"in i&&(i.open("POST",Lt()+"/collect",!0),i.withCredentials=!0,i.setRequestHeader("Content-Type","text/plain"),i.onreadystatechange=function(){4==i.readyState&&(e(),i=null)},i[K](t),!0)},Bt=function(e,n){if(!Nt.body)return At(function(){Bt(e,n)}),!0;e=L(e);try{var i=Nt[et]('<iframe name="'+e+'"></iframe>')}catch(n){i=Nt[et]("iframe"),t(i,e)}i.height="0",i.width="0",i.style.display="none",i.style.visibility="hidden";var r=Nt[ct],r=Lt()+"/analytics_iframe.html#"+L(r[gt]+"//"+r[ot]+"/favicon.ico"),o=function(){i.src="",i[xt]&&i[xt].removeChild(i)};Tt(Et,"beforeunload",o);var a=!1,s=0,u=function(){if(!a){try{if(s>9||i.contentWindow[ct][ot]==Nt[ct][ot])return a=!0,o(),Ct(Et,"beforeunload",o),void n()}catch(t){}s++,O(u,200)}};return Tt(i,"load",u),Nt.body.appendChild(i),i.src=r,!0},Wt=function(){this.t=[]};Wt[st].add=function(t){this.t[F](t)},Wt[st].D=function(t){try{for(var e=0;e<this.t[at];e++){var n=t.get(this.t[e]);n&&i(n)&&n[pt](Et,t)}}catch(t){}e=t.get(me),e!=u&&i(e)&&(t.set(me,u,!0),O(e,10))};var Ut=function(){return q.round(2147483647*q.random())},Gt=function(){try{var t=new Uint32Array(1);return Et.crypto.getRandomValues(t),2147483647&t[0]}catch(t){return Ut()}},Xt=function(){this.data=new Dt},Qt=new Dt,Zt=[];Xt[st].get=function(t){var e=ie(t),n=this[U].get(t);return e&&void 0==n&&(n=i(e[J])?e[J]():e[J]),e&&e.n?e.n(this,t,n):n};var Jt=function(t,e){var n=t.get(e);return void 0==n?"":""+n},Kt=function(t,e){var n=t.get(e);return void 0==n||""===n?0:1*n};Xt[st].set=function(t,e,n){if(t)if("object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&ee(this,i,t[i],n);else ee(this,t,e,n)};var te,ee=function(t,e,n,i){if(void 0!=n)switch(e){case _n:ci[V](n)}var r=ie(e);r&&r.o?r.o(t,e,n,i):t[U].set(e,n,i)},ne=function(e,n,i,r,o){t(this,e),this.p=n,this.n=r,this.o=o,this.defaultValue=i},ie=function(t){var e=Qt.get(t);if(!e)for(var n=0;n<Zt[at];n++){var i=Zt[n],r=i[0].exec(t);if(r){e=i[1](r),Qt.set(e[it],e);break}}return e},re=function(t){var e;return Qt.map(function(n,i){i.p==t&&(e=i)}),e&&e[it]},oe=function(t,e,n,i,r){return t=new ne(t,e,n,i,r),Qt.set(t[it],t),t[it]},ae=function(t,e){Zt[F]([new RegExp("^"+t+"$"),e])},se=function(t,e,n){return oe(t,e,n,void 0,ue)},ue=function(){};if(te=o(z.GoogleAnalyticsObject)){var le=z.GoogleAnalyticsObject;te=le?le[W](/^[\s\xa0]+|[\s\xa0]+$/g,""):""}var ce=te||"ga",fe=!1,he=se("apiVersion","v"),de=se("clientVersion","_v");oe("anonymizeIp","aip");var pe=oe("adSenseId","a"),ge=oe("hitType","t"),me=oe("hitCallback"),ve=oe("hitPayload");oe("nonInteraction","ni"),oe("currencyCode","cu"),oe("sessionControl","sc",""),oe("queueTime","qt");var ye=oe("_s","_s");oe("screenName","cd");var be=oe("location","dl",""),we=oe("referrer","dr"),_e=oe("page","dp","");oe("hostname","dh");var xe=oe("language","ul"),ke=oe("encoding","de");oe("title","dt",function(){return Nt.title||void 0}),ae("contentGroup([0-9]+)",function(t){return new ne(t[0],"cg"+t[1])});var Me=oe("screenColors","sd"),Se=oe("screenResolution","sr"),Te=oe("viewportSize","vp"),Ce=oe("javaEnabled","je"),De=oe("flashVersion","fl");oe("campaignId","ci"),oe("campaignName","cn"),oe("campaignSource","cs"),oe("campaignMedium","cm"),oe("campaignKeyword","ck"),oe("campaignContent","cc");var Ee=oe("eventCategory","ec"),Ne=oe("eventAction","ea"),$e=oe("eventLabel","el"),Ae=oe("eventValue","ev"),je=oe("socialNetwork","sn"),Pe=oe("socialAction","sa"),Re=oe("socialTarget","st"),Ie=oe("l1","plt"),He=oe("l2","pdt"),Le=oe("l3","dns"),ze=oe("l4","rrt"),Oe=oe("l5","srt"),qe=oe("l6","tcp"),Fe=oe("l7","dit"),Ye=oe("l8","clt"),Ve=oe("timingCategory","utc"),Be=oe("timingVar","utv"),We=oe("timingLabel","utl"),Ue=oe("timingValue","utt");oe("appName","an"),oe("appVersion","av",""),oe("appId","aid",""),oe("appInstallerId","aiid",""),oe("exDescription","exd"),oe("exFatal","exf");var Ge=oe("expId","xid"),Xe=oe("expVar","xvar"),Qe=oe("_utma","_utma"),Ze=oe("_utmz","_utmz"),Je=oe("_utmht","_utmht"),Ke=oe("_hc",void 0,0),tn=oe("_ti",void 0,0),en=oe("_to",void 0,20);ae("dimension([0-9]+)",function(t){return new ne(t[0],"cd"+t[1])}),ae("metric([0-9]+)",function(t){return new ne(t[0],"cm"+t[1])}),oe("linkerParam",void 0,void 0,$,ue);var nn=oe("usage","_u",void 0,function(){return St.M()},ue);oe("forceSSL",void 0,void 0,function(){return fe},function(t,e,i){n(34),fe=!!i});var rn=oe("_j1","jid");oe("_j2","gjid"),ae("\\&(.*)",function(t){var e=new ne(t[0],t[1]),n=re(t[0][yt](1));return n&&(e.n=function(t){return t.get(n)},e.o=function(t,e,i,r){t.set(n,i,r)},e.p=void 0),e});var on=se("_oot"),an=oe("previewTask"),sn=oe("checkProtocolTask"),un=oe("validationTask"),ln=oe("checkStorageTask"),cn=oe("historyImportTask"),fn=oe("samplerTask"),hn=se("_rlt"),dn=oe("buildHitTask"),pn=oe("sendHitTask"),gn=oe("ceTask"),mn=oe("devIdTask"),vn=oe("timingTask"),yn=se("name"),bn=se("clientId","cid"),wn=oe("userId","uid"),_n=se("trackingId","tid"),xn=se("cookieName",void 0,"_ga"),kn=se("cookieDomain"),Mn=se("cookiePath",void 0,"/"),Sn=se("cookieExpires",void 0,63072e3),Tn=se("legacyCookieDomain"),Cn=se("legacyHistoryImport",void 0,!0),Dn=se("storage",void 0,"cookie"),En=se("allowLinker",void 0,!1),Nn=se("allowAnchor",void 0,!0),$n=se("sampleRate","sf",100),An=se("siteSpeedSampleRate",void 0,1),jn=se("alwaysSendReferrer",void 0,!1),Pn=function(t){var e=ei;return e.fa&&e.$?0:(e.$=!0,0==e.V?0:(void 0===t&&(t=Gt()),0==t%e.V?q.floor(t/e.V)%e.ea+1:0))},Rn=function(t,e){var n=q.min(Kt(t,An),100);if(!(H(Jt(t,bn))%100>=n)&&(n={},In(n)||Hn(n))){var i=n[Ie];void 0==i||1/0==i||isNaN(i)||(i>0?(Ln(n,Le),Ln(n,qe),Ln(n,Oe),Ln(n,He),Ln(n,ze),Ln(n,Fe),Ln(n,Ye),e(n)):Tt(Et,"load",function(){Rn(t,e)},!1))}},In=function(t){var e=Et.performance||Et.webkitPerformance,e=e&&e.timing;if(!e)return!1;var n=e.navigationStart;return 0!=n&&(t[Ie]=e.loadEventStart-n,t[Le]=e.domainLookupEnd-e.domainLookupStart,t[qe]=e.connectEnd-e.connectStart,t[Oe]=e.responseStart-e.requestStart,t[He]=e.responseEnd-e.responseStart,t[ze]=e.fetchStart-n,t[Fe]=e.domInteractive-n,t[Ye]=e.domContentLoadedEventStart-n,!0)},Hn=function(t){if(Et.top!=Et)return!1;var e=Et.external,n=e&&e.onloadT;return e&&!e.isValidLoadTime&&(n=void 0),n>2147483648&&(n=void 0),n>0&&e.setPageReadyTime(),void 0!=n&&(t[Ie]=n,!0)},Ln=function(t,e){var n=t[e];(isNaN(n)||1/0==n||0>n)&&(t[e]=void 0)},zn=function(t){return function(e){"pageview"!=e.get(ge)||t.I||(t.I=!0,Rn(e,function(e){t[K]("timing",e)}))}},On=!1,qn=function(t){if("cookie"==Jt(t,Dn)){var e=Jt(t,xn),i=Vn(t),r=Gn(Jt(t,Mn)),o=Wn(Jt(t,kn)),a=1e3*Kt(t,Sn),s=Jt(t,_n);if("auto"!=o)Pt(e,i,r,o,s,a)&&(On=!0);else{n(32);var u;if(i=[],o=d()[lt]("."),4!=o[at]||(u=o[o[at]-1],parseInt(u,10)!=u)){for(u=o[at]-2;u>=0;u--)i[F](o[B](u)[kt]("."));i[F]("none"),u=i}else u=["none"];for(var l=0;l<u[at];l++)if(o=u[l],t[U].set(kn,o),i=Vn(t),Pt(e,i,r,o,s,a))return 1==Un(o)&&n(36),"none"==o&&n(37),void(On=!0);t[U].set(kn,"auto")}}},Fn=function(t){if("cookie"==Jt(t,Dn)&&!On&&(qn(t),!On))throw"abort"},Yn=function(t){if(t.get(Cn)){var e=Jt(t,kn),i=Jt(t,Tn)||d(),r=E("__utma",i,e);r&&(n(19),t.set(Je,(new Date)[rt](),!0),t.set(Qe,r.R),(e=E("__utmz",i,e))&&r[Y]==e[Y]&&t.set(Ze,e.R))}},Vn=function(t){var e=c(Jt(t,bn)),n=Un(Jt(t,kn));return t=Xn(Jt(t,Mn)),t>1&&(n+="-"+t),["GA1",n,e][kt](".")},Bn=function(t,e,n){for(var i,r=[],o=[],a=0;a<t[at];a++){var s=t[a];s.r[n]==e?r[F](s):void 0==i||s.r[n]<i?(o=[s],i=s.r[n]):s.r[n]==i&&o[F](s)}return 0<r[at]?r:o},Wn=function(t){return 0==t[Q](".")?t.substr(1):t},Un=function(t){return Wn(t)[lt](".")[at]},Gn=function(t){return t?(1<t[at]&&t.lastIndexOf("/")==t[at]-1&&(t=t.substr(0,t[at]-1)),0!=t[Q]("/")&&(t="/"+t),t):"/"},Xn=function(t){return t=Gn(t),"/"==t?1:t[lt]("/")[at]},Qn=new RegExp(/^https?:\/\/([^\/:]+)/),Zn=/(.*)([?&#])(?:_ga=[^&#]*)(?:&?)(.*)/,Jn=function(t){this.target=t,this.T=!1};Jn[st].Q=function(t,n){if(t.tagName){if("a"==t.tagName[Mt]())return void(t[vt]&&e(t,Kn(this,t[vt],n)));if("form"==t.tagName[Mt]())return ti(this,t)}return"string"==typeof t?Kn(this,t,n):void 0};var Kn=function(t,e,n){var i=Zn.exec(e);i&&3<=i[at]&&(e=i[1]+(i[3]?i[2]+i[3]:"")),t=t[dt].get("linkerParam");var r=e[Q]("?"),i=e[Q]("#");return n?e+=(-1==i?"#":"&")+t:(n=-1==r?"?":"&",e=-1==i?e+(n+t):e[yt](0,i)+n+t+e[yt](i)),e},ti=function(t,e){if(e&&e[bt]){var n=t[dt].get("linkerParam")[lt]("=")[1];if("get"==e.method[Mt]()){for(var i=e.childNodes||[],r=0;r<i[at];r++)if("_ga"==i[r][it])return void i[r][nt]("value",n);i=Nt[et]("input"),i[nt]("type","hidden"),i[nt]("name","_ga"),i[nt]("value",n),e.appendChild(i)}else"post"==e.method[Mt]()&&(e.action=Kn(t,e[bt]))}};Jn[st].S=function(t,i,r){function o(t){try{t=t||Et.event;var r;t:{var o=t[dt]||t.srcElement;for(t=100;o&&t>0;){if(o[vt]&&o.nodeName[Z](/^a(?:rea)?$/i)){r=o;break t}o=o[xt],t--}r={}}("http:"==r[gt]||"https:"==r[gt])&&j(s,r[ft]||"")&&r[vt]&&e(r,Kn(a,r[vt],i))}catch(s){n(26)}}var a=this;if(this.T||(this.T=!0,Tt(Nt,"mousedown",o,!1),Tt(Nt,"touchstart",o,!1),Tt(Nt,"keyup",o,!1)),r){r=function(e){if(e=e||Et.event,(e=e[dt]||e.srcElement)&&e[bt]){var n=e[bt][Z](Qn);n&&j(t,n[1])&&ti(a,e)}};for(var s=0;s<Nt.forms[at];s++)Tt(Nt.forms[s],"submit",r)}};var ei,ni,ii=function(t,e,n){var i=this;this.U=rn,this.aa=e,this.Y=n||oi(t);var r=t.get(dn);t.set(dn,function(t){t.get(i.U)||("1"==jt(i.Y)[0]?t.set(i.U,"",!0):t.set(i.U,""+Ut(),!0));var e=r(t);return t.get(i.U)&&Pt(i.Y,"1",t.get(Mn),t.get(kn),t.get(_n),6e5),e});var o=t.get(pn);t.set(pn,function(t){var e=o(t);return ri(i,t),e})},ri=function(t,e){if(e.get(t.U)){var n=new Dt,i=function(t){n.set(ie(t).p,e.get(t))};i(he),i(de),i(_n),i(bn),i(t.U),i(nn);var r=t.aa;"/"===r[X](0)&&(r=h()+r),n.map(function(t,e){r+=l(t)+"="+l(""+e)+"&"}),r+="z="+Ut(),s(r),e.set(t.U,"",!0)}},oi=function(t){return t.get(yn)&&"t0"!=t.get(yn)?"_dc_"+c(t.get(yn)):"_dc"};ei=new function(){this.V=100,this.fa=void 0,this.$=!1,this.ea=1},ni=!1;var ai,si=function(t,e){var i=t.b;if(!i.get("dcLoaded")){n(29),e=e||{};var r;e[xn]&&(r=c(e[xn]));var o="//stats.g.doubleclick.net/collect?t=dc&aip=1&";if("https:"!=Nt[ct][gt]&&!fe){var a=H(i.get(bn));(ni||Pn(a))&&(o="https:"+o,n(33),ni=!0)}new ii(i,o,r),i.set("dcLoaded",!0)}},ui=function(){n(38)},li=function(t,e,n){if(!ai){var i;i=Nt[ct][Y];var r=Et[it],o=/^#?gaso=([^&]*)/;(r=(i=(i=i&&i[Z](o)||r&&r[Z](o))?i[1]:jt("GASO")[0]||"")&&i[Z](/^(?:!([-0-9a-z.]{1,40})!)?([-.\w]{10,1200})$/i))&&(Pt("GASO",""+i,n,e,t,0),z._udo||(z._udo=e),z._utcp||(z._utcp=n),t=r[1],f("https://www.google.com/analytics/web/inpage/pub/inpage.js?"+(t?"prefix="+t+"&":"")+Ut(),"_gasojs")),
ai=!0}},ci=/^(UA|YT|MO|GP)-(\d+)-(\d+)$/,fi=function(t){function e(t,e){i.b[U].set(t,e)}function n(t,n){e(t,n),i.filters.add(t)}var i=this;this.b=new Xt,this.filters=new Wt,e(yn,t[yn]),e(_n,t[_n]),e(xn,t[xn]),e(kn,t[kn]||d()),e(Mn,t[Mn]),e(Sn,t[Sn]),e(Tn,t[Tn]),e(Cn,t[Cn]),e(En,t[En]),e(Nn,t[Nn]),e($n,t[$n]),e(An,t[An]),e(jn,t[jn]),e(Dn,t[Dn]),e(wn,t[wn]),e(he,1),e(de,"j22"),n(on,y),n(an,k),n(sn,b),n(un,S),n(ln,Fn),n(cn,Yn),n(fn,v),n(hn,T),n(gn,x),n(mn,M),n(dn,w),n(pn,_),n(vn,zn(this)),hi(this.b,t[bn]),di(this.b),this.b.set(pe,P()),li(this.b.get(_n),this.b.get(kn),this.b.get(Mn))},hi=function(t,e){if("cookie"==Jt(t,Dn)){On=!1;var i;t:{var r=jt(Jt(t,xn));if(r&&!(1>r[at])){i=[];for(var o=0;o<r[at];o++){var a;a=r[o][lt](".");var s=a.shift();("GA1"==s||"1"==s)&&1<a[at]?(s=a.shift()[lt]("-"),1==s[at]&&(s[1]="1"),s[0]*=1,s[1]*=1,a={r:s,s:a[kt](".")}):a=void 0,a&&i[F](a)}if(1==i[at]){n(13),i=i[0].s;break t}if(0!=i[at]){if(n(14),r=Un(Jt(t,kn)),i=Bn(i,r,0),1==i[at]){i=i[0].s;break t}r=Xn(Jt(t,Mn)),i=Bn(i,r,1),i=i[0]&&i[0].s;break t}n(12)}i=void 0}i||(i=Jt(t,kn),r=Jt(t,Tn)||d(),i=E("__utma",r,i),(i=void 0==i?void 0:i.O[1]+"."+i.O[2])&&n(10)),i&&(t[U].set(bn,i),On=!0)}i=t.get(Nn),(o=(i=Nt[ct][i?"href":"search"][Z]("(?:&|#|\\?)"+l("_ga")[W](/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")+"=([^&#]*)"))&&2==i[at]?i[1]:"")&&(t.get(En)?(i=o[Q]("."),-1==i?n(22):(r=o[yt](i+1),"1"!=o[yt](0,i)?n(22):(i=r[Q]("."),-1==i?n(22):(o=r[yt](0,i),i=r[yt](i+1),o!=A(i,0)&&o!=A(i,-1)&&o!=A(i,-2)?n(23):(n(11),t[U].set(bn,i)))))):n(21)),e&&(n(9),t[U].set(bn,l(e))),t.get(bn)||((i=(i=Et.gaGlobal&&Et.gaGlobal.vid)&&-1!=i[ht](/^(?:utma\.)?\d+\.\d+$/)?i:void 0)?(n(17),t[U].set(bn,i)):(n(8),t[U].set(bn,[Ut()^2147483647&Ht(),q.round((new Date)[rt]()/1e3)][kt](".")))),qn(t)},di=function(t){var e=Et[_t],i=Et.screen,r=Nt[ct];if(t.set(we,p(t.get(jn))),r){var o=r.pathname||"";"/"!=o[X](0)&&(n(31),o="/"+o),t.set(be,r[gt]+"//"+r[ft]+o+r[ht])}i&&t.set(Se,i.width+"x"+i.height),i&&t.set(Me,i.colorDepth+"-bit");var i=Nt.documentElement,s=(o=Nt.body)&&o[ut]&&o[mt],u=[];if(i&&i[ut]&&i[mt]&&("CSS1Compat"===Nt.compatMode||!s)?u=[i[ut],i[mt]]:s&&(u=[o[ut],o[mt]]),i=0>=u[0]||0>=u[1]?"":u[kt]("x"),t.set(Te,i),t.set(De,D()),t.set(ke,Nt.characterSet||Nt.charset),t.set(Ce,e&&"function"==typeof e.javaEnabled&&e.javaEnabled()||!1),t.set(xe,(e&&(e.language||e.browserLanguage)||"")[Mt]()),r&&t.get(Nn)&&(e=Nt[ct][Y])){for(e=e[lt](/[?&#]+/),r=[],i=0;i<e[at];++i)(a(e[i],"utm_id")||a(e[i],"utm_campaign")||a(e[i],"utm_source")||a(e[i],"utm_medium")||a(e[i],"utm_term")||a(e[i],"utm_content")||a(e[i],"gclid")||a(e[i],"dclid")||a(e[i],"gclsrc"))&&r[F](e[i]);0<r[at]&&(e="#"+r[kt]("&"),t.set(be,t.get(be)+e))}};fi[st].get=function(t){return this.b.get(t)},fi[st].set=function(t,e){this.b.set(t,e)};var pi={pageview:[_e],event:[Ee,Ne,$e,Ae],social:[je,Pe,Re],timing:[Ve,Be,Ue,We]};fi[st].send=function(t){if(!(1>arguments[at])){var e,n;"string"==typeof arguments[0]?(e=arguments[0],n=[][B][pt](arguments,1)):(e=arguments[0]&&arguments[0][ge],n=arguments),e&&(n=g(pi[e]||[],n),n[ge]=e,this.b.set(n,void 0,!0),this.filters.D(this.b),this.b[U].m={})}};var gi=function(t){return"prerender"!=Nt.visibilityState&&(t(),!0)},mi=/^(?:(\w+)\.)?(?:(\w+):)?(\w+)$/,vi=function(t){if(i(t[0]))this.u=t[0];else{var e=mi.exec(t[0]);if(null!=e&&4==e[at]&&(this.c=e[1]||"t0",this.e=e[2]||"",this.d=e[3],this.a=[][B][pt](t,1),this.e||(this.A="create"==this.d,this.i="require"==this.d,this.g="provide"==this.d,this.ba="remove"==this.d),this.i&&(3<=this.a[at]?(this.X=this.a[1],this.W=this.a[2]):this.a[1]&&(o(this.a[1])?this.X=this.a[1]:this.W=this.a[1]))),e=t[1],t=t[2],!this.d)throw"abort";if(this.i&&(!o(e)||""==e))throw"abort";if(this.g&&(!o(e)||""==e||!i(t)))throw"abort";if(R(this.c)||R(this.e))throw"abort";if(this.g&&"t0"!=this.c)throw"abort"}},yi={F:"/plugins/ua/",H:"plugins_",ca:["ec","ecommerce","linkid"],ga:function(){yi.f=[],yi.k=new Dt,yi.Z=new Dt}};yi.ga(),yi.B=function(t,e,r){e==bi?n(35):e.get(yn);var o=yi.k.get(t);return!!i(o)&&(e[yi.H]=e[yi.H]||new Dt,!!e[yi.H].get(t)||(e[yi.H].set(t,new o(e,r||{})),!0))},yi.da=function(t){var e=t.a[0];if(!i(yi.k.get(e))&&!yi.Z.get(e)&&(t=t.X,!t&&m(yi.ca,e)?(n(39),t=e+".js"):n(43),t)){t&&0<=t[Q]("/")||(t=h()+"//www.google-analytics.com"+yi.F+t),t=I(t);var r=t[gt],o=Nt[ct][gt];(r="https:"==r||r==o||"http:"==r&&"http:"==o)&&(r=I(Nt[ct][vt]),t.G||0<=t.url[Q]("?")||0<=t.path[Q]("://")?r=!1:t[ot]==r[ot]&&t[tt]==r[tt]?r=!0:(r="http:"==t[gt]?80:443,r=!("www.google-analytics.com"!=t[ot]||(t[tt]||r)!=r||!a(t.path,"/plugins/")))),r&&(f(t.url),yi.Z.set(e,!0))}},yi.C=function(t,e){yi.k.set(t,e)},yi.D=function(t){var e=yi.J[wt](yi,arguments),e=yi.f.concat(e);for(yi.f=[];0<e[at]&&!yi.v(e[0])&&(e.shift(),!(0<yi.f[at])););yi.f=yi.f.concat(e)},yi.J=function(t){for(var e=[],n=0;n<arguments[at];n++)try{var i=new vi(arguments[n]);i.g?yi.C(i.a[0],i.a[1]):(i.i&&yi.da(i),e[F](i))}catch(t){}return e},yi.v=function(t){try{if(t.u)t.u[pt](Et,bi.j("t0"));else{var e=t.c==ce?bi:bi.j(t.c);if(t.A)"t0"==t.c&&bi.create[wt](bi,t.a);else if(t.ba)bi.remove(t.c);else if(e)if(t.i){if(!yi.B(t.a[0],e,t.W))return!0}else t.e&&(e=e[yi.H].get(t.e)),e[t.d][wt](e,t.a)}}catch(t){}};var bi=function(t){n(1),yi.D[wt](yi,[arguments])};bi.h={},bi.P=[],bi.L=0,bi.answer=42;var wi=[_n,kn,yn];bi.create=function(t){var e=g(wi,[][B][pt](arguments));e[yn]||(e[yn]="t0");var n=""+e[yn];return bi.h[n]?bi.h[n]:(e=new fi(e),bi.h[n]=e,bi.P[F](e),e)},bi.remove=function(t){for(var e=0;e<bi.P[at];e++)if(bi.P[e].get(yn)==t){bi.P.splice(e,1),bi.h[t]=null;break}},bi.j=function(t){return bi.h[t]},bi.K=function(){return bi.P[B](0)},bi.N=function(){var t=Et[ce];if(!t||42!=t.answer){bi.L=t&&t.l,bi.loaded=!0;var e=Et[ce]=bi;C("create",e,e.create,3),C("remove",e,e.remove),C("getByName",e,e.j,5),C("getAll",e,e.K,6),e=fi[st],C("get",e,e.get,7),C("set",e,e.set,4),C("send",e,e[K],2),e=Xt[st],C("get",e,e.get),C("set",e,e.set),(Et.gaplugins=Et.gaplugins||{}).Linker=Jn,e=Jn[st],yi.C("linker",Jn),C("decorate",e,e.Q,20),C("autoLink",e,e.S,25),yi.C("displayfeatures",si),yi.C("adfeatures",ui),t=t&&t.q,r(t)&&yi.D[wt](bi,t)}},function(){var t=bi.N;if(!gi(t)){n(16);var e=!1,i=function(){!e&&gi(t)&&(e=!0,Ct(Nt,"visibilitychange",i))};Tt(Nt,"visibilitychange",i)}}()}(window),define("ga",function(t){return function(){var e;return e||t.ga}}(this)),define("global",["jquery","underscore","backbone","d3","ga"],function(t,e,n,i,r){var o={appVersion:"v1.82",router:null,config:{sortType:"sort_by_date_start",sortDesc:!1,hideCompleted:!0,hideCompletedDepth:"contract",infoPanelWidth:300,infoPanelButtonWidth:30,local:0,searchDelay:500},initialize:function(){this.events=e.extend({},n.Events),this.initDimensions(),this.initBackend(),this.initD3(),this.initTimescale(),this.initGA();var i=this;o.events.on("data-ready",function(){t(window).resize(i.onResize)}),t(window).scroll(this.onScroll),o.events.on("userid:usermodel",function(t){o.currentUser=t})},initDimensions:function(){this.config.margin={top:147,right:0,bottom:50,left:5},this.config.width=t(window).width()-this.config.margin.left-this.config.margin.right,this.config.height=t(window).height()-this.config.margin.top-this.config.margin.bottom-6},initBackend:function(){this.config.api_url="/timeline/api",this.config.data_url=this.config.api_url+"/get_data",this.config.user_id_url=this.config.api_url+"/get_user_id",this.config.materials_by_work_url=this.config.api_url+"/get_materials_by_work",this.config.materials_by_workorder_url=this.config.api_url+"/get_materials_by_workorder",this.config.stats_url=this.config.api_url+"/sectors",this.config.brief_url="/brief#",this.config.caching=!1,this.config.cacheVersion=this.appVersion},initD3:function(){var e=this;t(document).mouseup(function(t){e.config.duration=t.altKey?e.config.durationSlow:e.config.durationNormal}),this.config.durationNormal=300,this.config.durationSlow=5e3,this.config.durationFast=100,this.config.duration=this.config.durationNormal,this.config.treeDepthPadding=20,this.config.treeOpacity=.9,this.config.nodeWidth=100,this.config.nodeWidthMin=100,this.config.nodeWidthMax=270,this.config.timelinePadding=1,this.config.timelinePlanHeight=5,this.config.timelineContractPlanHeight=4,this.config.timelineFactHeight=42,this.config.nodePadding=15,this.config.nodeHeight=this.config.timelinePlanHeight+this.config.timelineFactHeight+this.config.timelinePadding,this.config.nodeRadius=5,this.config.nodeToggleOpacity=.2,this.config.planShiftCurveHeight=10,this.config.planShiftDotRadius=5,this.config.planShiftArrowWidth=6,this.config.planShiftArrowHeight=7,this.config.axis={},this.config.axis.height=45,this.config.axis.ticks={longDays:240,shortDays:112,weeks:40,months:0}},initTimescale:function(){var t=new Date,e=1.5,n=o.config.width/(this.config.axis.ticks.shortDays/7)/e;this.timeScale=i.time.scale().domain([i.time.day.offset(t,-.6*n),i.time.day.offset(t,.4*n)]).rangeRound([0,o.config.width])},initGA:function(){o.events.on("userid:usermodel",function(t){r("create",{trackingId:"UA-51630738-1",cookieDomain:"int-modul.herokuapp.com",userId:t}),r("set","dimension1",t),r("send","pageview")})},onResize:function(){o.initDimensions(),o.timeScale.rangeRound([0,o.config.width]),o.events.trigger("resize","resize")},onScroll:function(){o.events.trigger("scroll")},utils:{treeToNodes:function(t,e){if(t.all_nodes)return t.all_nodes;e||(e=[]);var n=[];return n.push(t),t.nodes&&t.nodes.forEach(function(t){n=o.utils.treeToNodes(t,n)}),t.all_nodes=n,e=e.concat(n)},daysToPixels:function(t,e){var n=new Date;return e=e||o.timeScale,e(i.time.day.offset(n,t))-e(n)},dayStringToDate:function(t){var e=new Date(t);return new Date(e.getTime()+6e4*e.getTimezoneOffset())},dateWithinRange:function(t,n){return e.first(n)<=t&&t<=e.last(n)},extentDate:function(t,e){var n=[t&&t.start,e&&e.start],r=[t&&t.finish,e&&e.finish];return{start:i.min(n),finish:i.max(r)}},cloneDates:function(t){return{start:new Date(t.start),finish:new Date(t.finish)}},flattenIntervals:function(t){e.forEach(t,function(n,i){if(0!==n.length){var r=e.flatten(n).sort(function(t,e){return t.start-e.start}),o=r[0];t[i]=[o],r.slice(1).forEach(function(e){e.start-o.finish<=864e5?o.finish<e.finish&&(o.finish=e.finish):(o=e,t[i].push(o))})}})},getMaxHeight:function(e){return Math.max(t(window).height(),e.getD3Data().nodes.length*(o.config.nodeHeight+o.config.nodePadding))+o.config.margin.top+o.config.margin.bottom},pluralForm:function(t,e,n){var i="";return(!n||n.neat&&1!==t)&&(i+=t+" "),t=Math.abs(t),i+=e[t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2]},sortOrderNames:function(t,e){for(var n=t.split(/(\d+)/).slice(1,-1),i=e.split(/(\d+)/).slice(1,-1),r=0,o=n.length;o>r;r++)if(n[r]!==i[r])return n[r].match(/\d/)?+n[r]-+i[r]:n[r].localeCompare(i[r]);return 0},logException:function(t){t.name?(console.log(t.name+": "+t.message),console.log(t.stack)):console.log(t)},dummy:null}};return o.initialize(),o}),define("scrollhelper",["underscore","global"],function(t,e){var n={pointToNode:function(n,i){var r=e.appView.model.expandToNode(n),o=this.scrollToNode(n.replace(/\/+$/,""));i&&t.delay(i,r||o?e.config.duration+299:0)},scrollToNode:function(n){var i=e.appView.model.getD3Data(),r=e.appView.model.getNodeById(n);if(r){var o,a,s=i.yScale(r.i),u=window.scrollY,l=u+e.config.height-e.config.nodeHeight;return o=a=u,(u>s||s>l)&&(a=u>s?s:s-(l-u)+e.config.nodeHeight,t.defer(function(){$("html,html>body").animate({scrollTop:a},e.config.duration)})),a-o}},dummy:null};return n}),define("workstatushelper",["underscore","d3","global"],function(t,e,n){var i={settings:{on_work_with_reject:{y:.2*n.config.timelineFactHeight,selector:"work_with_reject"},on_hold:{y:.6*n.config.timelineFactHeight,selector:"holds"},on_pause:{y:.4*n.config.timelineFactHeight,selector:"pauses"},no_data:{y:.2*n.config.timelineFactHeight,selector:"nodata"}},hasStatus:function(e,i){return e.cache_has_status&&e.cache_has_status[i]?e.cache_has_status[i]:(e.cache_has_status||(e.cache_has_status={}),"no_data"===i?(e.cache_has_status[i]=this.hasStatusNoData(e),e.cache_has_status[i]):(e.cache_has_status[i]=t.any(n.utils.treeToNodes(e),function(e){var n={};return t.forEach(e.status_log||[],function(t){n[t.date]=t.status}),t.any(n,function(t){return t===i})}),e.cache_has_status[i]))},getTodayOffsetBy10am:function(t){var n=new Date;return e.time.day.offset(e.time.day(n),n.getHours()<10?t-1:t)},hasStatusNoData:function(i){var r=this.getTodayOffsetBy10am(0),o=this.getTodayOffsetBy10am(-1),a=(this.getTodayOffsetBy10am(1),function(i){if("work"==i.node_type&&i.no_need_facts&&(i.status_log&&"completed"==t.last(i.status_log).status||i.dateRange&&i.dateRange.plan&&r<=i.dateRange.plan.finish))return!1;if(i.done||i.status_log&&"on_work"!==t.last(i.status_log).status&&"on_work_with_reject"!==t.last(i.status_log).status)return!1;if(i.status_log&&"on_work_with_reject"==t.last(i.status_log).status&&o<=new Date(t.last(i.status_log).date))return!1;if(i.dateRange){if(!i.dateRange.plan||r<=i.dateRange.plan.start)return!1}else if("work"===i.node_type&&(!i.plan||r<=n.utils.dayStringToDate(i.plan.start)))return!1;if("work"!==i.node_type)return t.any(i.nodes,a);if(i.dateRange){if(i.dateRange.fact&&i.dateRange.fact.finish>=o)return!1}else if(i.nodes){var s=i.nodes.reduce(function(t,e){var i=n.utils.dayStringToDate(e.fact.date);return(!t||i>t)&&(t=i),t},null);if(s>=o)return!1}if(i.status_log){var u=t.last(i.status_log);if(("on_work"===u.status||"on_work_with_reject"===u.status)&&e.time.day(new Date(u.date))>=o)return!1}return!0});return a(i)},getDaysWithStatus:function(i,r){if("no_data"===r)return this.getDaysWithStatusNoData(i);var o=e.time.day.offset(e.time.day(new Date),1),a=[],s=function(t){var i,a=!1,s=[];return t.forEach("on_work_with_reject"==r?function(t){t.status===r&&(a=!0,s.push(n.utils.dayStringToDate(t.date)))}:function(t){a===!1?t.status===r&&(a=!0,i=n.utils.dayStringToDate(t.date)):t.status!==r&&(a=!1,s=s.concat(e.time.days(i,n.utils.dayStringToDate(t.date))),i=null)}),i&&(s=s.concat("on_work_with_reject"!=r?e.time.days(i,o):e.time.days(i,e.time.day.offset(e.time.day(i),1)))),s};if(i.status_log)a=s(i.status_log);else{var u={};n.utils.treeToNodes(i).slice(1).forEach(function(t){t.status_log&&s(t.status_log).forEach(function(t){u[+t]=t})}),a=t.keys(u).sort().map(function(t){return u[t]})}return a},getDaysWithStatusNoData:function(n){if(n.cache_dayswithstatusnodata)return n.cache_dayswithstatusnodata;var i,r=this,o=this.getTodayOffsetBy10am(0);return this.hasStatusNoData(n)&&(i=function a(n){return r.hasStatusNoData(n)?"work"!==n.node_type?t.min(t.map(n.nodes,a)):e.max([n.dateRange.plan&&n.dateRange.plan.start,n.dateRange.fact&&e.time.day.offset(n.dateRange.fact.finish,1),n.status_log&&("on_work"===t.last(n.status_log).status||"on_work_with_reject"===t.last(n.status_log).status)&&e.time.day(new Date(t.last(n.status_log).date))]):void 0}(n)),n.cache_dayswithstatusnodata=e.time.days(i,o),n.cache_dayswithstatusnodata},getInfoAboutStatus:function(t,e,n){if(e){var i=this,r=+e;if("no_data"===n)return this.getInfoAboutStatusNoData(t,r);if(t.status_log){var o=this.getLastStatusOnDate(t,r);return o&&o.status===n?{last_status:o}:void 0}t._info_about_statuses_inside||(t._info_about_statuses_inside={}),t._info_about_statuses_inside[r]||(t._info_about_statuses_inside[r]={}),t._info_about_statuses_inside[r][n]||(t._info_about_statuses_inside[r][n]=i.calculateStatusesInside(t,r,n));var a=t._info_about_statuses_inside[r][n];return a?{inside:a}:void 0}},getInfoAboutStatusNoData:function(n,i){var r,o,a=this,s=+i,u=[],l=function(n){if("work"!==n.node_type)t.forEach(n.nodes,l);else{var i=a.getDaysWithStatusNoData(n);r=e.min(i.concat(r)),t.any(i,function(t){return+t===s})&&u.push(n)}};return l(n),u.length&&(o={from_date:r},"work"!==n.node_type&&(o.inside=u.length)),o},calculateStatusesInside:function(e,n,i){var r=this,o=0;return e.status_log?o=t.any(r.getDaysWithStatus(e,i),function(t){return+t===n})?1:0:e.nodes&&(o=e.nodes.reduce(function(t,e){return t+r.calculateStatusesInside(e,n,i)},0)),o},calculateWorksWithStatus:function(e,n){var i=this,r=0;return this.hasStatus(e,n)&&(r="work"===e.node_type?this.hasStatus(e,n)?1:0:t.reduce(e.nodes,function(t,e){return t+i.calculateWorksWithStatus(e,n)},0)),r},getWorksWithStatus:function(e,i){var r=this,o=[];return this.hasStatus(e,i)&&(o="work"===e.node_type?t.reduce(n.utils.treeToNodes(e),function(e,n){return t.forEach(n.status_log||[],function(t){t.status==i&&e.push(t)}),e},o):t.reduce(e.nodes,function(t,e){return t.concat(r.getWorksWithStatus(e,i))},[])),o},drawStatuses:function(t,e,i){var r=t.datum(),o=this.settings[i].selector,a=t.selectAll("."+o).data([r]);n.appView.viewMenuItemsCollection.isVisible("statuses")&&this.hasStatus(r,i)?(a.enter().append("g").attr("class",o).style("opacity",1e-6).attr("transform","translate(0, "+(n.config.timelinePlanHeight+n.config.timelinePadding)+")"),e(a.call(function(t,n){var r=n.getDaysWithStatus(t.datum(),i);n.d3_drawLines(t,n,r,e,i),n.d3_drawBadges(t,n,r,e,i)},this)).style("opacity",void 0)):e(a).style("opacity",1e-6).remove()},d3_drawLines:function(t,i,r,o,a){var s,u=function(t){return n.timeScale(t)+n.utils.daysToPixels(1)/2},l=[],c=r[0],f=r[0];r.forEach(function(t){+f!==+t&&(l.push([c,s]),c=f=t),s=t,f=e.time.day.offset(f,1)}),l.push([c,s]);var h=t.selectAll(".line").data(l);h.enter().append("line").attr("class","line"),o(h).attr("y1",i.settings[a].y).attr("y2",i.settings[a].y).attr("x1",function(t){return u(t[0])}).attr("x2",function(t){return u(t[1])}),o(h.exit()).style("opacity",1e-6).remove()},d3_drawBadges:function(t,e,i,r,o){var a=2.5,s=function(t){return"translate("+(n.timeScale(t)+n.utils.daysToPixels(1)/2)+", "+e.settings[o].y+")"},u=t.selectAll(".badge").data(i,function(t){return+t});u.enter().append("circle").attr("class","badge").classed("key",function(n){return e.isKeyStatusOnDate(t.datum(),o,n)}).style("opacity",1e-6).attr("data-timestamp",function(t){return+t}).attr("r",a).attr("transform",s),r(u).style("opacity",void 0).attr("transform",s),r(u.exit()).style("opacity",1e-6).remove()},isKeyStatusOnDate:function(e,i,r){return t.any(e.status_log,function(t){return t.status===i&&+n.utils.dayStringToDate(t.date)===+r})},getLastStatusOnDate:function(e,i){var r;return t.forEach(e.status_log,function(t){return+n.utils.dayStringToDate(t.date)<=i&&void(r=t)}),r},dummy:null};return i}),define("selectorhelper",["underscore","workstatushelper"],function(t,e){var n={selectors:{},methods:{contract:function(e,n){e.nodes=t.filter(e.nodes,function(t){return n.indexOf(""+t.name)>-1})},order:function(e,n){e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(t){return n.indexOf(t.name)>-1}),e.nodes.length})},worktype:function(e,n){e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(e){return n.indexOf(e.name)>-1||n.indexOf("troubleshooting")>-1&&(e.nodes=t.filter(e.nodes,function(t){return t.troubleshooting}),e.nodes.length)}),e.nodes.length}),e.nodes.length})},sector:function(e,n){e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(e){return e.nodes=t.filter(e.nodes,function(t){return n.indexOf(""+t.sector_id)>-1}),e.nodes.length}),e.nodes.length}),e.nodes.length})},status:function(n,i){n.nodes=t.filter(n.nodes,function(n){return n.nodes=t.filter(n.nodes,function(n){return n.nodes=t.filter(n.nodes,function(n){return n.nodes=t.filter(n.nodes,function(n){return n.nodes=t.filter(n.nodes,function(t){var n=!1;return i.forEach(function(i){if("no_plan"===i){if(!t.plan||!t.plan.start)return n=!0,!1}else if(e.hasStatus(t,i))return n=!0,!1}),n}),n.nodes.length}),n.nodes.length}),n.nodes.length}),n.nodes.length})}},set:function(t){this.selectors=JSON.parse(t)},apply:function(e){var n=this;t.forEach(this.selectors,function(t,i){t.length&&n.methods[i](e,t)})},dummy:void 0};return n}),function(t){function e(){}function n(t){a=[t]}function i(t,e,n){return t&&t.apply&&t.apply(e.context||e,n)}function r(t){return/\?/.test(t)?"&":"?"}function o(o){function d(t){X++||(Q(),V&&(T[W]={s:[t]}),O&&(t=O.apply(o,[t])),i(H,o,[t,_,o]),i(z,o,[o,_]))}function $(t){X++||(Q(),V&&t!=x&&(T[W]=t),i(L,o,[o,t]),i(z,o,[o,t]))}o=t.extend({},D,o);var A,j,P,R,I,H=o.success,L=o.error,z=o.complete,O=o.dataFilter,q=o.callbackParameter,F=o.callback,Y=o.cache,V=o.pageCache,B=o.charset,W=o.url,U=o.data,G=o.timeout,X=0,Q=e;return M&&M(function(t){t.done(H).fail(L),H=t.resolve,L=t.reject}).promise(o),o.abort=function(){!X++&&Q()},i(o.beforeSend,o,[o])===!1||X?o:(W=W||l,U=U?"string"==typeof U?U:t.param(U,o.traditional):l,W+=U?r(W)+U:l,q&&(W+=r(W)+encodeURIComponent(q)+"=?"),!Y&&!V&&(W+=r(W)+"_"+(new Date).getTime()+"="),W=W.replace(/=\?(&|$)/,"="+F+"$1"),V&&(A=T[W])?A.s?d(A.s[0]):$(A):(k[F]=n,P=t(w)[0],P.id=h+C++,B&&(P[u]=B),E&&E.version()<11.6?(R=t(w)[0]).text="document.getElementById('"+P.id+"')."+g+"()":P[s]=s,N&&(P.htmlFor=P.id,P.event=p),P[m]=P[g]=P[v]=function(t){if(!P[y]||!/i/.test(P[y])){try{P[p]&&P[p]()}catch(t){}t=a,a=0,t?d(t[0]):$(c)}},P.src=W,Q=function(t){I&&clearTimeout(I),P[v]=P[m]=P[g]=null,S[b](P),R&&S[b](R)},S[f](P,j=S.firstChild),R&&S[f](R,j),I=G>0&&setTimeout(function(){$(x)},G)),o)}var a,s="async",u="charset",l="",c="error",f="insertBefore",h="_jqjsp",d="on",p=d+"click",g=d+c,m=d+"load",v=d+"readystatechange",y="readyState",b="removeChild",w="<script>",_="success",x="timeout",k=window,M=t.Deferred,S=t("head")[0]||document.documentElement,T={},C=0,D={callback:h,url:location.href},E=k.opera,N=!!t("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;o.setup=function(e){t.extend(D,e)},t.jsonp=o}(jQuery),define("jquery.jsonp",["jquery"],function(){}),RegExp.escape=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(t){"use strict";t.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(t,e){var n=/\./;if(isNaN(t))return t;if(n.test(t))return parseFloat(t);var i=parseInt(t);return isNaN(i)?null:i}},parsers:{parse:function(t,e){function n(){if(u=0,l="",e.start&&e.state.rowNum<e.start)return s=[],e.state.rowNum++,void(e.state.colNum=1);if(void 0===e.onParseEntry)a.push(s);else{var t=e.onParseEntry(s,e.state);t!==!1&&a.push(t)}s=[],e.end&&e.state.rowNum>=e.end&&(c=!0),e.state.rowNum++,e.state.colNum=1}function i(){if(void 0===e.onParseValue)s.push(l);else{var t=e.onParseValue(l,e.state);t!==!1&&s.push(t)}l="",u=0,e.state.colNum++}var r=e.separator,o=e.delimiter;e.state.rowNum||(e.state.rowNum=1),e.state.colNum||(e.state.colNum=1);var a=[],s=[],u=0,l="",c=!1,f=RegExp.escape(r),h=RegExp.escape(o),d=/(D|S|\n|\r|[^DS\r\n]+)/,p=d.source;return p=p.replace(/S/g,f),p=p.replace(/D/g,h),d=RegExp(p,"gm"),t.replace(d,function(t){if(!c)switch(u){case 0:if(t===r){l+="",i();break}if(t===o){u=1;break}if("\n"===t){i(),n();break}if(/^\r$/.test(t))break;l+=t,u=3;break;case 1:if(t===o){u=2;break}l+=t,u=1;break;case 2:if(t===o){l+=t,u=1;break}if(t===r){i();break}if("\n"===t){i(),n();break}if(/^\r$/.test(t))break;throw new Error("CSVDataError: Illegal State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");case 3:if(t===r){i();break}if("\n"===t){i(),n();break}if(/^\r$/.test(t))break;if(t===o)throw new Error("CSVDataError: Illegal Quote [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]")}}),0!==s.length&&(i(),n()),a},splitLines:function(t,e){function n(){if(a=0,e.start&&e.state.rowNum<e.start)return s="",void e.state.rowNum++;if(void 0===e.onParseEntry)o.push(s);else{var t=e.onParseEntry(s,e.state);t!==!1&&o.push(t)}s="",e.end&&e.state.rowNum>=e.end&&(u=!0),e.state.rowNum++}var i=e.separator,r=e.delimiter;e.state.rowNum||(e.state.rowNum=1);var o=[],a=0,s="",u=!1,l=RegExp.escape(i),c=RegExp.escape(r),f=/(D|S|\n|\r|[^DS\r\n]+)/,h=f.source;return h=h.replace(/S/g,l),h=h.replace(/D/g,c),f=RegExp(h,"gm"),t.replace(f,function(t){if(!u)switch(a){case 0:if(t===i){s+=t,a=0;break}if(t===r){s+=t,a=1;break}if("\n"===t){n();break}if(/^\r$/.test(t))break;s+=t,a=3;break;case 1:if(t===r){s+=t,a=2;break}s+=t,a=1;break;case 2:var o=s.substr(s.length-1);if(t===r&&o===r){s+=t,a=1;break}if(t===i){s+=t,a=0;break}if("\n"===t){n();break}if("\r"===t)break;throw new Error("CSVDataError: Illegal state [Row:"+e.state.rowNum+"]");case 3:if(t===i){s+=t,a=0;break}if("\n"===t){n();break}if("\r"===t)break;if(t===r)throw new Error("CSVDataError: Illegal quote [Row:"+e.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+e.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+e.state.rowNum+"]")}}),""!==s&&n(),o},parseEntry:function(t,e){function n(){if(void 0===e.onParseValue)o.push(s);else{var t=e.onParseValue(s,e.state);t!==!1&&o.push(t)}s="",a=0,e.state.colNum++}var i=e.separator,r=e.delimiter;e.state.rowNum||(e.state.rowNum=1),e.state.colNum||(e.state.colNum=1);var o=[],a=0,s="";if(!e.match){var u=RegExp.escape(i),l=RegExp.escape(r),c=/(D|S|\n|\r|[^DS\r\n]+)/,f=c.source;f=f.replace(/S/g,u),f=f.replace(/D/g,l),e.match=RegExp(f,"gm")}return t.replace(e.match,function(t){switch(a){case 0:if(t===i){s+="",n();break}if(t===r){a=1;break}if("\n"===t||"\r"===t)break;s+=t,a=3;break;case 1:if(t===r){a=2;break}s+=t,a=1;break;case 2:if(t===r){s+=t,a=1;break}if(t===i){n();break}if("\n"===t||"\r"===t)break;throw new Error("CSVDataError: Illegal State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");case 3:if(t===i){n();break}if("\n"===t||"\r"===t)break;if(t===r)throw new Error("CSVDataError: Illegal Quote [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]")}}),n(),o}},toArray:function(e,n,i){var n=void 0!==n?n:{},r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter;var o=void 0!==n.state?n.state:{},n={delimiter:r.delimiter,separator:r.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,state:o},a=t.csv.parsers.parseEntry(e,n);return r.callback?void r.callback("",a):a},toArrays:function(e,n,i){var n=void 0!==n?n:{},r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter;var o=[],n={delimiter:r.delimiter,separator:r.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1}};return o=t.csv.parsers.parse(e,n),r.callback?void r.callback("",o):o},toObjects:function(e,n,i){var n=void 0!==n?n:{},r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter,r.headers="headers"in n?n.headers:t.csv.defaults.headers,n.start="start"in n?n.start:1,r.headers&&n.start++,n.end&&r.headers&&n.end++;var o=[],a=[],n={delimiter:r.delimiter,separator:r.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1},match:!1},s={delimiter:r.delimiter,separator:r.separator,start:1,end:1,state:{rowNum:1,colNum:1}},u=t.csv.parsers.splitLines(e,s),l=t.csv.toArray(u[0],n),o=t.csv.parsers.splitLines(e,n);n.state.colNum=1,n.state.rowNum=l?2:1;for(var c=0,f=o.length;f>c;c++){var h=t.csv.toArray(o[c],n),d={};for(var p in l)d[l[p]]=h[p];a.push(d),n.state.rowNum++}return r.callback?void r.callback("",a):a},fromArrays:function(e,n,r){var n=void 0!==n?n:{},o={};if(o.callback=void 0!==r&&"function"==typeof r&&r,o.separator="separator"in n?n.separator:t.csv.defaults.separator,o.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter,o.escaper="escaper"in n?n.escaper:t.csv.defaults.escaper,o.experimental="experimental"in n&&n.experimental,!o.experimental)throw new Error("not implemented");var a=[];for(i in e)a.push(e[i]);return o.callback?void o.callback("",a):a},fromObjects2CSV:function(e,n,r){var n=void 0!==n?n:{},o={};if(o.callback=void 0!==r&&"function"==typeof r&&r,o.separator="separator"in n?n.separator:t.csv.defaults.separator,o.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter,o.experimental="experimental"in n&&n.experimental,!o.experimental)throw new Error("not implemented");var a=[];for(i in e)a.push(arrays[i]);return o.callback?void o.callback("",a):a}},t.csvEntry2Array=t.csv.toArray,t.csv2Array=t.csv.toArrays,t.csv2Dictionary=t.csv.toObjects}(jQuery),define("jquery.csv",["jquery"],function(){}),define("dataset",["jquery","underscore","backbone","d3","global","scrollhelper","selectorhelper","workstatushelper","jquery.jsonp","jquery.csv"],function(t,e,n,i,r,o,a,s){var u=1,l=n.Model.extend({url:r.config.data_url,hideCompleted:r.config.hideCompleted,hideCompletedDepth:r.config.hideCompletedDepth,sortType:r.config.sortType,sortDesc:r.config.sortDesc,searchFields:["teamleads"],initialize:function(){this.url=r.config.data_url,this.expandedNodes={},this.listenTo(r.events,"search:model",this.onSearch),this.listenTo(r.events,"completed-filter:model",this.onCompletedFilter),this.listenTo(r.events,"sort:model",this.onSort),this.listenTo(r.events,"selector:model",this.onSelector),this.listenTo(r.events,"brief-filter:model",this.onBriefFilter),this.on("change",function(){delete this.getD3Data.d3data}),this.on("sync",function(){r.events.trigger("dataset:load_complete",this.model,!0)}),this.listenTo(r.events,"change:need_notification",this.onUpdateNeedNotification),this.on("delay_change",function(){var t=this;this.last_delay_timeout&&clearTimeout(this.last_delay_timeout),this.last_delay_timeout=setTimeout(function(){t.trigger("change")},100)})},destroy:function(){this.off()},sync:function(n,i,o){o=e.extend({},o,{url:this.url,success:function(t){try{i.completeSync(t),i.trigger("sync",i,t,o)}catch(t){r.utils.logException(t),i.trigger("error",{code:u,exception:t})}},error:function(t){i.trigger("error",{code:u,exception:{code:t.status,message:t.responseText}})}});var a=o.xhr=t.ajax(o);i.trigger("request",i,a,o)},completeSync:function(t){for(var e={},n=0;n<t.weekends.length;++n)e[t.weekends[n]]=!0;this.source_dataset=t.data,this.initIds(this.source_dataset),this.set({dataset:this.deepClone(this.source_dataset),sector_names:t.sector_names,works:t.works,weekends:e}),this.calculateDates(this.source_dataset)},getD3Data:function(){return this.getD3Data.d3data||(this.getD3Data.d3data=this.initD3Data()),this.getD3Data.d3data},deepClone:function(t){var n=e.clone(t),i=this;return e.each(n,function(t,r){e.isObject(t)&&(n[r]=i.deepClone(t))}),n},initD3Data:function(){var t=this.deepClone(this.get("dataset"));this.doSelector(t),this.doSearch(t),this.calculateDoneStatus(t),this.doCompletedFilter(t),this.doBriefFilter(t),this.doPointToNode(t),this.hideContractsLevel(t),this.calculateDates(t),r.appView.viewMenuItemsCollection.isVisible("empty_contracts")||(t.nodes=t.nodes.filter(function(t){return t.dateRange&&t.dateRange.plan})),this.doSort(t),this.expand(t,!0);var e=this.initTreeData(t);return{dataset:t,nodes:e.nodes,yScale:e.yScale}},initIds:function c(t,n){t.id=n?n+"/"+t.name:".",e.forEach(t.nodes,function(e){c(e,t.id)})},initTreeData:function(t){var e=this,n=i.layout.tree();n.children(function(t){return e.expanded(t)&&t.nodes||null});var r=n.nodes(t);r.forEach(function(t,e){t.i=e});var o=i.scale.linear().domain([0,r.length]);return{nodes:r,yScale:o}},hideContractsLevel:function(t){r.appView.viewMenuItemsCollection.isVisible("contract_level")||(t.name="",t.nodes=e.flatten(t.nodes.map(function(t){return t.nodes})))},queryLooksLikeNodeId:function(){return"."==this.searchQuery[0]&&(1==this.searchQuery.length||"/"==this.searchQuery[1])},doPointToNode:function f(t){if(this.queryLooksLikeNodeId()){var n="./"+this.searchQuery.replace(/(?:\.\/)?(.*?)\/*$/,"$1"),i="/"===this.searchQuery.slice(-1),a=this.getExistingNodeByQuery(t,n);

if(a){var s=function(){r.appView.nodesView.flashNode(a.id),f.scheduled=void 0};f.scheduled!==a.id&&(e.defer(function(){o.pointToNode(a.id+(i?"/":""),s)}),f.scheduled=a.id)}}},doSelector:function(t){a.apply(t)},doSearch:function(t){if(this.searchQuery&&!this.queryLooksLikeNodeId()){var n=this,i=this.searchQuery.match(/".*?"|[\S]+/gi),r=function(t){var i=n.getInfo(t),r=[i.name,i.description,i.id];return n.searchFields.forEach(function(n){t[n]&&(e.isArray(t[n])?r.push.apply(r,t[n]):r.push(t[n]))}),r},o=function(t){var n=r(t).map(function(t){return(""+t).toLocaleLowerCase()}),o=n.join(",,,");return e.any(i,function(t){return t.match(/^".*"$/)?(t=t.replace(/^"|"$/g,""),-1!==n.indexOf(t)):-1!==o.indexOf(t)})};!function a(t,e){if(o(t)&&(t._search_match="exact",e=!0),t.nodes){var n=t.nodes.filter(function(t){return a(t,e)});n.length&&!t._search_match&&(t._search_match="contain"),e||(t.nodes=n)}return t._search_match}(t)}},doSort:function(t){function n(t){var e=t;try{e=t.split(".").map(function(t){return("0000"+t).slice(-4)}).join(".")}catch(t){}return e}function i(t){t.forEach(function(t){t.nodes&&(t.nodes.sort(o),i(t.nodes))}),t.sort(o)}var o,a=this,s=r.utils.sortOrderNames,u=function(t,e){return t.dateRange.plan||e.dateRange.plan?t.dateRange.plan?-1:1:t.dateRange.contract_plan||e.dateRange.contract_plan?t.dateRange.contract_plan?-1:1:t.sign_date?t.sign_date.localeCompare(e.sign_date):t.ready_date&&t.ready_date.substr(0,10)!==e.ready_date.substr(0,10)?t.ready_date.localeCompare(e.ready_date):s(""+t.name,""+e.name)};switch(a.doSort.__routines_cache||(a.doSort.__routines_cache={}),this.sortType){case"sort_by_orders":o=function(t,e){var i=0,r=n(t.name),o=n(e.name);return o>r?i=-1:r>o&&(i=1),i*(a.sortDesc?-1:1)};break;case"sort_by_date_start":o=function(t,e){var n;return t.dateRange.plan&&e.dateRange.plan?(t=r.utils.extentDate(t.dateRange.plan,t.dateRange.fact).start,e=r.utils.extentDate(e.dateRange.plan,e.dateRange.fact).start,n=t-e):t.dateRange.contract_plan&&e.dateRange.contract_plan?(t=r.utils.extentDate(t.dateRange.contract_plan,t.dateRange.fact).start,e=r.utils.extentDate(e.dateRange.contract_plan,e.dateRange.fact).start,n=t-e):n=u(t,e),n*(a.sortDesc?-1:1)};break;case"sort_by_date_finish":o=function(t,e){var n;return t.dateRange.plan&&e.dateRange.plan?(t=r.utils.extentDate(t.dateRange.plan,t.dateRange.fact).finish,e=r.utils.extentDate(e.dateRange.plan,e.dateRange.fact).finish,n=t-e):n=u(t,e),n*(a.sortDesc?-1:1)};break;case"sort_by_last_routine":var l=a.doSort.__routines_cache,c=function(t,n){return void 0===l[t.id]&&(void 0===n&&(n=-1),t.dateRange.fact&&(n=void 0!==t.sector_routine?Math.max(n,t.sector_routine):e.reduce(t.nodes,function(t,e){return c(e,t)},n)),l[t.id]=n),l[t.id]};o=function(t,e){var n;if(t.dateRange.plan&&e.dateRange.plan){var i=c(t),o=c(e);i!==o?n=i-o:t.dateRange.fact&&e.dateRange.fact?n=e.dateRange.fact.finish-t.dateRange.fact.finish:(t=r.utils.extentDate(t.dateRange.plan,t.dateRange.fact).start,e=r.utils.extentDate(e.dateRange.plan,e.dateRange.fact).start,n=t-e)}else n=u(t,e);return n*(a.sortDesc?-1:1)}}i(t.nodes)},calculateDoneStatus:function(t){var e=this,n=(t.nodes||[]).filter(function(t){return void 0!==t.done});return n.length&&(t.done=!0,n.forEach(function(n){e.calculateDoneStatus(n)||(t.done=!1)})),t.done},doCompletedFilter:function(t){!this.searchQuery&&this.hideCompleted&&(t.nodes=e.filter(t.nodes,function(t){return!t.done}),"order"===this.hideCompletedDepth&&t.nodes.forEach(function(t){t.nodes=e.filter(t.nodes,function(t){return!t.done})}),"workorder"===this.hideCompletedDepth&&t.nodes.forEach(function(t){t.nodes=e.filter(t.nodes,function(t){var n=!0;return t.nodes&&t.nodes.length&&(n=!1,t.nodes=e.filter(t.nodes,function(t){var n=!0;return t.nodes&&t.nodes.length&&(n=!1,t.nodes=e.filter(t.nodes,function(t){return!t.done})),n||t.nodes&&t.nodes.length})),n||t.nodes&&t.nodes.length})}),"work"===this.hideCompletedDepth&&t.nodes.forEach(function(t){t.nodes=e.filter(t.nodes,function(t){var n=!0;return t.nodes&&t.nodes.length&&(n=!1,t.nodes=e.filter(t.nodes,function(t){var n=!0;return t.nodes&&t.nodes.length&&(n=!1,t.nodes=e.filter(t.nodes,function(t){return t.nodes&&(t.nodes=e.filter(t.nodes,function(t){return!t.done})),t.nodes&&t.nodes.length})),n||t.nodes&&t.nodes.length})),n||t.nodes&&t.nodes.length})}))},doBriefFilter:function(t){if(this.briefDaySelection){var n=this.briefDaySelection;t.nodes=e.filter(t.nodes,function(t){return t.nodes&&(t.nodes=e.filter(t.nodes,function(t){return t.nodes&&(t.nodes=e.filter(t.nodes,function(t){return t.nodes&&(t.nodes=e.filter(t.nodes,function(t){return t.nodes&&(t.nodes=e.filter(t.nodes,function(t){if(t.plan&&r.utils.dayStringToDate(t.plan.finish)>=e.first(n)&&r.utils.dayStringToDate(t.plan.start)<=e.last(n))return!0;var i=e.filter(t.status_log,function(t){return r.utils.dayStringToDate(t.date)<=e.last(n)}),o=i.length?e.last(i).status:"";return!!e.contains(["on_work","on_work_with_reject","on_hold","on_pause"],o)})),t.nodes&&t.nodes.length})),t.nodes&&t.nodes.length})),t.nodes&&t.nodes.length})),t.nodes&&t.nodes.length})}},calculateDates:function(t){var n=this,o=t.dateRange={},a=t.dateIntervals={},u=function(t,e){if(e){var r=i.time.format("%Y-%m-%d")(t);return n.get("weekends")[r]||!1}return!1},l=function(e,n){if(n>e){var i=s.getLastStatusOnDate(t,+e);return["on_pause","on_hold","on_work_with_reject"].indexOf(i&&i.status)>-1}return!1};if(t.plan){o.plan={start:r.utils.dayStringToDate(t.plan.start),finish:r.utils.dayStringToDate(t.plan.finish)};var c=t.plan_shifts&&new Date(e.last(t.plan_shifts).date_change);a.plan=[];for(var f=new Date(o.plan.start),h={};f<=o.plan.finish;)u(f,t.use_weekends)||l(f,c)?h.start&&(a.plan.push(h),h={}):(h.start||(h.start=f),h.finish=f),f=i.time.day.offset(f,1);h.start&&a.plan.push(h)}if(t.plan_before_last_shift&&(o.plan_before_last_shift={start:r.utils.dayStringToDate(t.plan_before_last_shift.start),finish:r.utils.dayStringToDate(t.plan_before_last_shift.finish)}),t.contract_plan){o.contract_plan={start:r.utils.dayStringToDate(t.contract_plan.start),finish:r.utils.dayStringToDate(t.contract_plan.finish)};var c=t.contract_plan_plan_shifts&&new Date(e.last(t.contract_plan_plan_shifts).date_change);a.contract_plan=[];for(var f=new Date(o.contract_plan.start),h={};f<=o.contract_plan.finish;)u(f,t.contract_plan_use_weekends)||l(f,c)?h.start&&(a.contract_plan.push(h),h={}):(h.start||(h.start=f),h.finish=f),f=i.time.day.offset(f,1);h.start&&a.contract_plan.push(h)}return t.contract_plan_plan_before_last_shift&&(o.contract_plan_plan_before_last_shift={start:r.utils.dayStringToDate(t.contract_plan_plan_before_last_shift.start),finish:r.utils.dayStringToDate(t.contract_plan_plan_before_last_shift.finish)}),t.fact&&(o.fact={},o.fact.start=o.fact.finish=r.utils.dayStringToDate(t.fact.date),a.fact=[o.fact]),e.forEach(t.nodes,function(t){var i=n.calculateDates(t);i.range.plan&&(o.plan=r.utils.extentDate(o.plan,i.range.plan)),i.range.contract_plan&&(o.contract_plan=r.utils.extentDate(o.contract_plan,i.range.contract_plan)),i.range.plan_before_last_shift?o.plan_before_last_shift=r.utils.extentDate(o.plan_before_last_shift,i.range.plan_before_last_shift):i.range.plan&&(o.plan_before_last_shift=r.utils.extentDate(o.plan_before_last_shift,i.range.plan)),i.range.contract_plan_plan_before_last_shift?o.contract_plan_plan_before_last_shift=r.utils.extentDate(o.contract_plan_plan_before_last_shift,i.range.contract_plan_plan_before_last_shift):i.range.contract_plan&&(o.contract_plan_plan_before_last_shift=r.utils.extentDate(o.contract_plan_plan_before_last_shift,i.range.contract_plan)),i.range.fact&&(o.fact=r.utils.extentDate(o.fact,i.range.fact)),e.forEach(i.intervals,function(t,e){t.length&&(a[e]||(a[e]=[]),a[e].push(t.map(r.utils.cloneDates)))})}),r.utils.flattenIntervals(a),{range:o,intervals:a}},getInfo:function(t){var e=t.name||"",n=this.getDescription(t);if(t.work_code){var i=t.sector_id+"_"+t.work_code,r=this.get("works")[i];r&&(e="",n="["+t.work_code+"] "+r.name+", "+r.unit)}return{name:e,description:n,id:t.id}},getDescription:function(t){switch(t.node_type){case"contract":if(t.client_name)return t.client_name;break;case"order":if(t.production_name)return t.production_name;break;case"work_type":if(t.teamleads)return t.teamleads.length>4?r.utils.pluralForm(t.teamleads.length,["","",""]):t.teamleads.join(", ");break;case"workorder":if(void 0!==t.sector_name_id)return"["+t.sector_id+"] "+this.get("sector_names")[t.sector_name_id];break;default:return""}},getInfoPlanShift:function(t,e){var n=null,i=-1;if(t.plan_shifts)return t.plan_shifts.forEach(function(t){"both"!==t.type&&t.type!==e||(n=t,i++)}),n?{index:i,planShift:n}:null;var r=function(t,e){if(t.dateRange.plan_before_last_shift){var n=t.nodes||[];return n.reduce(function(t,n){return n.dateRange.plan_before_last_shift&&+n.dateRange.plan_before_last_shift[e]!==+n.dateRange.plan[e]?t+1:t},0)}return 0};return t._plan_shifts_inside||(t._plan_shifts_inside={}),void 0===t._plan_shifts_inside[e]&&(t._plan_shifts_inside[e]=r(t,e)),{inside:t._plan_shifts_inside[e]}},toggleNode:function(t){this.expand(t,!this.expanded(t));var e=this.getD3Data(),n=this.initTreeData(e.dataset);e.nodes=n.nodes,e.yScale=n.yScale,i.event.shiftKey&&console.log(t),this.trigger("toggle",t)},expand:function(t,e){e?this.expandedNodes[t.id]=!0:delete this.expandedNodes[t.id]},expanded:function(t){return this.expandedNodes[t.id]||!1},expandNodeToNodeType:function(t,n){function i(t){t.node_type===n?r.expanded(t)&&(r.expand(t,!1),a=!0):(r.expanded(t)||(r.expand(t,!0),a=!0),e.forEach(t.nodes,i))}var r=this,o=this.getD3Data(),a=!1;if(i(t),a){var s=this.initTreeData(o.dataset);o.nodes=s.nodes,o.yScale=s.yScale,this.trigger("change")}},expandToSearchResults:function(){function t(i){"contain"===i._search_match&&(n.expanded(i)||(n.expand(i,!0),r=!0),e.forEach(i.nodes,t))}var n=this,i=this.getD3Data(),r=!1;if(t(i.dataset),r){var o=this.initTreeData(i.dataset);i.nodes=o.nodes,i.yScale=o.yScale,this.trigger("change")}},expandToNode:function(t){for(var e,n=t.toLocaleLowerCase().split("/").slice(0,-1),i=this.getD3Data(),r=[i.dataset],o=!1,a=0;a<n.length;a++)for(var s=0;s<r.length;s++)if(e=r[s],e.id.split("/").slice(-1)[0].toLocaleLowerCase()===n[a]){this.expanded(e)||(this.expand(e,!0),o=!0),r=r[s].nodes||[];break}if(o){var u=this.initTreeData(i.dataset);i.nodes=u.nodes,i.yScale=u.yScale,this.trigger("change")}return o},getNodeById:function(t){return e.find(this.getD3Data().nodes,function(e){return e.id===t})},getExistingNodeByQuery:function(t,e){e=e.toLocaleLowerCase();for(var n,i=e.split("/"),r=[t],o=0;o<i.length;o++)for(var a=0;a<r.length;a++)if(n=r[a],n.id.split("/").slice(-1)[0].toLocaleLowerCase()===i[o]){r=r[a].nodes||[];break}return n.id.toLocaleLowerCase()!==e&&(n=void 0),n},onUpdateNeedNotification:function(t){function n(t,i,r){t[i]=r,e.forEach(t.nodes,function(t){n(t,i,r)})}function i(t,e){var n=null;for(var r in t.nodes){var o=t.nodes[r];if(o.id==e)return o;if(n=i(o,e))return n}return n}var o=this.deepClone(this.get("dataset")),a=i(o,t.node_id);n(a,"need_notification",t.need_notification),this.set("dataset",JSON.stringify(o),{silent:!0}),o=this.getD3Data().dataset,a=i(o,t.node_id),n(a,"need_notification",t.need_notification),r.events.trigger("change:dataset",this)},onSearch:function(t,e){this.searchQuery!==t&&(this.searchQuery=t,this.get("dataset")&&!e&&this.trigger("delay_change"))},onBriefFilter:function(t){this.briefDaySelection=t.length?e.sortBy(t):void 0,this.trigger("delay_change")},onCompletedFilter:function(t,e,n){this.hideCompleted=t,this.hideCompletedDepth=e,this.get("dataset")&&!n&&this.trigger("delay_change")},onSort:function(t,e){this.sortType=t,this.sortDesc=e,this.get("dataset")&&this.trigger("delay_change")},onSelector:function(t){a.set(t),this.get("dataset")&&this.trigger("delay_change")},getSelectorValues:function(t){return a.selectors[t]||[]},dummy:{}});return l}),define("d3.lambdas",["d3"],function(t){t.=function(t){var e,n=Array.prototype.slice.call(arguments,1);return function(i){return e=i[t],"function"==typeof e?e.apply(i,n):e}},t.D=function(t){return t},t.I=function(t,e){return e}}),define("planshifts_d3",["d3","global","d3.lambdas"],function(t,e){var n={initMarkers:function(){var n,i,r,o=t.select("#canvas"),a=o.select("defs");r=e.config.planShiftDotRadius,a.append("marker").attr("id","plan-shift-dot").attr("viewBox",[-r,-r,2*r,2*r].join(" ")).attr("markerWidth",r).attr("markerHeight",r).append("circle").attr("r",r),n=e.config.planShiftArrowWidth,i=e.config.planShiftArrowHeight,a.append("marker").attr("id","plan-shift-arrow").attr("viewBox","-1 -1 "+(i+2)+" "+(n+2)).attr("refX",i).attr("refY",n/2).attr("markerWidth",i+2).attr("markerHeight",n+2).attr("orient","auto").append("path").attr("d","M0,0 L"+i+","+n/2+"L0,"+n+" Z")},call:function(t,e){this.initMarkers&&(this.initMarkers(),delete this.initMarkers);var n=t.datum();this.transitionOrNot=e,this.planShiftsIsVisible(n)?(t=t.data([n]),t.enter().append("g").attr("class","plan-shifts").style("opacity",1e-6),t.call(this.drawPlanShifts,this),e(t).style("opacity",1)):e(t).style("opacity",1e-6).remove()},planShiftsIsVisible:function(t){return e.appView.viewMenuItemsCollection.isVisible("plan_shifts")&&(t.plan_shifts||t.dateRange.plan_before_last_shift&&(+t.dateRange.plan_before_last_shift.start!==+t.dateRange.plan.start||+t.dateRange.plan_before_last_shift.finish!==+t.dateRange.plan.finish))},drawPlanShifts:function(t,e){var n=t.datum();["start","finish"].forEach(function(i){e.drawLine(i,t,n.dateRange.plan[i],n.dateRange.plan_before_last_shift[i]),e.drawBackground(i,t,n.dateRange.plan[i],n.dateRange.plan_before_last_shift[i])})},drawLine:function(n,i,r,o){var a,s=this,u=["line-"+n,"line-"+n+"-shadow"],l=+o===+r?[]:[o],c=e.utils.daysToPixels(1),f=function(t){var i=s.getLineWidth(r,t),o=("start"===n?1:-1)*e.config.planShiftCurveHeight;return"M0,0 Q"+i/2+","+2*o+" "+i+",0"},h=function(t){return"translate("+(e.timeScale(t)+c*("start"===n?.25:.75))+", "+e.config.timelinePlanHeight/2+")"};u.forEach(function(e){a=i.selectAll("."+e).data(l,t.(n)),a.enter().append("path").attr("class",e).style("opacity",1e-6).attr("marker-start","url(#plan-shift-dot)").attr("marker-end","url(#plan-shift-arrow)").attr("d",f).attr("transform",h),s.transitionOrNot(a).style("opacity",1).attr("d",f).attr("transform",h),s.transitionOrNot(a.exit()).style("opacity",1e-6).remove()})},drawBackground:function(n,i,r,o){var a=this,s=e.utils.daysToPixels(1),u=+o===+r?[]:[o],l=i.selectAll(".plan-shift-background-"+n).data(u,t.(n));l.enter().append("rect").attr("class","background plan-shift-background-"+n).attr("data-shiftType",n).attr("height",e.config.timelinePlanHeight+e.config.planShiftCurveHeight).attr("y","start"===n?0:-e.config.planShiftCurveHeight),l.attr("width",function(t){return Math.abs(a.getLineWidth(r,t))}).attr("x",function(t){return e.timeScale(Math.min(t,r))+s*("start"===n?.25:.75)}),l.exit().remove()},getLineWidth:function(t,n){return e.timeScale(t)-e.timeScale(n)},dummy:null};return n}),define("cellshelper",["underscore","d3","global","d3.lambdas"],function(t,e,n){var i={drawCommentsMarks:function(r,o,a){var s,u,l=r.datum();u=n.appView.viewMenuItemsCollection.isVisible("comments")?i.getInnerCellsForDatum(l,a):[];var c=t.groupBy(u,function(t){return+t.get("date")}),f=this,h=t.map(c,function(e){var n=t.any(e,f.cellHasNewComments);return{date:e[0].get("date"),totalComments:t.reduce(e,function(t,e){return t+e.get("comments").filter(function(t){return!t.type}).length},0),hasRequestPlan:t.reduce(e,function(t,e){return e.get("comments").find(function(t){return"requestplan"==t.type})||t},!1),hasConfirmPlan:t.reduce(e,function(t,e){return e.get("comments").find(function(t){return"confirmplan"==t.type})||t},!1),hasNew:n}});s=r.selectAll(".cell-badge").data(h,e.("date"));var d=n.utils.daysToPixels(1),p=function(t){var e=t.hasRequestPlan,n=t.hasConfirmPlan,i=t.totalComments,r="";return e&&n&&i?r="*":(r+=i>0?i:"",r+=e?"?":"",r+=n?"!":""),r},g=function(t){return 5*p(t).length},m=3,v=1,y=13;s.enter().append("rect").attr("opacity",1e-6).attr("class","cell-badge cell-badge-clickable").attr("y",n.config.nodeHeight+n.config.nodePadding/2-y-v).attr("height",y),o(s.classed("has-new",e.("hasNew"))).attr("opacity",1).attr("x",function(t){return n.timeScale(t.date)+d-g(t)-2*m-v}).attr("width",function(t){return 2*m+g(t)}),o(s.exit()).attr("opacity",1e-6).remove(),s=r.selectAll(".cell-badge-text").data(h,e.("date")),s.enter().append("text").attr("opacity",1e-6).attr("class","cell-badge-text cell-badge-clickable");var b=o(s.classed("has-new",e.("hasNew"))).attr("opacity",1).attr("x",function(t){return n.timeScale(t.date)+n.utils.daysToPixels(1)-m-v}).attr("y",n.config.nodeHeight+n.config.nodePadding/2-m-v);b.text(function(t){return p(t)}),o(s.exit()).attr("opacity",1e-6).remove()},cellHasNewComments:function(e){if(e.get("comments").length>0){var i=t.last(e.get("comments"));return n.currentUser!==i.user&&(!e.seen_at||i.created_at>e.seen_at)}return!1},getInnerCellsForDatum:function(t,e){if(t.cache_get_inner_cells_for_datum)return t.cache_get_inner_cells_for_datum;var i=[],r=n.utils.treeToNodes(t).map(function(t){return t.id});return e&&(i=e.filter(function(t){return(t.get("comments").length||t.get("requestPlan")||t.get("confirmPlan"))&&r.indexOf(t.get("node_id"))>-1})),t.cache_get_inner_cells_for_datum=i,i},dummy:null};return i}),define("timelinesview",["jquery","underscore","backbone","d3","global","planshifts_d3","workstatushelper","cellshelper","d3.lambdas"],function(t,e,n,i,r,o,a,s){var u=n.View.extend({el:"#timelines",initialize:function(){this.d3=i.select(this.el),this.listenTo(this.model,"change",this.render),this.listenTo(r.events,"toggle:viewmenu",this.render),this.listenTo(this.model,"toggle",this.renderNode),this.listenTo(r.events,"zoomed panned resize",this.adjustZoomAndPan)},render:function(){this.d3data=this.model.getD3Data(),this.renderNode(this.d3data.dataset,!0)},renderNode:function(t,n){var o=this,a=o.d3data.yScale(t.i),s=o.d3.selectAll(".timelines-container").data(o.d3data.nodes,i.("id")),u=n?function(t,e){return"translate(-9042,"+o.d3data.yScale(e)+")"}:"translate(0,"+a+")";s.enter().append("g").attr("class",function(t){return"timelines-container"+(t.depth>1?" child":"")}).attr("data-id",i.("id")).attr("transform",u).attr("opacity",1e-6).on("click",function(t){r.events.trigger("click:node",t.id)}).on("dblclick",function(t){i.event.target.classList.contains("cell-badge-clickable")||i.event.metaKey||i.event.ctrlKey||(r.events.trigger("off:tooltip"),e.delay(function(){r.events.trigger("on:tooltip")},r.config.duration),o.model.toggleNode(t))});var l=s;l=l.attr("transform",function(t,e){return"translate(0,"+o.d3data.yScale(e)+")"}),l=l.attr("opacity",function(t){return o.model.expanded(t)?r.config.nodeToggleOpacity:1}),l.call(this.d3_drawTimelines,this),s.exit().attr("opacity",1e-6).attr("transform",u).remove()},d3_drawTimelines:function(t,e,n){var u=function(t){return t};t.each(function(t){var n,l=i.select(this),c=l.selectAll(".plan-timeline").data([t]),f=l.selectAll(".fact-timeline").data([t]),h=l.selectAll(".plan-shifts").data([t]),d=l.selectAll(".statuses").data([t]);c.enter().append("g").attr("class","plan-timeline"),f.enter().append("g").attr("class","fact-timeline"),h.enter().append("g").attr("class","plan-shifts"),d.enter().append("g").attr("class","statuses"),n=c.selectAll(".date-range"),t.dateRange.plan?(n=n.data([t.dateRange.plan]),n.enter().append("rect").attr("class","date-range").style("opacity",1e-6).attr("height",r.config.timelinePlanHeight),u(n).style("opacity",1).attr("x",function(t){return r.timeScale(t.start)}).attr("width",e.getTimelineWidthInPixels)):n.style("opacity",1e-6).remove(),n=c.selectAll(".date-intervals"),t.dateIntervals.plan?(n=n.data([t.dateIntervals.plan]),n.enter().append("g").style("opacity",1e-6).attr("class","date-intervals"),n.call(e.d3_drawTimelineIntervals,"plan",e,u),n.style("opacity",1)):n.style("opacity",1e-6).remove(),n=c.selectAll(".contract-date-range"),t.dateRange.contract_plan?(n=n.data([t.dateRange.contract_plan]),n.enter().append("rect").attr("class","contract-date-range").style("opacity",1e-6).attr("height",r.config.timelineContractPlanHeight),u(n).style("opacity",1).attr("x",function(t){return r.timeScale(t.start)}).attr("width",e.getTimelineWidthInPixels)):n.style("opacity",1e-6).remove(),n=c.selectAll(".contract-date-intervals"),t.dateIntervals.contract_plan?(n=n.data([t.dateIntervals.contract_plan]),n.enter().append("g").style("opacity",1e-6).attr("class","contract-date-intervals"),n.call(e.d3_drawTimelineIntervals,"contract_plan",e,u),n.style("opacity",1)):n.style("opacity",1e-6).remove(),n=f.selectAll(".date-range"),r.appView.viewMenuItemsCollection.isVisible("facts")&&t.dateRange.fact?(n=n.data([t.dateRange.fact]),n.enter().append("rect").attr("class","date-range").style("opacity",1e-6).attr("y",r.config.timelinePlanHeight+r.config.timelinePadding).attr("height",r.config.timelineFactHeight),u(n).style("opacity",1).attr("x",function(t){return r.timeScale(t.start)}).attr("width",e.getTimelineWidthInPixels)):n.style("opacity",1e-6).remove(),n=f.selectAll(".date-intervals"),!r.appView.viewMenuItemsCollection.isVisible("facts")||t.scope&&r.appView.viewMenuItemsCollection.isVisible("facts_detalization")||!t.dateIntervals.fact?n.style("opacity",1e-6).remove():(n=n.data([t.dateIntervals.fact]),n.enter().append("g").attr("class","date-intervals").style("opacity",1e-6).attr("transform","translate(0, "+(r.config.timelinePlanHeight+r.config.timelinePadding)+")"),n.call(e.d3_drawTimelineIntervals,"fact",e,u),n.style("opacity",1)),n=f.selectAll(".detalization").data([t]),r.appView.viewMenuItemsCollection.isVisible("facts")&&r.appView.viewMenuItemsCollection.isVisible("facts_detalization")&&t.scope&&t.nodes?(n.enter().append("g").attr("class","detalization").attr("transform","translate(0, "+(r.config.timelinePlanHeight+r.config.timelinePadding)+")"),n.call(e.d3_drawDetalization,e,u)):n.remove(),o.call(h,u);var p=r.utils.daysToPixels(1)/2;n=d.selectAll(".done-label"),r.appView.viewMenuItemsCollection.isVisible("facts")&&t.done&&t.dateRange.fact?(n=n.data([t]),n.enter().append("text").attr("class","done-label").attr("y",r.config.timelinePlanHeight+r.config.timelinePadding+r.config.timelineFactHeight/2).text(""),u(n).attr("x",function(t){return r.timeScale(t.dateRange.fact.finish)+p})):n.remove(),a.drawStatuses(d,u,"on_hold"),a.drawStatuses(d,u,"on_work_with_reject"),a.drawStatuses(d,u,"on_pause"),a.drawStatuses(d,u,"no_data"),s.drawCommentsMarks(l,u,e.model.get("cells"))})},d3_drawDetalization:function(t,n,o){var a=t.datum(),s=a.nodes.reduce(function(t,e){return t[+e.dateRange.fact.start]={date:e.dateRange.fact.start,norm:e.fact.scope/a.scope},t},{}),u=i.time.day.range(a.dateRange.fact.start,+a.dateRange.fact.finish+1).map(function(t){return s[+t]||{date:t,norm:0}});u.reduce(function(t,e){return e.total=t,t+e.norm},0),u.push(e.extend({},e.last(u),{date:i.time.day.offset(a.dateRange.fact.finish,1)}));var l=i.svg.area().interpolate("step-after").x(function(t){return r.timeScale(t.date)}).y0(function(t){return(1-t.total)*r.config.timelineFactHeight}).y1(function(t){return(1-t.total-t.norm)*r.config.timelineFactHeight}),c=t.selectAll(".fact-record").data([u]);c.enter().append("path").attr("class","fact-record").attr("d",l),o(c).attr("d",l);var f=r.utils.daysToPixels(1)/2,h=Math.min(12,Math.max(7,f)),d=t.selectAll("text").data(u.slice(0,-1).filter(function(t){return t.norm})),p=h/r.config.timelineFactHeight,g=function(t){return 1-t.total-t.norm>p?"above":t.norm>p?"middle":"below"},m=function(t){var e;switch(g(t)){case"above":e=1-t.total-t.norm;break;case"middle":e=1-t.total-t.norm+p;break;case"below":e=1-t.total+p}return e*r.config.timelineFactHeight-h/10};d.enter().append("text").classed("lighten",function(t){return"middle"===g(t)}).style("font-size",h).attr("y",m).attr("opacity",1e-6).attr("x",function(t){return r.timeScale(t.date)+f}).text(function(t){return Math.round(100*(t.total+t.norm))}),o(d.classed("lighten",function(t){return"middle"===g(t)})).style("font-size",h).attr("opacity",f>6?1:1e-6).attr("y",m).attr("x",function(t){return r.timeScale(t.date)+f})},d3_drawTimelineIntervals:function(t,e,n,i){var o=t.selectAll("rect").data(t.datum(),function(t){return+t.finish});o.enter().append("rect").style("opacity",1e-6).attr("height","fact"===e?r.config.timelineFactHeight:"contract_plan"===e?r.config.timelineContractPlanHeight:r.config.timelinePlanHeight),i(o).style("opacity",1).attr("x",function(t){return r.timeScale(t.start)}).attr("width",n.getTimelineWidthInPixels),i(o.exit()).style("opacity",1e-6).remove()},getTimelineWidthInPixels:function(t){var e=new Date(t.finish);return e.setDate(e.getDate()+1),r.timeScale(e)-r.timeScale(t.start)},adjustZoomAndPan:function(t){this.d3.selectAll(".timelines-container").call(this.d3_drawTimelines,this,t)},dummy:{}});return u}),define("datahelper",["underscore"],function(t){function e(t){return t&&"object"==typeof t&&!Array.isArray(t)&&t.hasOwnProperty("__root__")?t:new n(t)}function n(t){this.__root__=t}return n.prototype=e.prototype,e.prototype.forEach=function(e,n,i){function r(n){o&&!n[o]||(n.node_type===e?a(n):t.forEach(n.nodes,r))}var o,a;"function"!=typeof n?(o=n.filter,a=n.callback||t.noop()):a=n,void 0!==i&&(a=t.createCallback(a,i)),r(this.__root__)},e}),function(t){"use strict";var e='[data-toggle="context"]',n=function(e,n){this.$element=t(e),this.before=n.before||this.before,this.onItem=n.onItem||this.onItem,this.scopes=n.scopes||null,n.target&&this.$element.data("target",n.target),this.listen()};n.prototype={constructor:n,show:function(e){var n,i,r,o,a={relatedTarget:this,target:e.currentTarget};return!this.isDisabled()&&(this.closemenu(),this.before.call(this,e,t(e.currentTarget)))?(n=this.getMenu(),n.trigger(i=t.Event("show.bs.context",a)),r=this.getPosition(e,n),o="li:not(.divider)",n.attr("style","").css(r).addClass("open").on("click.context.data-api",o,t.proxy(this.onItem,this,t(e.currentTarget))).trigger("shown.bs.context",a),t("html").on("click.context.data-api",n.selector,t.proxy(this.closemenu,this)),t(window).on("scroll.context.data-api",t.proxy(this.closemenu,this)),!1):void 0},closemenu:function(e){var n,i,r,o;return n=this.getMenu(),n.hasClass("open")?(o={relatedTarget:this},n.trigger(i=t.Event("hide.bs.context",o)),r="li:not(.divider)",n.removeClass("open").off("click.context.data-api",r).trigger("hidden.bs.context",o),t("html").off("click.context.data-api",n.selector),!1):void 0},keydown:function(t){27==t.which&&this.closemenu(t)},before:function(t){return!0},onItem:function(t){return!0},listen:function(){this.$element.on("contextmenu.context.data-api",this.scopes,t.proxy(this.show,this)),t("html").on("click.context.data-api",t.proxy(this.closemenu,this)),t("html").on("keydown.context.data-api",t.proxy(this.keydown,this))},destroy:function(){this.$element.off(".context.data-api").removeData("context"),t("html").off(".context.data-api")},isDisabled:function(){return this.$element.hasClass("disabled")||this.$element.attr("disabled")},getMenu:function(){var e,n=this.$element.data("target");return n||(n=this.$element.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),e=t(n),e&&e.length?e:this.$element.find(n)},getPosition:function(e,n){var i,r,o,a=e.clientX,s=e.clientY,u=t(window).width(),l=t(window).height(),c=n.find(".dropdown-menu").outerWidth(),f=n.find(".dropdown-menu").outerHeight(),h={position:"absolute","z-index":9999};return i=s+f>l?{top:s-f+t(window).scrollTop()}:{top:s+t(window).scrollTop()},r=a+c>u&&a-c>0?{left:a-c+t(window).scrollLeft()}:{left:a+t(window).scrollLeft()},o=n.offsetParent().offset(),r.left=r.left-o.left,i.top=i.top-o.top,t.extend(h,i,r)}},t.fn.contextmenu=function(e,i){return this.each(function(){var r=t(this),o=r.data("context"),a="object"==typeof e&&e;o||r.data("context",o=new n(r,a)),"string"==typeof e&&o[e].call(o,i)})},t.fn.contextmenu.Constructor=n,t(document).on("contextmenu.context.data-api",function(){t(e).each(function(){var e=t(this).data("context");e&&e.closemenu()})}).on("contextmenu.context.data-api",e,function(e){t(this).contextmenu("show",e),e.preventDefault(),e.stopPropagation()})}(jQuery),define("bootstrap_contextmenu",function(){}),define("nodesview",["jquery","underscore","backbone","d3","global","datahelper","d3.lambdas","bootstrap_contextmenu"],function(t,e,n,i,r,o){var a=n.View.extend({el:"#nodes",template_contextmenu:t("#contextmenu-nodes-template").html(),initialize:function(){this.d3=i.select(this.el),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"toggle",this.nodeToggle),this.listenTo(r.events,"click:node",this.selectNode),this.listenTo(r.events,"change:dataset",this.render),this.initContextmenu(),r.router.on("route:applyDatamining",this.onRouting,this)},initContextmenu:function(){var n,r=this;t("#nodes").contextmenu({target:"#contextmenu",before:function(t){return!t.altKey&&(t.stopPropagation(),t.preventDefault(),n=i.select(t.target).datum(),"work"!==n.node_type&&"fact_work"!==n.node_type&&(this.getMenu().find(".dropdown-menu").html(e.template(r.template_contextmenu,{rootTitle:n.name,rootType:n.node_type,D_datum:o(n)})),!0))},onItem:function(e,i){var o=t(i.target).data("type");r.model.expandNodeToNodeType(n,o)}})},render:function(t){this.d3data=this.model.getD3Data(),this.renderNode(this.d3data.dataset,!0)},onRouting:function(t,e,n,i,o,a){if(a){var s=a.split(",").reduce(function(t,e){return t.push(r.router.decodeURI(e)),t},[]);this.model.expandedNodes={};var u=this;s.map(function(t){u.model.expandedNodes[t]=!0}),this.d3data&&this.renderNode(this.d3data.dataset,!1)}},nodeToggle:function(t,n){var i=e.reduce(this.model.expandedNodes,function(t,e,n){return t+(""==t?"":",")+r.router.encodeURI(n)},"");r.router.navigateSmart({toggle:i},{trigger:!1}),this.renderNode(t,n)},renderNode:function(t,n){t||console.log("err_root");var o=this,a=(r.config.duration,this.d3.selectAll(".node").data(this.d3data.nodes,i.("id"))),s=t.depth*r.config.treeDepthPadding,u=this.d3data.yScale(t.i),l=n?function(t,e){return"translate(-1234,"+o.d3data.yScale(e)+")"}:"translate("+s+", "+u+")";a.enter().append("g").attr("class",function(t){return"node "+t.node_type}).classed("troubleshooting",i.("troubleshooting")).classed("selected",function(t){return t.id===r.config.preselectedNode}).attr("data-id",i.("id")).attr("transform",l).attr("opacity",0).call(this.d3_drawNode,this).on("click",function(t){r.events.trigger("click:node",t.id)}).on("dblclick",function(t){r.events.trigger("off:tooltip"),e.delay(function(){r.events.trigger("on:tooltip")},r.config.duration),o.model.toggleNode(t)}),a.classed("empty",function(t){return!t.nodes||!t.nodes.length}).attr("transform",function(t,e){return"translate("+t.depth*r.config.treeDepthPadding+","+o.d3data.yScale(e)+")"}).attr("opacity",r.config.treeOpacity).call(this.d3_drawNode,this),a.exit().attr("transform",l).attr("opacity",0).remove(),r.config.preselectedNode&&(a[0].forEach(function(t){t.dataset.id===r.config.preselectedNode&&e.delay(function(){t.scrollIntoView(),window.scrollTo(0,window.scrollY-200),r.events.trigger("click:node",t.dataset.id)},200)}),r.config.preselectedNode=null)},d3_drawNode:function(e,n){var o=[];e.each(function(e){var a=r.config.nodeHeight,s=i.select(this).classed("linked",!1).classed("exact_match",function(t){return"exact"===t._search_match}).classed("contain_match",function(t){return"contain"===t._search_match}),u=s.selectAll(".label").data([e]);u.enter().append("foreignObject").attr("class","label").attr("height",a).append("xhtml:body").append("xhtml:div").style("border-radius",r.config.nodeRadius+"px").style("height",a+"px").style("width",r.config.nodeWidthMax+"px");var l=n.model.getInfo(e);u.select("body>div").style("text-decoration",function(t){return t.done?"underline":"none"}).html(function(t){return html=l.name,l.description&&(html+=' <span class="description">'+l.description+"</span>"),html});var c=t(u.node()).find("div").get(0),f=c.getBoundingClientRect();

o[e.depth]||(o[e.depth]=r.config.nodeWidthMin);for(var h=o[e.depth];h<=r.config.nodeWidthMax&&(u.attr("width",h),f=c.getBoundingClientRect(),!(f.height<=a));h+=10);u.attr("width")<f.width&&u.attr("width",f.width),o[e.depth]=Math.max(o[e.depth],u.attr("width"));var d=s.selectAll(".foreground").data([e]);if(""!=e.name){var p=s.selectAll(".notify").data([e]);p.enter().append("foreignObject").attr("class","notify").attr("height","20").attr("width","20").attr("x","100").attr("y","0").append("xhtml:body").on("click",function(t){}),p.select("body").html('<i style="color: '+(e.need_notification?"#000":"#aaa")+' " class="fa fa-clock-o i-notify "></i>')}d.enter().append("a").attr("xlink:href",function(t){var e=t.id.split("/").length>2?t.id.slice(2):t.id;return"#"+r.router.updateQueryWithParams(r.router.getLocation(),{search:e})}).on("click",function(){this.blur(),0!==i.event.button||i.event.metaKey||i.event.ctrlKey?i.event.stopPropagation():i.event.preventDefault()}).append("rect").attr("class","foreground").attr("rx",r.config.nodeRadius).attr("height",a).attr("x",0)}),e.each(function(t){var e=i.select(this);e.selectAll(".label, .foreground").attr("width",o[t.depth]),e.selectAll(".notify").attr("x",o[t.depth]-17)})},flashNode:function(t){var e,n=this,o=99,a={x:0,y:0,height:r.config.nodeHeight,opacity:.8,rx:r.config.nodeRadius,ry:r.config.nodeRadius},s={x:-o,y:-o,height:a.height+2*o,opacity:1e-6,rx:o,ry:o},u=function(t,u){a.width=u.getBoundingClientRect().width,s.width=a.width+2*o,e=i.select("#main").append("rect").attr("transform","translate("+t.depth*r.config.treeDepthPadding+","+n.d3data.yScale(t.i)+")").attr("id","node-flash").attr(a),e.transition().duration(r.config.duration).ease("circle-out").attr(s).remove()};i.selectAll("#nodes .node").each(function(e){e.id===t?(i.select(this).classed("linked",!0),u(e,this)):i.select(this).classed("linked",!1)})},selectNode:function(t){this.d3.selectAll(".node").classed("selected",function(e){return e.id===t}),r.router.navigateSmart({preselected_contract:t?r.router.escapeParam(t):""},{trigger:!1})},notifyNode:function(t){this.render()},dummy:{}});return a}),function(t){t.fn.hoverIntent=function(e,n,i){var r={interval:100,sensitivity:7,timeout:0};r="object"==typeof e?t.extend(r,e):t.isFunction(n)?t.extend(r,{over:e,out:n,selector:i}):t.extend(r,{over:e,out:e,selector:n});var o,a,s,u,l=function(t){o=t.pageX,a=t.pageY},c=function(e,n){return n.hoverIntent_t=clearTimeout(n.hoverIntent_t),Math.abs(s-o)+Math.abs(u-a)<r.sensitivity?(t(n).off("mousemove.hoverIntent",l),n.hoverIntent_s=1,r.over.apply(n,[e])):(s=o,u=a,void(n.hoverIntent_t=setTimeout(function(){c(e,n)},r.interval)))},f=function(t,e){return e.hoverIntent_t=clearTimeout(e.hoverIntent_t),e.hoverIntent_s=0,r.out.apply(e,[t])},h=function(e){var n=jQuery.extend({},e),i=this;i.hoverIntent_t&&(i.hoverIntent_t=clearTimeout(i.hoverIntent_t)),"mouseenter"==e.type?(s=n.pageX,u=n.pageY,t(i).on("mousemove.hoverIntent",l),1!=i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){c(n,i)},r.interval))):(t(i).off("mousemove.hoverIntent",l),1==i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){f(n,i)},r.timeout)))};return this.on({"mouseenter.hoverIntent":h,"mouseleave.hoverIntent":h},r.selector)}}(jQuery),define("jquery.hoverIntent",["jquery"],function(){}),define("tooltipview",["jquery","underscore","d3","backbone","global","jquery.hoverIntent"],function(t,e,n,i,r){var o=!1,a=!1,s=!0,u=i.View.extend({el_nodes:"#nodes",el_timelines:"#timelines",initialize:function(){this.$el_nodes=t(this.el_nodes),this.$el_timelines=t(this.el_timelines),this.$el_timelines.add(this.el_nodes).hoverIntent(function(t){r.events.trigger("intent_show:tooltip",t)},function(t){r.events.trigger("intent_hide:tooltip",t)},"g,rect,text,foreignObject,i"),this.listenTo(r.events,"intent_show:tooltip",this.showTooltip),this.listenTo(r.events,"intent_hide:tooltip",this.hideTooltips),this.listenTo(r.events,"on:tooltip",this.onTooltips),this.listenTo(r.events,"off:tooltip",this.offTooltips)},showTooltip:function(t){if(!o&&s){var e=this.getHovered(t);e&&(e.node.classed("hover",!0),e.timeline.classed("hover",!0),o=!0,r.events.trigger("show_daterange:tooltip",e.timeline.datum()),r.events.trigger("show:tooltip",e))}},hideTooltips:function(){if(o&&!a&&s){n.select(this.el_nodes).selectAll(".node").classed("hover",!1),n.select(this.el_timelines).selectAll(".timelines-container").classed("hover",!1);var e=t(".tipsy");e.fadeOut(function(){e.remove()}),o=!1,r.events.trigger("hide:tooltip")}},onTooltips:function(){s=!0},offTooltips:function(){s=!1},getHovered:function(e){var i=t(e.target).closest(".node,.timelines-container").data("id"),r=this.$el_nodes.find('.node[data-id="'+i+'"]'),o=this.$el_timelines.find('.timelines-container[data-id="'+i+'"]');return r.length&&o.length?{node:n.select(r[0]),timeline:n.select(o[0])}:void 0},d3_drawTooltip:function(e,n){var i,s,u,l=t('<div><div class="tipsy-arrow"></div><div class="tipsy-inner"></div></div>'),c=e.node(),f=c.getBoundingClientRect(),h=t.extend({},t(c).offset(),{width:f.width||0,height:f.height||0}),d=n.gravity;switch(l[0].className="tipsy "+(n.className||""),l.find(".tipsy-inner").html(n.title),l.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body),i=l[0].offsetWidth,s=l[0].offsetHeight,d.charAt(0)){case"s":u={top:h.top-s-n.offset,left:h.left+h.width/2-i/2};break;case"e":u={top:h.top+h.height/2-s/2,left:h.left-i-n.offset};break;case"w":u={top:h.top+h.height/2-s/2,left:h.left+h.width+n.offset}}2===d.length&&(u.left="w"===d.charAt(1)?h.left+h.width/2-15:h.left+h.width/2-i+15),l.css(u).addClass("tipsy-"+d),l.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+d.charAt(0),n.fade?l.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:n.opacity},n.fadeDuration):l.css({visibility:"visible",opacity:n.opacity}),l.css({"z-index":n.zIndex}),l.on("mouseenter",function(){o=a=!0,t(".tipsy").stop().fadeIn(100)}),l.on("mouseleave",function(){a=!1,r.events.trigger("intent_hide:tooltip")})},formatTooltipDate:function(t,e){var i;return i=t.start.getMonth()===t.finish.getMonth()?n.time.format("%a %d")(t[e]):t.start.getMonth()<t.finish.getMonth()&&t.start.getFullYear()===t.finish.getFullYear()?n.time.format("%d %b")(t[e]):t[e].toLocaleDateString()},dummy:{}});return u}),define("cellscollection",["jquery","underscore","backbone","d3","global"],function(t,e,n,i,r){var o=n.Model.extend({idAttribute:"_id",url:"/timeline/api/cells",url_visitors:"/timeline/api/cells/visitors",defaults:{_id:null,node_id:null,date:null,comments:[]},toJSON:function(){var t=e.clone(this.attributes);return t.date=i.time.format("%Y-%m-%d")(t.date),t},parse:function(t){return t.date=i.time.day(new Date(t.date.split("T")[0])),e.forEach(t.comments,function(t){t.created_at=new Date(t.created_at)}),t},addComment:function(t){var n=this,i=this,r=this.get("comments");r.push(t),this.sendingQueue||(this.sendingQueue=[]),this.sendingQueue.push(t),this.save({},{success:function(r,o){n.sendingQueue=n.sendingQueue.filter(function(e){return e!==t}),i.updateVisitor(e.last(e.where(o.comments,t)).created_at)}})},updateVisitor:function(e){var n=this;t.ajax({url:this.url_visitors,type:"PUT",data:JSON.stringify({cell_id:this.id,user:r.currentUser,seen_at:e}),dataType:"json",processData:!1,contentType:"application/json",success:function(t){n.seen_at=Routine.convertStrToDateWithTimezone(t.seen_at),n.collection.trigger("change")},error:function(){console.warn("cant save visit",arguments)}})}}),a=n.Collection.extend({model:o,url:"/timeline/api/cells",url_visitors:"/timeline/api/cells/visitors",initialize:function(){this.fetch({reset:!0,success:function(e){var n=function(n){t.ajax({url:e.url_visitors+"/"+n,contentType:"application/json; charset=utf-8",success:function(t){t.forEach(function(t){e.get(t.cell_id).seen_at=Routine.convertStrToDateWithTimezone(t.seen_at)}),e.trigger("change")},error:function(){console.warn("cant load visits",arguments)}})};r.currentUser?n(r.currentUser):r.events.on("userid:usermodel",n)},error:function(){console.log("cant fetch cells collection")}})}});return a}),define("commentsview",["jquery","underscore","backbone","d3","global","cellshelper","scrollhelper","bootstrap_contextmenu"],function(t,e,n,i,r,o,a,s){function u(t,e){return t+"_"+i.time.format("%Y-%m-%d")(e)}var l=n.View.extend({default_comment_id:null,default_operation:null,el:"#comments-container",template:t("#comments-widget-template").html(),template_comments_list:t("#comments-list-template").html(),template_cells:t("#cells-template").html(),template_add_comment:t("#cells-add-comment-template").html(),template_contextmenu:t("#contextmenu-comments-template").html(),events:{"blur textarea":"hideCellHighlight","focus textarea":"showCellHighlight","keypress textarea":"addCommentIfCtrlEnter","change textarea":"autoResize","keydown textarea":function(t){var e=this.autoResize;setTimeout(function(){e(t)},0)},"cut textarea":function(t){var e=this.autoResize;setTimeout(function(){e(t)},0)},"paste textarea":function(t){var e=this.autoResize;setTimeout(function(){e(t)},0)},"drop textarea":function(t){var e=this.autoResize;setTimeout(function(){e(t)},0)},"click .button-send":"onSendClick","click .button-close":"onCloseClick","click .title":"onTitleClick","click a.ttl":"onShowRequest","click .button-send-req":"onSendReqClick"},initialize:function(t){this.dataset=t.dataset,this.default_comment_id=null;var n=e.after(2,this.bindCellsToDataset);this.dataset.once("sync",n,this),this.collection.once("sync",n,this),this.initContextmenu(),this.listenTo(r.events,"click:canvas",this.onCanvasClick),this.listenTo(this.collection,"sync",this.render),this.listenTo(r.events,"zoomed panned resize scroll",this.renderCellHighlight),this.listenTo(r.events,"toggle:info-panel",this.onInfoPanelToggle),this.listenTo(r.events,"navigate:comment",this.onOpenComment),this.listenTo(r.events,"navigate:confirmplan",this.onConfirmPlanNav)},initContextmenu:function(){var n,i=this;t("#canvas").contextmenu({target:"#contextmenu",before:function(t){if(t.altKey)return!1;this.getMenu().find(".dropdown-menu").html(e.template(i.template_contextmenu));var r=i.getNode(t.pageY),o=i.getCell(r,i.getDate(t.pageX));return o.get("comments").find(function(t){return"requestplan"==t.type})&&this.getMenu().find(".dropdown-menu .request-plan").hide(),o.get("comments").find(function(t){return"confirmplan"==t.type})&&this.getMenu().find(".dropdown-menu .confirm-plan").hide(),n=t,t.preventDefault(),!0},onItem:function(e,r){i.default_operation="comment",t(r.target).hasClass("request-plan")?i.default_operation="request_plan":t(r.target).hasClass("confirm-plan")&&(i.default_operation="confirm_plan"),i.setRootCell(n)}})},render:function(){this.renderWidget(),this.renderCellHighlight()},renderWidget:function(){var t,n=this;if(this.rootCell){t=this.$el.find(">.cells-list").scrollTop();var i="";i=this.default_operation?e.template(this.template_add_comment,{cell:{cell_path:this.buildCellPath(this.rootCell.get("node_id")),cell_id:u(this.rootCell.get("node_id"),this.rootCell.get("date"))},edit_type:this.default_operation}):this.getCellsHtml(),this.$el.html(e.template(this.template,{date:this.rootCell.get("date"),cellsHtml:i})).show(),this.$el.find(">.cells-list").scrollTop(t),this.$el.find("textarea").focus();var r=this.$el.find(">.cells-list");r.scroll(function(){n.markVisibleCommentsAsRead(r)}),this.markVisibleCommentsAsRead(r)}else this.$el.hide()},getCellsHtml:function(){var t=this,n=[r.currentUser];return e.template(this.template_cells,{cells:[this.rootCell].concat(this.rootCell.childCells.sort(function(t,e){return t.id.length-e.id.length})).map(function(e){return{cell_path:t.buildCellPath(e.get("node_id")),cell_id:u(e.get("node_id"),e.get("date")),commentsListHtml:t.getCommentsListHtml(e,n),requestPlan:e.get("requestPlan"),confirmPlan:e.get("confirmPlan")}})})},getCommentsListHtml:function(t,n){var i,o=new Date(1983,1,1),a=this.getCellComments(t);return a.length?(i=e.last(a).user===r.currentUser?a.length:e.findIndex(a,function(e){return e.user!==r.currentUser&&e.created_at>(t.seen_at||o)}),e.template(this.template_comments_list,{comments:a,newCommentIndex:i,participants:n})):""},getCellComments:function(t){var n=t.sendingQueue||[];return e.chain(t.get("comments")).union(n).map(function(t){return e.extend({},t,{sending:n.indexOf(t)>-1})}).value()},markVisibleCommentsAsRead:function(e){var n=this,i=2e3,r=100;e.find(".comments-list").each(function(o){var a=t(this).find(".new-comment").filter(function(){var n=t(this),i=n.position().top+n.outerHeight();return i<=e.innerHeight()}).last();a.length&&setTimeout(function(){n.markAsRead(a)},i+o*r)})},renderCellHighlight:function(t){var e=i.select("#cell-highlight"),n=e.selectAll(".link").data([this.activeCell]),r=e.selectAll(".mark").data([this.activeCell]);if(this.activeCell&&!this.isCellHighlightHidden){var o=this.getCellDimensions(this.activeCell),a=this.getWidgetDimensions(),s=this.buildPathForLink(o,a);n.enter().append("g").attr("class","link").append("path"),n.selectAll("path").attr("d",s),r.enter().append("rect").attr("class","mark").attr("height",o.y[1]-o.y[0]),r.attr("x",o.x[0]).attr("y",o.y[0]).attr("width",o.x[1]-o.x[0])}else n.remove(),r.remove()},markAsRead:function(t){if(!t.data("marked-as-read")){t.data("marked-as-read",!0),t.prevAll(".new-comment").andSelf().removeClass("new-comment");var e=t.parent(".comments-list").prev(".title").data("cell-id");this.collection.get(e).updateVisitor(t.data("created-at"))}},showCellHighlight:function(){this.isCellHighlightHidden=!1,this.renderCellHighlight()},hideCellHighlight:function(){this.isCellHighlightHidden=!0,this.renderCellHighlight()},getCellDimensions:function(n){var i=e.find(t('.timelines-container[data-id="'+n.get("node_id")+'"]').find(".cell-badge"),function(t){return+t.__data__.date===+n.get("date")}),o=i?i.getBBox():{width:11,height:13},a=1,s=r.timeScale(n.get("date"))+r.utils.daysToPixels(1),u=s-o.width-a,l=this.dataset.getD3Data().yScale(n.node.i+1)-r.config.nodePadding/2,c=l-o.height-a;return{x:[u,s],y:[c,l]}},getWidgetDimensions:function(){var e=t("#comments-container"),n=e.position().left-5,i=n+e.outerWidth(),o=t(window).scrollTop()+r.config.height+56.5,a=o-e.outerHeight();return{x:[n,i],y:[a,o]}},buildPathForLink:function(t,e){var n=[];return t.x[0]<e.x[0]?(t.y[1]<e.y[1]?(n.push([t.x[0],t.y[1]]),n.push([e.x[0],e.y[1]])):(n.push([t.x[1],t.y[1]]),n.push([e.x[1],e.y[1]])),t.y[0]<e.y[0]?(n.push([e.x[1],e.y[0]]),n.push([t.x[1],t.y[0]])):(n.push([e.x[0],e.y[0]]),n.push([t.x[0],t.y[0]]))):t.x[0]>e.x[1]?(t.y[1]<e.y[1]?(n.push([t.x[1],t.y[1]]),n.push([e.x[1],e.y[1]])):(n.push([t.x[0],t.y[1]]),n.push([e.x[0],e.y[1]])),t.y[0]<e.y[0]?(n.push([e.x[0],e.y[0]]),n.push([t.x[0],t.y[0]])):(n.push([e.x[1],e.y[0]]),n.push([t.x[1],t.y[0]]))):t.y[0]<e.y[0]?(n.push([t.x[0],t.y[0]]),n.push([e.x[0],e.y[0]]),n.push([e.x[1],e.y[0]]),n.push([t.x[1],t.y[0]])):(n.push([t.x[0],t.y[1]]),n.push([e.x[0],e.y[1]]),n.push([e.x[1],e.y[1]]),n.push([t.x[1],t.y[1]])),"M"+n.map(function(t){return"L"+t[0]+","+t[1]}).join(" ").slice(1)},bindCellsToDataset:function(){this.dataset.set("cells",this.collection.models);var t=this;this.collection.on("change",function(){t.dataset.trigger("change")}),this.default_comment_id&&this.openComment(this.default_comment_id)},openComment:function(t){this.pointToCell(t),this.setRootCellByCell(this.getCellById(t));var e=t.split("_")[0];return r.events.trigger("comment:auto_open",e,!0),e},setRootCell:function(t){var e=this.getNode(t.pageY);e&&(this.setRootCellByNodeAndDate(e,this.getDate(t.pageX)),t.preventDefault())},setRootCellByNodeAndDate:function(t,e){this.$el.html(""),this.rootCell=this.activeCell=this.getCell(t,e),this.render()},setRootCellByCell:function(t){this.rootCell=this.activeCell=t,this.$el.html(""),this.render()},onCanvasClick:function(t){(t.target.classList.contains("cell-badge-clickable")||t.metaKey||t.ctrlKey)&&(this.default_operation=null,this.setRootCell(t))},onSendClick:function(){this.default_operation=null,this.addComment(),this.$el.find("textarea").focus()},onSendReqClick:function(e){this.default_operation=null;var n=t("textarea",t(e.target).parent()).val(),i=t(e.target).data("cell-id"),r=this.getCellById(i);"request"==t(e.target).data("operation")?this.addRequestPlan(r,n):this.addConfirmPlan(r,n),this.render()},onCloseClick:function(){this.rootCell=this.activeCell=void 0,this.render()},onInfoPanelToggle:function(t){this.$el.css({right:t?r.config.infoPanelWidth:r.config.infoPanelButtonWidth})},onOpenComment:function(t){this.default_comment_id=t,this.dataset.get("dataset")&&this.openComment(this.default_comment_id)},onShowRequest:function(e){var n=t(".more",t(e.target).parent());n.hasClass("hidden")?(n.hide().removeClass("hidden").slideDown(),t("textarea",n).focus()):n.slideUp(function(){n.addClass("hidden")})},onConfirmPlanNav:function(t){this.default_comment_id=t,this.default_operation="confirm_plan",this.dataset.get("dataset")&&this.openComment(t)},addCommentIfCtrlEnter:function(e){if((10===e.which||13===e.which)&&e.ctrlKey){if("comment"==this.default_operation)this.onSendClick();else{var n={target:t(e.currentTarget).parent().find(".button-send-req")[0]};this.onSendReqClick(n)}e.preventDefault()}},autoResize:function(e){t(e.target).css({height:"auto"}).height(e.target.scrollHeight-4)},addComment:function(){var t=this.$el.find(".add-comment-input:visible textarea"),e=t.val().trim();e.length&&(this.activeCell.addComment({user:r.currentUser,comment:e}),t.val(""),this.render()),t.closest(".comment-list").find(".new-comment").removeClass(".new-comment")},addRequestPlan:function(t,e){var n=t.get("comments").find(function(t){return"requestplan"==t.type});n||t.addComment({user:r.currentUser,comment:e||"",type:"requestplan"})},addConfirmPlan:function(t,e){var n=t.get("comments").find(function(t){return"confirmplan"==t.type});n||t.addComment({user:r.currentUser,comment:e||"",type:"confirmplan"})},getDate:function(t){return i.time.day(r.timeScale.invert(t-r.config.margin.left))},getNode:function(t){var e=this.dataset.getD3Data(),n=e.yScale.invert(t-r.config.margin.top+r.config.nodePadding/2);return e.nodes[Math.floor(n)]},getCell:function(t,n){var i=u(t.id,n),r=this.collection.get(i),a=e.filter(o.getInnerCellsForDatum(t,this.collection),function(t){return t!==r&&+t.get("date")===+n});return r||(r=this.collection.add({_id:i,node_id:t.id,date:n,comments:[]})),r.node=t,r.childCells=a,r},getCellById:function(t){var e=t.split("_")[0],n=r.utils.dayStringToDate(t.split("_")[1]),i=this.dataset.getNodeById(e);return this.getCell(i,n)},buildCellPath:function(t){return"."===t?" ":t.split("/").slice(1).join("<span>/</span>")},onTitleClick:function(e){var n=t(e.target).closest(".title").data("cell-id");this.pointToCell(n)},pointToCell:function(t,e){var n=this,i=t.split("_")[0],r=function(){n.flashCell(t),e&&e()};a.pointToNode(i,r)},flashCell:function(t){var e,n=this.getCellById(t),o=this.getCellDimensions(n),a=o.x[1]-o.x[0],s=o.y[1]-o.y[0],u=77,l={x:o.x[0],y:o.y[0],width:a,height:s,opacity:.8},c={x:l.x-u,y:l.y-u,width:l.width+2*u,height:l.height+2*u,opacity:1e-6,rx:u,ry:u};e=i.select("#main").append("rect").attr("id","cell-flash").attr(l),e.transition().duration(r.config.duration).ease("circle-out").attr(c).remove()},dummy:null});return l}),define("infoblockordergroups",["underscore","global","datahelper"],function(t,e,n){var i=function(t){return"["+t.sector_id+"] "+e.appView.model.get("sector_names")[t.sector_name_id]},r=t.curry(function(e,n){return n.dateRange.plan&&n.dateRange.plan.finish>=t.first(e)&&n.dateRange.plan.start<=t.last(e)}),o={buildOrderList:function(o,a){if(!o.length)return[];var s={},u={};return n(e.appView.model.getD3Data().dataset).forEach("order",function(e){switch(a){case"work_types":t(e.nodes).filter(r(o)).forEach(function(t){s[t.name]||(s[t.name]=[]),s[t.name].push({path:e.id+"/"+t.name,name:e.name})});break;case"sectors":t.forEach(e.nodes,function(n){t(n.nodes).filter(r(o)).forEach(function(t){var r=i(t);s[r]||(s[r]=[]),s[r].push({name:e.name,subname:t.name,path:t.id}),u[r]=n.name})})}}),t.map(s,function(t,n){return{name:n,subname:u[n],items:t.sort(function(t,n){return e.utils.sortOrderNames(t.name,n.name)})}}).sort(function(t,e){var n=function(t){return t.name.split("]")[0].slice(1)};return"sectors"===a?n(t)-n(e):t.name.localeCompare(e.name)})}};return o}),define("infoblockview",["underscore","backbone","global","scrollhelper","datahelper","infoblockordergroups"],function(t,e,n,i,r,o){var a=e.View.extend({tagName:"div",className:"info-block",template:$("#info-block-template").html(),events:{"click .path":"onPathClick","click .node-link":"onNodeLinkClick","click .grouping .btn-group .btn":"onGroupingClick","click .i-notify":"onNotifyClick"},initialize:function(){this.listenTo(n.events,"selector:model",this.render)},render:function(){var e=n.appView.model.getNodeById(this.model.id);return this.$el.html(t.template(this.template,{nodeId:this.model.id,selDate:this.model.get("selDate"),G:n,dateRange:this.model.get("range")||[],need_notification:!!e&&e.need_notification,orderList:o.buildOrderList(this.model.get("range"),this.model.get("groupType")),activeGrouping:this.model.get("groupType")})),this.model.id&&n.events.trigger("render:info-block",this.$el.find(".widgets-container"),this.model),this},remove:function(){e.View.prototype.initialize.apply(this,arguments),n.events.trigger("remove:info-block",this.model)},onGroupingClick:function(t){var e=$(t.target).data("type");this.model.set("groupType",e),n.events.trigger("change:grouping-type",e),this.render()},onPathClick:function(){this.pointToNode(this.model.id)},onNodeLinkClick:function(t){this.pointToNode($(t.target).closest(".node-link").data("path"))},pointToNode:function(t){var e=function(){n.appView.nodesView.flashNode(t)};i.pointToNode(t,e)},onNotifyClick:function(t){function e(t){var n=[];for(var i in t.nodes)"workorder"==t.nodes[i].node_type&&n.push(t.nodes[i].name),n=n.concat(e(t.nodes[i]));return n}var i=this;t.preventDefault();var r=n.appView.model.getNodeById(this.model.id);n.events.trigger("start:loading"),$.ajax({type:"POST",url:"/timeline/api/update_need_notification",data:JSON.stringify({id:r.id,node_type:r.node_type,need_notification:!r.need_notification,work_orders:e(r)}),timeout:35e3,contentType:"application/json",dataType:"json",async:!0}).done(function(t){"ok"==t.status?(r.need_notification=!r.need_notification,i.render(),setTimeout(function(){n.events.trigger("change:need_notification",{node_id:i.model.id,need_notification:r.need_notification})},100)):alert("  . : "+t.msg)}).always(function(){n.events.trigger("stop:loading")})}});return a}),define("materialsmodel",["jquery","backbone","global"],function(t,e,n){var i=e.Model.extend({url_root_work:n.config.materials_by_work_url,url_root_workorder:n.config.materials_by_workorder_url,initialize:function(t){this.nodeId=t.nodeId,this.loadMaterials()},sync:function(e,n,i){var r=i.xhr=t.ajax(i);n.trigger("request",n,r,i)},loadMaterials:function(){var t=n.appView.model.getNodeById(this.nodeId)||{},e=t.sector_id,i=t.work_code;this.hasMaterials=!0,e&&i?this.fetch({url:this.url_root_work+"/"+e+"/"+i,success:function(t,e){try{t.set("materials",e),t.set("node_type",""),t.set("code",i)}catch(e){n.utils.logException(e),t.trigger("error",{code:1,exception:e})}},error:function(t){t.trigger("error",arguments)}}):4===t.depth?this.fetch({url:this.url_root_workorder+"/"+t.name,success:function(t,e){try{t.set("materials",e),t.set("node_type",""),t.set("code",i.name)}catch(i){n.utils.logException(i),t.trigger("error",{code:1,exception:i})}},error:function(t){t.trigger("error",arguments)}}):this.hasMaterials=!1},dummy:null});return i}),define("planshiftshelper",["underscore"],function(t){var e={hasPlanShifts:function(t){return t.plan_shifts||t.dateRange.plan_before_last_shift&&(+t.dateRange.plan_before_last_shift.start!==+t.dateRange.plan.start||+t.dateRange.plan_before_last_shift.finish!==+t.dateRange.plan.finish)},getLastShiftInWork:function(e){return t.last(e.plan_shifts)},dummy:void 0};return e}),!function(t){function e(t,e){return function(n){return u(t.call(this,n),e)}}function n(t,e){return function(n){return this.lang().ordinal(t.call(this,n),e)}}function i(){}function r(t){a(this,t)}function o(t){var e=t.years||t.year||t.y||0,n=t.months||t.month||t.M||0,i=t.weeks||t.week||t.w||0,r=t.days||t.day||t.d||0,o=t.hours||t.hour||t.h||0,a=t.minutes||t.minute||t.m||0,s=t.seconds||t.second||t.s||0,u=t.milliseconds||t.millisecond||t.ms||0;this._input=t,this._milliseconds=u+1e3*s+6e4*a+36e5*o,this._days=r+7*i,this._months=n+12*e,this._data={},this._bubble()}function a(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function s(t){return 0>t?Math.ceil(t):Math.floor(t)}function u(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}function l(t,e,n,i){var r,o,a=e._milliseconds,s=e._days,u=e._months;a&&t._d.setTime(+t._d+a*n),(s||u)&&(r=t.minute(),o=t.hour()),s&&t.date(t.date()+s*n),u&&t.month(t.month()+u*n),a&&!i&&j.updateOffset(t),(s||u)&&(t.minute(r),t.hour(o))}function c(t){return"[object Array]"===Object.prototype.toString.call(t)}function f(t,e){var n,i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0;for(n=0;i>n;n++)~~t[n]!==~~e[n]&&o++;return o+r}function h(t){return t?rt[t]||t.toLowerCase().replace(/(.)s$/,"$1"):t}function d(t,e){return e.abbr=t,H[t]||(H[t]=new i),H[t].set(e),H[t]}function p(t){if(!t)return j.fn._lang;if(!H[t]&&L)try{require("./lang/"+t)}catch(t){return j.fn._lang}return H[t]}function g(t){return t.match(/\[.*\]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function m(t){var e,n,i=t.match(q);for(e=0,n=i.length;n>e;e++)i[e]=ut[i[e]]?ut[i[e]]:g(i[e]);return function(r){var o="";for(e=0;n>e;e++)o+=i[e]instanceof Function?i[e].call(r,t):i[e];return o}}function v(t,e){function n(e){return t.lang().longDateFormat(e)||e}for(var i=5;i--&&F.test(e);)e=e.replace(F,n);return ot[e]||(ot[e]=m(e)),ot[e](t)}function y(t,e){switch(t){case"DDDD":return B;case"YYYY":return W;case"YYYYY":return U;case"S":case"SS":case"SSS":case"DDD":return V;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return G;case"a":case"A":return p(e._l)._meridiemParse;case"X":return Z;case"Z":case"ZZ":return X;case"T":return Q;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return Y;default:return new RegExp(t.replace("\\",""))}}function b(t){var e=(X.exec(t)||[])[0],n=(e+"").match(et)||["-",0,0],i=+(60*n[1])+~~n[2];return"+"===n[0]?-i:i}function w(t,e,n){var i,r=n._a;switch(t){case"M":case"MM":r[1]=null==e?0:~~e-1;break;case"MMM":case"MMMM":i=p(n._l).monthsParse(e),null!=i?r[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=e&&(r[2]=~~e);break;case"YY":r[0]=~~e+(~~e>68?1900:2e3);break;case"YYYY":case"YYYYY":r[0]=~~e;break;case"a":case"A":n._isPm=p(n._l).isPM(e);break;case"H":case"HH":case"h":case"hh":r[3]=~~e;break;case"m":case"mm":r[4]=~~e;break;case"s":case"ss":r[5]=~~e;break;case"S":case"SS":case"SSS":r[6]=~~(1e3*("0."+e));break;case"X":n._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=b(e)}null==e&&(n._isValid=!1)}function _(t){var e,n,i=[];if(!t._d){for(e=0;7>e;e++)t._a[e]=i[e]=null==t._a[e]?2===e?1:0:t._a[e];i[3]+=~~((t._tzm||0)/60),i[4]+=~~((t._tzm||0)%60),n=new Date(0),t._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),t._d=n}}function x(t){var e,n,i=t._f.match(q),r=t._i;for(t._a=[],e=0;e<i.length;e++)n=(y(i[e],t).exec(r)||[])[0],n&&(r=r.slice(r.indexOf(n)+n.length)),ut[i[e]]&&w(i[e],n,t);r&&(t._il=r),t._isPm&&t._a[3]<12&&(t._a[3]+=12),t._isPm===!1&&12===t._a[3]&&(t._a[3]=0),_(t)}function k(t){var e,n,i,o,s,u=99;for(o=0;o<t._f.length;o++)e=a({},t),e._f=t._f[o],x(e),n=new r(e),s=f(e._a,n.toArray()),n._il&&(s+=n._il.length),u>s&&(u=s,i=n);a(t,i)}function M(t){var e,n=t._i,i=J.exec(n);if(i){for(t._f="YYYY-MM-DD"+(i[2]||" "),e=0;4>e;e++)if(tt[e][1].exec(n)){t._f+=tt[e][0];break}X.exec(n)&&(t._f+=" Z"),x(t)}else t._d=new Date(n)}function S(e){var n=e._i,i=z.exec(n);n===t?e._d=new Date:i?e._d=new Date(+i[1]):"string"==typeof n?M(e):c(n)?(e._a=n.slice(0),_(e)):e._d=new Date(n instanceof Date?+n:n)}function T(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function C(t,e,n){var i=I(Math.abs(t)/1e3),r=I(i/60),o=I(r/60),a=I(o/24),s=I(a/365),u=45>i&&["s",i]||1===r&&["m"]||45>r&&["mm",r]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",I(a/30)]||1===s&&["y"]||["yy",s];return u[2]=e,u[3]=t>0,u[4]=n,T.apply({},u)}function D(t,e,n){var i,r=n-e,o=n-t.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=j(t).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function E(t){var e=t._i,n=t._f;return null===e||""===e?null:("string"==typeof e&&(t._i=e=p().preparse(e)),j.isMoment(e)?(t=a({},e),t._d=new Date(+e._d)):n?c(n)?k(t):x(t):S(t),new r(t))}function N(t,e){j.fn[t]=j.fn[t+"s"]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),j.updateOffset(this),this):this._d["get"+n+e]()}}function $(t){j.duration.fn[t]=function(){return this._data[t]}}function A(t,e){j.duration.fn["as"+t]=function(){return+this/e}}for(var j,P,R="2.1.0",I=Math.round,H={},L="undefined"!=typeof module&&module.exports,z=/^\/?Date\((\-?\d+)/i,O=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,q=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Y=/\d\d?/,V=/\d{1,3}/,B=/\d{3}/,W=/\d{1,4}/,U=/[+\-]?\d{1,6}/,G=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,X=/Z|[\+\-]\d\d:?\d\d/i,Q=/T/i,Z=/[\+\-]?\d+(\.\d{1,3})?/,J=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,K="YYYY-MM-DDTHH:mm:ssZ",tt=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],et=/([\+\-]|\d\d)/gi,nt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),it={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},rt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},ot={},at="DDD w W M D d".split(" "),st="M D H h m s w W".split(" "),ut={M:function(){return this.month()+1},MMM:function(t){return this.lang().monthsShort(this,t)},MMMM:function(t){return this.lang().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.lang().weekdaysMin(this,t)},ddd:function(t){return this.lang().weekdaysShort(this,t)},dddd:function(t){return this.lang().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return u(this.year()%100,2)},YYYY:function(){return u(this.year(),4)},YYYYY:function(){return u(this.year(),5)},gg:function(){return u(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return u(this.weekYear(),5)},GG:function(){return u(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return u(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return u(~~(this.milliseconds()/10),2)},SSS:function(){return u(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+u(~~(t/60),2)+":"+u(~~t%60,2)},ZZ:function(){var t=-this.zone(),e="+";

return 0>t&&(t=-t,e="-"),e+u(~~(10*t/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};at.length;)P=at.pop(),ut[P+"o"]=n(ut[P],P);for(;st.length;)P=st.pop(),ut[P+P]=e(ut[P],2);for(ut.DDDD=e(ut.DDD,3),i.prototype={set:function(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,n,i;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(n=j([2e3,e]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[e]=new RegExp(i.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(n=j([2e3,1]).day(e),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var n=this._calendar[t];return"function"==typeof n?n.apply(e):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(t,e,n,i):r.replace(/%d/i,t)},pastFuture:function(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return D(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},j=function(t,e,n){return E({_i:t,_f:e,_l:n,_isUTC:!1})},j.utc=function(t,e,n){return E({_useUTC:!0,_isUTC:!0,_l:n,_i:t,_f:e})},j.unix=function(t){return j(1e3*t)},j.duration=function(t,e){var n,i,r=j.isDuration(t),a="number"==typeof t,s=r?t._input:a?{}:t,u=O.exec(t);return a?e?s[e]=t:s.milliseconds=t:u&&(n="-"===u[1]?-1:1,s={y:0,d:~~u[2]*n,h:~~u[3]*n,m:~~u[4]*n,s:~~u[5]*n,ms:~~u[6]*n}),i=new o(s),r&&t.hasOwnProperty("_lang")&&(i._lang=t._lang),i},j.version=R,j.defaultFormat=K,j.updateOffset=function(){},j.lang=function(t,e){return t?(e?d(t,e):H[t]||p(t),void(j.duration.fn._lang=j.fn._lang=p(t))):j.fn._lang._abbr},j.langData=function(t){return t&&t._lang&&t._lang._abbr&&(t=t._lang._abbr),p(t)},j.isMoment=function(t){return t instanceof r},j.isDuration=function(t){return t instanceof o},j.fn=r.prototype={clone:function(){return j(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return v(j(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!f(this._a,(this._isUTC?j.utc(this._a):j(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(t){var e=v(this,t||j.defaultFormat);return this.lang().postformat(e)},add:function(t,e){var n;return n="string"==typeof t?j.duration(+e,t):j.duration(t,e),l(this,n,1),this},subtract:function(t,e){var n;return n="string"==typeof t?j.duration(+e,t):j.duration(t,e),l(this,n,-1),this},diff:function(t,e,n){var i,r,o=this._isUTC?j(t).zone(this._offset||0):j(t).local(),a=6e4*(this.zone()-o.zone());return e=h(e),"year"===e||"month"===e?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-j(this).startOf("month")-(o-j(o).startOf("month")))/i,r-=6e4*(this.zone()-j(this).startOf("month").zone()-(o.zone()-j(o).startOf("month").zone()))/i,"year"===e&&(r/=12)):(i=this-o,r="second"===e?i/1e3:"minute"===e?i/6e4:"hour"===e?i/36e5:"day"===e?(i-a)/864e5:"week"===e?(i-a)/6048e5:i),n?r:s(r)},from:function(t,e){return j.duration(this.diff(t)).lang(this.lang()._abbr).humanize(!e)},fromNow:function(t){return this.from(j(),t)},calendar:function(){var t=this.diff(j().startOf("day"),"days",!0),e=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){var t=this.year();return 0===t%4&&0!==t%100||0===t%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?"string"==typeof t&&(t=this.lang().weekdaysParse(t),"number"!=typeof t)?this:this.add({d:t-e}):e},month:function(t){var e,n=this._isUTC?"UTC":"";return null!=t?"string"==typeof t&&(t=this.lang().monthsParse(t),"number"!=typeof t)?this:(e=this.date(),this.date(1),this._d["set"+n+"Month"](t),this.date(Math.min(e,this.daysInMonth())),j.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(t){switch(t=h(t)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),this},endOf:function(t){return this.startOf(t).add(t,1).subtract("ms",1)},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+j(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+j(t).startOf(e)},isSame:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)===+j(t).startOf(e)},min:function(t){return t=j.apply(null,arguments),this>t?this:t},max:function(t){return t=j.apply(null,arguments),t>this?this:t},zone:function(t){var e=this._offset||0;return null==t?this._isUTC?e:this._d.getTimezoneOffset():("string"==typeof t&&(t=b(t)),Math.abs(t)<16&&(t*=60),this._offset=t,this._isUTC=!0,e!==t&&l(this,j.duration(e-t,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return j.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(t){var e=I((j(this).startOf("day")-j(this).startOf("year"))/864e5)+1;return null==t?e:this.add("d",t-e)},weekYear:function(t){var e=D(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==t?e:this.add("y",t-e)},isoWeekYear:function(t){var e=D(this,1,4).year;return null==t?e:this.add("y",t-e)},week:function(t){var e=this.lang().week(this);return null==t?e:this.add("d",7*(t-e))},isoWeek:function(t){var e=D(this,1,4).week;return null==t?e:this.add("d",7*(t-e))},weekday:function(t){var e=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==t?e:this.add("d",t-e)},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},lang:function(e){return e===t?this._lang:(this._lang=p(e),this)}},P=0;P<nt.length;P++)N(nt[P].toLowerCase().replace(/s$/,""),nt[P]);N("year","FullYear"),j.fn.days=j.fn.day,j.fn.months=j.fn.month,j.fn.weeks=j.fn.week,j.fn.isoWeeks=j.fn.isoWeek,j.fn.toJSON=j.fn.toISOString,j.duration.fn=o.prototype={_bubble:function(){var t,e,n,i,r=this._milliseconds,o=this._days,a=this._months,u=this._data;u.milliseconds=r%1e3,t=s(r/1e3),u.seconds=t%60,e=s(t/60),u.minutes=e%60,n=s(e/60),u.hours=n%24,o+=s(n/24),u.days=o%30,a+=s(o/30),u.months=a%12,i=s(a/12),u.years=i},weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(t){var e=+this,n=C(e,!t,this.lang());return t&&(n=this.lang().pastFuture(e,n)),this.lang().postformat(n)},add:function(t,e){var n=j.duration(t,e);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(t,e){var n=j.duration(t,e);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(t){return t=h(t),this[t.toLowerCase()+"s"]()},as:function(t){return t=h(t),this["as"+t.charAt(0).toUpperCase()+t.slice(1)+"s"]()},lang:j.fn.lang};for(P in it)it.hasOwnProperty(P)&&(A(P,it[P]),$(P.toLowerCase()));A("Weeks",6048e5),j.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},j.lang("en",{ordinal:function(t){var e=t%10,n=1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),L&&(module.exports=j),"undefined"==typeof ender&&(this.moment=j),"function"==typeof define&&define.amd&&define("moment",[],function(){return j})}.call(this),define("infoblockwidgets",["jquery","underscore","d3","backbone","global","materialsmodel","workstatushelper","planshiftshelper","datahelper","moment"],function(t,e,n,i,r,o,a,s,u,l){function c(t,n){var i=[];return["plan","contract_plan","fact"].forEach(function(r){if(t[r]){var o=t[r],a={key:r};if(o){a.dates=[o.start],+o.start!==+o.finish&&a.dates.push(o.finish);var s=Math.round(1+(o.finish-o.start)/1e3/60/60/24),u=e.reduce(n[r],function(t,e){return t+Math.round(1+(e.finish-e.start)/1e3/60/60/24)},0);a.duration=s,a.productiveDays=u,a.unproductiveDays=s-u}i.push(a)}}),i}var f={init:function(){r.events.on("render:info-block",function(t,e){b.forEach(function(n){var i=new n({nodeId:e.id,$container:t});i.listenTo(r.events,"remove:info-block",function(t){t.id===i.nodeId&&i.remove()}),i.render()})})}},h=i.View.extend({tagName:"div",initialize:function(t){this.nodeId=t.nodeId,this.$container=t.$container}}),d=h.extend({className:"widget dates",template:t("#dates-widget-template").html(),initialize:function(){h.prototype.initialize.apply(this,arguments),this.listenTo(r.appView.model,"change",this.render)},render:function(){var n=r.appView.model.getExistingNodeByQuery(r.appView.model.source_dataset,this.nodeId),i=c(n.dateRange,n.dateIntervals),o=this.calculateWorksWithPublishDates(n);this.$el.html(e.template(this.template,{dateRanges:i,worksWithPublishDates:o,pluralForm:r.utils.pluralForm})),t.contains(this.$container[0],this.el)||this.$container.append(this.$el)},calculateWorksWithPublishDates:function(t){function n(t){var e=r.utils.dayStringToDate(t.plan_publish_date),n=r.utils.dayStringToDate(t.plan_before_shift.start);return Math.round((n-e)/1e3/60/60/24)}var i=[];return u(t).forEach("work",function(t){if(t.plan_publish_date){var e=n(t);i.push(e)}}),e.uniq(i)}}),p=h.extend({className:"widget contract-dates",template:t("#contract-dates-widget-template").html(),initialize:function(){h.prototype.initialize.apply(this,arguments),this.listenTo(r.appView.model,"change",this.render)},render:function(){var n=r.appView.model.getExistingNodeByQuery(r.appView.model.source_dataset,this.nodeId);if("contract"===n.node_type){var i=this.calculateWorkTypes(n);this.$el.html(e.template(this.template,{workTypes:i,pluralForm:r.utils.pluralForm})),t.contains(this.$container[0],this.el)||this.$container.append(this.$el)}else this.$el.hide();return this},calculateWorkTypes:function(t){var n={};return u(t).forEach("work_type",function(t){this.accumulateWorkTypeDates(n,t.name,t.dateRange,t.dateIntervals)},this),u(t).forEach("workorder",{filter:"troubleshooting",callback:function(t){this.accumulateWorkTypeDates(n,"troubleshooting",t.dateRange,t.dateIntervals)}},this),e.pluck(n,"dateIntervals").map(r.utils.flattenIntervals),e.map(n,function(t,e){return{name:e,dateRanges:c(t.dateRange,t.dateIntervals)}})},accumulateWorkTypeDates:function(t,e,n,i){var o=t[e]||{dateRange:{},dateIntervals:{}};n.plan&&(o.dateRange.plan=r.utils.extentDate(o.dateRange.plan,n.plan),o.dateIntervals.plan||(o.dateIntervals.plan=[]),i.plan&&o.dateIntervals.plan.push(i.plan.map(r.utils.cloneDates))),n.fact&&(o.dateRange.fact=r.utils.extentDate(o.dateRange.fact,n.fact),o.dateIntervals.fact||(o.dateIntervals.fact=[]),i.fact&&o.dateIntervals.fact.push(i.fact.map(r.utils.cloneDates))),t[e]=o}}),g=h.extend({className:"widget settings",templates:{container:t("#settings-data-container").html(),main:t("#settings-data").html()},initialize:function(){h.prototype.initialize.apply(this,arguments),this.listenTo(r.appView.model,"change",this.render)},render:function(){if(this.lastNodeId!=this.nodeId){this.lastNodeId=this.nodeId,this.$el.html(e.template(this.templates.container));var n=r.appView.model.getNodeById(this.nodeId);n&&(n.settings?"work"===n.node_type?this.showSettings(n):n.have_different_settings?this.showDifferentSettingsMsg(n):this.showSettings(n):this.showNoSettingsMsg(),t.contains(this.$container[0],this.el)||this.$container.append(this.$el))}},showSettings:function(t){this.$el.find(".data-body").html(e.template(this.templates.main,t.settings))},showNoSettingsMsg:function(){this.$el.find(".data-body").html('<li class="empty">  </li>')},showDifferentSettingsMsg:function(){this.$el.find(".data-body").html('<li class="empty"> (. )</li>')}}),m=h.extend({className:"widget plan-shift",templates:{move:t("#plan-shift-move-widget-template").html(),resize:t("#plan-shift-resize-widget-template").html(),all:t("#plan-shift-all-data").html(),all_item:t("#plan-shift-all-item").html(),group:t("#plan-shift-all-data-group").html()},events:{"click .lnk-show-all-shift-moves":"showAllShiftMoves","click .lnk-show-all-shift-resizes":"showAllShiftMoves"},initialize:function(){h.prototype.initialize.apply(this,arguments),this.listenTo(r.appView.model,"change",this.render)},render:function(){if(this.lastNodeId!=this.nodeId){this.lastNodeId=this.nodeId;var e=r.appView.model.getNodeById(this.nodeId);e&&(s.hasPlanShifts(e)||a.hasStatus(e,"on_hold")||a.hasStatus(e,"on_pause")||a.hasStatus(e,"on_work_with_reject")?"work"===e.node_type?this.showAllShiftMoves():this.showGroupShiftMoves():this.$el.hide(),t.contains(this.$container[0],this.el)||this.$container.append(this.$el))}},showGroupShiftMoves:function(){var t=r.appView.model.getNodeById(this.nodeId);this.clear();var n={all_count:0,last_date:null,user_email:""},i=this.getWorksWithShifts(t);i&&e.forEach(i,function(t){n.all_count+=t.plan_shifts.length;var e=s.getLastShiftInWork(t);(!n.last_date||n.last_date<l.utc(e.date_change,"YYYY-MM-DD HH:mm:ss").local())&&(n.last_date=l.utc(e.date_change,"YYYY-MM-DD HH:mm:ss").local(),n.user_email=e.user_email)}),n.all_statuses=e.reduce(["on_hold","on_pause","on_work_with_reject"],function(e,n){return e+a.calculateWorksWithStatus(t,n)},0),(n.all_count>0||n.all_statuses)&&(this.$el.html(e.template(this.templates.group,n)),this.$el.find(".data-body"))},showAllShiftMoves:function(){function t(t,e,n){var i={start:"   ",finish:" ",both:"   "},r={date_str:null,transfer_type:null,note:"",reason:"",reason_nodes:null,shift:0,old_date_start:null,old_date_finish:null,new_date_start:null,new_date_finish:null,dates_note:"",durations_note:"",user_email:"",date_change:null,type:"correction",shift_days:0};r.date_change=n.date_change,r.user_email=n.user_email,r.date_str=l.utc(n.date_change,"YYYY-MM-DD HH:mm:ss").local().format("DD.MM.YYYY HH:mm"),r.transfer_type=i[n.type],r.note=n.note,r.reason=n.reason,r.reason_nodes="reason_nodes"in n?n.reason_nodes:null,r.shift=n.shift,r.old_date_start=t,r.old_date_finish=e,r.new_date_start=l(t),r.new_date_finish=l(e);var o=e.diff(t,"days"),a=0;switch(n.type){case"start":r.new_date_finish.add(n.shift_finish,"days"),r.new_date_start.add(n.shift,"days"),n.shift>0?(r.transfer_type="   ",r.durations_note=": +"+n.shift.toString()+" . : "+(n.shift_finish>0?"+":"")+n.shift_finish.toString()+"."):(r.durations_note=": "+n.shift.toString()+" . : "+n.shift_finish.toString()+".",r.transfer_type="   ");break;case"finish":r.new_date_start=t,r.new_date_finish.add(n.shift,"days"),n.shift<0?(r.transfer_type=" ",r.durations_note=": 0 . : "+n.shift.toString()+" ."):(r.transfer_type=" ",r.durations_note=": 0 . : +"+n.shift.toString()+" .");break;case"both":r.new_date_start.add(n.shift,"days"),r.new_date_finish.add(n.shift,"days"),r.durations_note=n.shift>0?": +"+n.shift.toString()+" . : +"+n.shift.toString()+" .":": "+n.shift.toString()+" . : "+n.shift.toString()+" .";break;default:r.new_date_start=t,r.new_date_finish=e,r.durations_note=": 0 . : 0 ."}return"both"==n.type?r.shift_days=n.shift:(a=r.new_date_finish.diff(r.new_date_start,"days"),r.shift_days=a-o),r.dates_note="- : "+t.format("DD.MM.YYYY")+"-"+e.format("DD.MM.YYYY")+";<br/>- : "+r.new_date_start.format("DD.MM.YYYY")+"-"+r.new_date_finish.format("DD.MM.YYYY"),r}var n=this;this.clear(),this.$el.html(e.template(this.templates.all));var i=this.$el.find(".data-body"),o=r.appView.model.getNodeById(this.nodeId),u=[];if(s.hasPlanShifts(o)){o.plan_shifts.sort(function(t,e){return l.utc(t.date_change,"YYYY-MM-DD HH:mm:ss.ms").local()-l.utc(e.date_change,"YYYY-MM-DD HH:mm:ss.ms").local()});var c=l(o.plan_before_shift.start,"YYYY-MM-DD").local(),f=l(o.plan_before_shift.finish,"YYYY-MM-DD").local();e.forEach(o.plan_shifts,function(e){var n=t(c,f,e);c=n.new_date_start,f=n.new_date_finish,u.push(n)})}var h=0;["on_pause","on_hold","on_work_with_reject"].forEach(function(t){e.forEach(a.getWorksWithStatus(o,t),function(t){t.type="status",t.date_str=l.utc(t.date_change,"YYYY-MM-DD HH:mm:ss").local().format("DD.MM.YYYY HH:mm"),t.date_status_str=l.utc(t.date,"YYYY-MM-DD HH:mm:ss").local().format("DD.MM.YYYY"),u.push(t),++h})}),this.$el.find(".lbl-total-shifts").html(": "+(o.plan_shifts?o.plan_shifts.length.toString():"0")+(h>0?"<br/>: "+h:"")),u.sort(function(t,e){return l.utc(e.date_change,"YYYY-MM-DD HH:mm:ss.ms").local()-l.utc(t.date_change,"YYYY-MM-DD HH:mm:ss.ms").local()});for(var d in u)i.append(e.template(n.templates.all_item,u[d]))},renderPlanShifts:function(t){var n,i,o=e.chain(["start","finish"]).zipObject().mapValues(function(e,n){return Math.round((t.dateRange.plan[n]-t.dateRange.plan_before_last_shift[n])/1e3/60/60/24)}).value();o.start===o.finish?(i="move",n=this.getDataForMoveTemplate(t),n.delta=o.start):(i="resize",n=this.getDataForResizeTemplate(t),n.delta=o),n.total="work"===t.node_type?t.plan_shifts.length:void 0,n.pluralForm=r.utils.pluralForm,this.$el.html(e.template(this.templates[i],n)).show()},getDataForMoveTemplate:function(t){var e={},n=this.getSharedShift(t);return n?(e.reason=n.reason,e.reason_nodes=n.reason_nodes,e.note=n.note,e.last_shift_date=n.date_change,e.inside=void 0):(e.last_shift_date=void 0,e.inside=this.getWorksWithShifts(t).length),e},getDataForResizeTemplate:function(t){var n=this,i={},o={},a=this.getSharedShift(t);return a&&(o[a.type]={reason:a.reason,reason_nodes:a.reason_nodes,note:a.note,delta:a.shift,last_shift_date:a.date_change},i.inside=void 0),["start","finish"].forEach(function(e){var i=t.dateRange.plan_before_last_shift[e],a=t.dateRange.plan[e];if(+i!==+a){if(!o[e])if("work"===t.node_type){var s=r.appView.model.getInfoPlanShift(t,e).planShift;o[e]={reason:s.reason,reason_nodes:s.reason_nodes,note:s.note,last_shift_date:s.date_change}}else o[e]={inside:n.getWorksWithShifts(t).length};o[e].before=i,o[e].after=a}}),i.shifts=e.map(o,function(t,e){return t.key=e,t}),i},getSharedShift:function(t){var n=this,i=e.filter(this.getWorksInsideNode(t),function(t){return t.plan}),r=this.getWorksWithShifts(t),o=null;return i.length===r.length&&e.forEach(r,function(t){var i=s.getLastShiftInWork(t);return o||(o=i),!n.equalShifts(o,i)||"both"!==i.type&&e.any(t.plan_shifts,function(t){return t.type!==i.type})?(o=null,!1):void 0}),o},getWorksInsideNode:function(t){var n=[],i=function(t){"work"===t.node_type?n.push(t):e.forEach(t.nodes,i)};return i(t),n},getWorksWithShifts:function(t){var n=this.getWorksInsideNode(t),i=e.filter(n,function(t){return t.plan_shifts&&t.plan_shifts.length});return i},equalShifts:function(t,e){return t.type===e.type&&t.reason===e.reason&&t.note===e.note&&t.shift===e.shift},clear:function(){this.$el.empty()},dummy:void 0}),v=(h.extend({className:"widget statuses",template:t("#statuses-widget-template").html(),sub_templates:{no_data:t("#statuses-nodata-widget-template").html(),on_hold:t("#statuses-onhold-onpause-widget-template").html(),on_pause:t("#statuses-onhold-onpause-widget-template").html(),on_work_with_reject:t("#statuses-onhold-onpause-widget-template").html()},initialize:function(){h.prototype.initialize.apply(this,arguments),this.today=n.time.day(new Date),this.listenTo(r.appView.model,"change",this.render),this.listenTo(r.events,"highlight:day",this.onDayChange)},render:function(){this.node=r.appView.model.getNodeById(this.nodeId);var n=this.getCurrentDate(),i=this.collectStatusesByDate(r.appView.dayHighlightView.theDay),o=this.collectStatusesTotal();o.length?(this.$el.html(e.template(this.template,{date:n,totalStatuses:o,byDateStatuses:i,pluralForm:r.utils.pluralForm})).show(),this.renderSubViews(i)):this.$el.hide(),t.contains(this.$container[0],this.el)||this.$container.append(this.$el)},renderSubViews:function(t){var n=this,i="";t.forEach(function(t){i+=e.template(n.sub_templates[t.key],{key:t.key,info:t.info,pluralForm:r.utils.pluralForm})}),this.$el.find(".statuses-container").append(i)},collectStatusesByDate:function(t){if(this.node){var e=this;return["on_pause","on_hold","no_data","on_work_with_reject"].map(function(n){return{key:n,info:a.getInfoAboutStatus(e.node,t,n)}}).filter(function(t){return t.info})}return[]},collectStatusesTotal:function(){if(this.node){var t=this;return["on_pause","on_hold","no_data","on_work_with_reject"].map(function(e){return{key:e,count:a.calculateWorksWithStatus(t.node,e)}}).filter(function(t){return t.count})}return[]},onDayChange:function(){this.render()},getCurrentDate:function(){return r.appView.dayHighlightView.theDay},dummy:void 0}),h.extend({className:"widget materials",template:t("#materials-widget-template").html(),initialize:function(){h.prototype.initialize.apply(this,arguments),this.materialsModel=new o({nodeId:this.nodeId}),this.listenTo(this.materialsModel,"change",this.render)},render:function(){this.materialsModel.hasMaterials&&(this.$el.html(e.template(this.template,{materials:this.materialsModel.get("materials")})),this.$container.append(this.$el))}})),y=h.extend({className:"widget teamleads",template:t("#teamleads-widget-template").html(),initialize:function(){h.prototype.initialize.apply(this,arguments);var t=r.appView.model.getNodeById(this.nodeId);this.teamleads=t&&t.teamleads},render:function(){this.teamleads&&(this.$el.html(e.template(this.template,{teamleads:this.teamleads})),this.$container.append(this.$el))}}),b=[d,p,g,m,v,y];return f}),define("infopanelview",["jquery","underscore","backbone","d3","global","infoblockview","infoblockwidgets"],function(t,e,n,i,r,o,a){var s=n.View.extend({el:"#info-panel",isActive:!0,dateRange:[],selDate:null,events:{"click .toggle-button":"toggle"},initialize:function(){this.listenTo(r.events,"click:node",this.updateNodeId),this.listenTo(r.events,"resize",this.updateDimensions),this.listenTo(r.events,"select:day",this.updateDateRange),this.listenToOnce(r.events,"data-ready",this.delayedAppearance),this.listenTo(r.events,"click:canvas",this.onClickCanvas),this.listenTo(r.events,"change:grouping-type",this.onGroupingTypeChange),this.listenTo(r.events,"comment:auto_open",this.updateNodeId),a.init()},render:function(){return this.updateDimensions(),this.selDate||this.nodeId||this.dateRange.length?this.hideWelcomeMessage():this.showWelcomeMessage(),this.renderInfoBlockView(),this},renderInfoBlockView:function(){this.infoBlockView&&this.infoBlockView.remove(),this.infoBlockView=new o({model:new n.Model({id:this.nodeId,range:this.dateRange,selDate:this.selDate,groupType:this.groupType||"work_types"})}),this.$el.find(">.content").html(this.infoBlockView.render().el)},showWelcomeMessage:function(){this.$el.find(">.welcome").show()},hideWelcomeMessage:function(){this.$el.find(">.welcome").hide()},delayedAppearance:function(){this.render().$el.css({right:-r.config.infoPanelWidth}).show(),i.select("#info-panel").style("right",(this.isActive?0:-r.config.infoPanelWidth+r.config.infoPanelButtonWidth)+"px")},updateNodeId:function(t){this.nodeId!==t&&(this.nodeId=t,this.selDate=null,this.render())},onClickCanvas:function(t){this.nodeId&&t.target.classList.contains("emptiness")&&r.events.trigger("click:node",void 0);var e=+i.time.day(r.timeScale.invert(t.clientX-r.config.margin.left));this.selDate=new Date(e),this.render()},updateDateRange:function(t){r.events.trigger("click:node",void 0),this.selDate=null,this.dateRange=e.sortBy(t,function(t,e){return t-e}),this.render()},toggle:function(){this.isActive=!this.isActive,this.$el.find(".toggle-button").toggleClass("active"),this.render(),r.events.trigger("toggle:info-panel",this.isActive)},updateDimensions:function(){this.$el.css({top:r.config.margin.top-15,right:this.isActive?0:-r.config.infoPanelWidth+r.config.infoPanelButtonWidth,height:r.config.height+70,width:r.config.infoPanelWidth})},onGroupingTypeChange:function(t){this.groupType=t}});return s}),define("axisview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"",initialize:function(){this.d3=t.select(this.el).attr("transform","translate("+n.config.margin.left+","+(this.yPos||0)+")"),this.listenToOnce(n.events,"data-ready",this.initAxis),this.listenToOnce(n.events,"data-ready",this.render),this.listenTo(n.events,"zoomed resize",this.render),this.listenTo(n.events,"panned",this.adjustPan)},initAxis:function(){this.axis=t.svg.axis().scale(n.timeScale).tickSize(0,0,0)},getZoomState:function(){var e=n.utils.daysToPixels(7);return t.entries(n.config.axis.ticks).filter(function(t){return t.value<=e})[0].key},dummy:{}});return i}),define("axisdaysview",["d3","global","axisview"],function(t,e,n){var i=n.extend({el:"#axis .axis.days",initialize:function(){this.yPos=e.config.axis.height-1,n.prototype.initialize.apply(this,arguments),this.listenTo(e.events,"highlight:day",this.highlightDay)},initAxis:function(){n.prototype.initAxis.apply(this,arguments),this.axis.orient("top")},render:function(t){this.adjustTicksFormat(),("resize"===t?this.d3:this.d3).call(this.axis).call(this.centerTextLabels)},adjustPan:function(){this.d3.call(this.axis).call(this.centerTextLabels)},highlightDay:function(t){this.d3.selectAll(".major text").style("font-size",function(e){return t===+e?"20px":void 0})},adjustTicksFormat:function(){switch(this.getZoomState()){case"longDays":this.axis.ticks(t.time.days,1).tickFormat(function(e){return t.time.format("%a %e")(e)}).tickSubdivide(!1);break;case"shortDays":this.axis.ticks(t.time.days,1).tickFormat(function(e){return t.time.format("%e")(e)}).tickSubdivide(!1);break;case"weeks":this.axis.ticks(t.time.mondays,1).tickFormat(null).tickSubdivide(6);break;default:this.axis.ticks(t.time.months,1).tickFormat(null).tickSubdivide(1)}},centerTextLabels:function(t){t.selectAll(".major text").attr("transform","translate("+e.utils.daysToPixels(1)/2+",0)")},dummy:{}});return i}),define("monthsview",["d3","global","backbone","d3.lambdas"],function(t,e,n){var i=n.View.extend({el:"#axis .axis.months",initialize:function(){this.d3=t.select(this.el).attr("transform","translate("+e.config.margin.left+", 0)"),this.d3.append("g").attr("class","month-names").attr("transform","translate(0, "+(e.config.axis.height-2)+")"),this.listenTo(e.events,"zoomed panned resize",this.render),this.listenToOnce(e.events,"data-ready",function(){this.render("initial")})},render:function(t){this.renderMonthNames(t)},renderMonthNames:function(n){var i,r,o,a=this,s=e.timeScale.copy(),u=this.renderMonthNames.scale||s,l=this.getVisibleMonths(e.timeScale.domain()),c=this.d3.select(".month-names").selectAll(".name").data(l,t.("getTime"));switch(this.renderMonthNames.scale=s,i=c.enter(),r=c,o=c.exit(),i.append("text").attr("class","name").text(function(e){return t.time.format("%B")(e)}).call(this.setTextPosition,u),n){case"initial":setTimeout(function(){a.d3.select(".month-names").selectAll(".name").call(a.setTextPosition,u)},1)}r.call(this.setTextPosition,s),o.attr("opacity",1e-6).call(this.setTextPosition,s).remove()},setTextPosition:function(n,i){n.each(function(n){var r,o,a=this.getBBox().width,s=i(t.time.month.offset(n,1)),u=3,l=0,c=i.range()[1];r=i(n)+e.utils.daysToPixels(15)-a/2,r=Math.max(l,r),r=Math.min(r,s-a-u),r=Math.min(r,c-a),r=Math.max(r,i(n)+u),o=l>r?(r+a-l)/a:r+a>c?(c-r)/a:1,t.transition(t.select(this)).attr("x",r).attr("opacity",o)})},getVisibleMonths:function(e){for(var n=t.time.month.floor(e[0]),i=t.time.month.floor(e[1]),r=[n];i>n;)n=t.time.month.offset(n,1),r.push(n);return r},dummy:{}});return i}),define("zoomview",["backbone","d3","global"],function(t,e,n){var i=t.View.extend({el:"#canvas .background",initialize:function(t){var i=this;this.zoomHelper=t.zoomHelper,this.d3=e.select(this.el).attr("width",n.config.width+n.config.margin.left+n.config.margin.right).on("dblclick.zoom",function(){n.events.trigger("zoom")}).on("mousedown.pan",function(){i.mousedown()}),this.listenTo(this.model,"change toggle search",this.adjustHeight),this.listenTo(n.events,"resize",this.onResize),this.listenTo(n.events,"zoom",this.zoom),this.listenTo(n.events,"zoom_full",this.zoom_full)},onResize:function(){this.d3.attr("width",n.config.width+n.config.margin.left+n.config.margin.right)},mousedown:function(){if(0===e.event.button){var t=this,n=this.zoomHelper,i=this.zoomHelper.startPan(e.event.target),r=e.select(window).on("mousemove.pan",function(){i()}).on("mouseup.pan",function(){n.moved&&e.event.preventDefault(),r.on("mousemove.pan",null).on("mouseup.pan",null),t.el.classList.remove("panning")});this.el.classList.add("panning"),e.event.preventDefault(),window.focus()}},zoom:function(){this.zoomHelper.zoom(e.select("#canvas .background").node())},zoom_full:function(t){var n=t.action||"plus";this.zoomHelper.zoom_full(e.select("#canvas .background").node(),n)},adjustHeight:function(){var t=Math.max(n.config.height,this.model.getD3Data().nodes.length*(n.config.nodeHeight+n.config.nodePadding));this.d3.attr("height",t+n.config.margin.top+n.config.margin.bottom)},dummy:{}});return i}),define("zoomhelper",["backbone","d3","global"],function(t,e,n){var i=t.Model.extend({initialize:function(){this.zoomBeh=e.behavior.zoom().x(n.timeScale),n.router.on("route:applyDatamining",this.onRouting,this)},d3_helpers:function(){function t(t){return[t[0]*n+r[0],t[1]*n+r[1]];

}var e=this.zoomBeh,n=e.scale(),i=e.scaleExtent(),r=e.translate();return{location:function(t){return[(t[0]-r[0])/n,(t[1]-r[1])/n]},scaleTo:function(t){n=Math.max(i[0],Math.min(i[1],t))},translateTo:function(e,n){n=t(n),r[0]+=e[0]-n[0],r[1]+=e[1]-n[1]},applyZoom:function(){e.scale(n)}}},onRouting:function(t,e,n,i,r,o,a){var s=this.d3_helpers();if(r){var u=Number(r.replace("s","").replace("_","."));s.scaleTo(u),s.applyZoom()}if(a){var l=a.split(";")[0].split(",").reduce(function(t,e){return t.push(Number(e)),t},[]),c=a.split(";")[1].split(",").reduce(function(t,e){return t.push(Number(e)),t},[]),s=this.d3_helpers();s.translateTo(l,c)}s.applyZoom()},zoom_full:function(t,e){var i=this.d3_helpers(),r=Math.log(this.zoomBeh.scale())/Math.LN2;i.scaleTo(Math.pow(2,"plus"==e?Math.floor(r)+1:Math.floor(r)-1)),i.applyZoom(),n.events.trigger("zoomed","zoomed"),n.router.navigateSmart({scale:"s"+(this.zoomBeh.scale()+"").replace(".","_")},{trigger:!1})},zoom:function(t){var i=this.d3_helpers(),r=e.mouse(t),o=i.location(r),a=Math.log(this.zoomBeh.scale())/Math.LN2;i.scaleTo(Math.pow(2,e.event.shiftKey?Math.ceil(a)-1:Math.floor(a)+1)),i.translateTo(r,o),i.applyZoom(),n.events.trigger("zoomed","zoomed"),n.router.navigateSmart({scale:"s"+(this.zoomBeh.scale()+"").replace(".","_")},{trigger:!1}),n.router.navigateSmart({pan:r.join(",")+";"+o.join(",")},{trigger:!1})},startPan:function(t){var i=this,r=this.d3_helpers(),o=r.location(e.mouse(t));return this.moved=!1,function(){i.moved=!0;var a=e.mouse(t);r.translateTo(a,o),r.applyZoom(),n.events.trigger("panned","panned"),n.router.navigateSmart({pan:a.join(",")+";"+o.join(",")},{trigger:!1})}},dummy:null});return i}),define("gridview",["d3","global","axisview"],function(t,e,n){var i=n.extend({el:"#grid",initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenToOnce(e.events,"data-ready",function(){this.listenTo(this.model,"change toggle",this.render)})},initAxis:function(){n.prototype.initAxis.apply(this,arguments);var t=e.utils.getMaxHeight(this.model);this.axis.tickSize(t,t).tickFormat(""),this.d3.append("g").attr("class","days-ticks"),this.d3.append("g").attr("class","weekends"),this.d3.append("g").attr("class","month-ticks")},render:function(){this.renderGrid.apply(this,arguments),this.renderWeekends.apply(this,arguments),this.renderMonthTicks.apply(this,arguments)},renderGrid:function(n){switch(this.axis.tickSize(e.utils.getMaxHeight(this.model)),this.getZoomState()){case"months":this.axis.ticks(t.time.months,1);break;default:this.axis.ticks(t.time.days,1)}var i=this.d3.select(".days-ticks");i.call(this.axis)},renderWeekends:function(n){var i,r,o,a=e.timeScale.copy(),s=this.renderWeekends.scale||a,u=a.domain(),l=t.time.day.range(t.time.day.offset(u[0],-2),u[1]),c=this.model.get("weekends"),f=l.filter(function(e){var n=t.time.format("%Y-%m-%d")(e);return c[n]||!1}),h=this.d3.select(".weekends").selectAll(".weekend").data(f,t.("getTime"));this.renderWeekends.scale=a,i=h.enter(),r=h,o=h.exit(),i.append("rect").attr("opacity",0).attr("class","weekend").attr("y",0).attr("height",e.utils.getMaxHeight(this.model)).attr("x",function(t){return s(t)}).attr("width",e.utils.daysToPixels(1,s)),r.attr("opacity",1).attr("height",e.utils.getMaxHeight(this.model)).attr("x",function(t){return a(t)}).attr("width",e.utils.daysToPixels(1)),o.attr("x",function(t){return a(t)}).attr("width",e.utils.daysToPixels(1)).remove()},renderMonthTicks:function(n){var i,r,o,a=e.timeScale.ticks(t.time.months),s=this.d3.select(".month-ticks").selectAll(".tick").data(a,t.("getTime")),u=e.timeScale.copy(),l=this.renderMonthTicks.scale||u;this.renderMonthTicks.scale=u,i=s.enter().append("line"),r=s,o=s.exit(),i.attr("opacity",0).attr("class","tick").attr("y2",e.utils.getMaxHeight(this.model)).attr("transform",function(t){return"translate("+l(t)+", 0)"}),r.attr("opacity",1).attr("transform",function(t){return"translate("+u(t)+", 0)"}).attr("y2",e.utils.getMaxHeight(this.model)),o.attr("transform",function(t){return"translate("+u(t)+", 0)"}).remove()},adjustPan:function(){this.d3.select(".days-ticks").call(this.axis),this.renderWeekends.apply(this,arguments),this.renderMonthTicks.apply(this,arguments)},dummy:null});return i}),define("horizontalgridview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"#horizontal-grid",initialize:function(){var e=this;this.d3=t.select(this.el),this.listenTo(this.model,"change",function(){e.d3data=e.model.getD3Data(),e.render()}),this.listenTo(this.model,"toggle",this.render),this.listenTo(n.events,"resize",this.render)},render:function(t){var e=this,i=function(t,i){return n.config.margin.top+e.d3data.yScale(e.d3data.dataset.i+i+1)-n.config.nodePadding/2},r=this.d3.selectAll(".horizontal-line").data(e.d3data.nodes);r.enter().append("line").attr("class","horizontal-line").attr("opacity",1e-6).attr("transform",function(t,e){return"translate(0, "+i(t,e)+")"}),r.attr("opacity",1).attr("x2",n.config.width+n.config.margin.left+n.config.margin.right),r.exit().attr("opacity",1e-6).remove()},dummy:{}});return i}),define("todayview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"#today",initialize:function(){this.d3=t.select(this.el).attr("transform","translate("+n.config.margin.left+", 0)"),this.listenTo(this.model,"change toggle",this.render),this.listenTo(n.events,"panned zoomed resize",this.render)},render:function(t){var e=function(t){return"translate("+n.timeScale(t)+", 0)"},i=new Date,r=n.utils.getMaxHeight(this.model),o=this.d3.selectAll("rect").data([new Date(i.getFullYear(),i.getMonth(),i.getDate())]);o.enter().append("rect").attr("opacity",0).attr("height",r).attr("transform",e),o.attr("opacity",1).attr("height",r).attr("transform",e).attr("width",n.utils.daysToPixels(1))}});return i}),define("dayhighlightview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"#day-highlight",initialize:function(){var e=this;this.d3=t.select(this.el).attr("transform","translate("+n.config.margin.left+", 0)"),$("#canvas").mousemove(function(i){if(!i.which){var r=+t.time.day(n.timeScale.invert(i.clientX-n.config.margin.left));+e.theDay!==r&&n.events.trigger("highlight:day",r)}}).mouseleave(function(){}),this.listenTo(this.model,"toggle",this.render),this.listenTo(n.events,"panned zoomed resize",this.render),this.listenTo(n.events,"highlight:day",function(t){t?(this.theDay=new Date(t),this.render().$el.fadeIn()):(this.theDay=void 0,this.$el.fadeOut())}),this.listenTo(n.events,"select:day",function(t){if(t.length){var e=this;$(document).on("keyup.day keydown.day",function(t){e.shiftIsPressed=t.shiftKey,e.render()}),this.selectionAnchor=t[0]}else $(document).off("keyup.day keydown.day"),this.shifIsPressed=!1,this.selectionAnchor=void 0})},render:function(e){if("panned"!=e){var i,r,o,a,s=1;return this.theDay&&(this.shiftIsPressed&&this.selectionAnchor&&(s=1+Math.abs(this.selectionAnchor-this.theDay)/1e3/60/60/24),i="translate("+n.timeScale(t.min([this.theDay,this.shiftIsPressed?this.selectionAnchor:void 0]))+", 0)",r=n.utils.daysToPixels(s),o=n.utils.getMaxHeight(this.model),a=this.d3.selectAll("rect").data(new Array(1)),a.enter().append("rect"),a.attr("transform",i).attr("height",o).attr("width",r)),this}},dummy:null});return i}),define("menudeldiaview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"#axis",events:{"mousemove ":"showMenu","mouseleave ":function(){n.events.trigger("show_menu:day",0)}},initialize:function(){this.listenTo(n.events,"show_menu:day",function(t){this.theDay=new Date(t),this.render()})},render:function(){var e,i,r,o;return this.theDay&&(e="translate("+(n.config.margin.left+n.timeScale(this.theDay)+n.utils.daysToPixels(1)/2+2)+", 15)",i=n.config.brief_url+t.time.format("%d_%m_%Y")(this.theDay),r="    "+t.time.format("%d.%m")(this.theDay)+"   ",o=t.select(this.el).selectAll("#menu-del-dia").data(new Array(1)),o.enter().append("g").attr("id","menu-del-dia").append("a").on("click",function(){this.blur()}).attr("target","_blank").append("text").attr("class","brief-link").html("&#xf08e").append("title"),o.attr("transform",e).select("a").attr("xlink:href",i).select("title").text(r)),this},showMenu:function(e){var i=+t.time.day(n.timeScale.invert(e.clientX-n.config.margin.left));+this.theDay!==i&&(n.events.trigger("show_menu:day",i),n.events.trigger("highlight:day",i))},dummy:null});return i}),define("dayselectview",["underscore","d3","backbone","global"],function(t,e,n,i){var r=n.View.extend({el:"#axis",events:{mousedown:"selectDay"},selection:[],initialize:function(){this.d3_daySelectBar=e.select("#day-select").attr("transform","translate("+i.config.margin.left+", 0)"),this.listenTo(this.model,"change toggle",this.render),this.listenTo(i.events,"panned zoomed resize",this.render)},render:function(n){var r=t.sortBy(this.selection),o=this.d3_daySelectBar.selectAll("rect").data(new Array(1));if(r.length){var a=1+(t.last(r)-t.first(r))/1e3/60/60/24,s=i.utils.getMaxHeight(this.model),u=i.utils.daysToPixels(a),l="translate("+i.timeScale(r[0])+", 0)";o.enter().append("rect"),o.attr("height",s).attr("transform",l).attr("width",u)}else o.remove();return e.select(this.el).select(".axis.days").classed("selected",this.selection.length).selectAll(".major").classed("selected-day",function(t){return i.utils.dateWithinRange(t,r)}),this},selectDay:function(n){if(!n.target.classList.contains("brief-link")){var r=e.time.day(i.timeScale.invert(n.clientX-i.config.margin.left));n.shiftKey?this.selection.length?this.selection[1]=r:this.selection=[r]:this.selection=i.utils.dateWithinRange(r,t.sortBy(this.selection))?[]:[r],i.events.trigger("brief-filter:model",this.selection),i.events.trigger("select:day",this.selection),n.preventDefault()}},dummy:void 0});return r}),define("searchview",["backbone","global"],function(t,e){var n=t.View.extend({el:"#search",events:{"search input":"search","keyup input":"onKeyup","mouseenter button":"onMouseEnter","mouseleave button":"onMouseLeave","click button":"onButtonClick"},initialize:function(){this.$el.show(),e.router.on("route:applyDatamining",this.render,this)},render:function(t,e,n,i,r,o,a,s,u){this.$el.find("input").val(u)},onMouseEnter:function(){this.$el.find(".tooltip").addClass("show")},onMouseLeave:function(){this.$el.find(".tooltip").removeClass("show")},onKeyup:function(t){this.scheduleSearch(t)},onButtonClick:function(t){$(t.target).closest("button").blur(),e.appView.model.expandToSearchResults()},scheduleSearch:function(t){var n=this;clearTimeout(n.timeout),n.timeout=setTimeout(function(){n.search(t),13===t.keyCode&&e.appView.model.expandToSearchResults()},e.config.searchDelay)},search:function(t){var n=t.target.value;e.router.navigateSmart({search:n},{trigger:!1,replace:!1}),e.events.trigger("search:model",n.toLocaleLowerCase())},dummy:null});return n}),define("sortview",["backbone","global"],function(t,e){var n=t.View.extend({el:"#sort",events:{"click a":"sort"},initialize:function(){this.$el.show(),e.router.on("route:applyDatamining",this.render,this)},render:function(){this.$el.find("a").removeClass("selected asc desc"),this.$el.find("a[href=#"+this.model.sortType+"]").addClass("selected").addClass(this.model.sortDesc?"desc":"asc").data("desc",this.model.sortDesc)},sort:function(t){$("body").addClass("waiting"),setTimeout(function(){var n=t.target.hash.slice(1),i=!$(t.target).data("desc");e.router.navigateSmart({sort:(i?"!":"")+n},{trigger:!0}),$("body").removeClass("waiting")},50),t.preventDefault()},dummy:null});return n}),define("daterangesview",["d3","backbone","global"],function(t,e,n){var i=e.View.extend({el:"#date-ranges",waitBeforeHide:500,initialize:function(){t.select(this.el).attr("transform","translate("+n.config.margin.left+", 4)"),n.events.on("show_daterange:tooltip",this.onShowDateRange,this),n.events.on("hide:tooltip",this.hide,this),n.events.on("show_menu:day",this.hideNow,this),n.events.on("panned zoomed resize",this.adjust,this)},onShowDateRange:function(t){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=void 0),this.datum=t,this.$el.stop(!0,!0).show(),this.render(t)},adjust:function(t){this.datum&&this.render(this.datum,t)},render:function(e,n){var i=this,r=function(t){return e.dateRange[t]?[e.dateRange[t]]:[]},o=function(t){return{plan:0,fact:10}[t]};["plan","fact"].forEach(function(a){var s=t.select(i.el).selectAll("."+a).data(r(a));s.enter().append("g").attr("class",a).attr("opacity",1e-6).attr("transform","translate(0, "+o(a)+")"),s.classed("child",e.depth>1).call(i.d3_drawDateRanges,i,n).attr("opacity",1),s.exit().attr("opacity",1e-6).remove()})},d3_drawDateRanges:function(t,e,i){if(!t.empty()){var r=t.datum(),o=(r.finish-r.start)/1e3/60/60/24+1,a=n.utils.daysToPixels(1),s=9,u=a*Math.min(2,o-1)/2,l=function(t){return"M0,0 l0,"+s+", M0,"+s/2+", l"+u+", 0"},c=function(t){return"M0,0 l0,"+s+", M0,"+s/2+", l-"+u+", 0"},f=function(t){return"translate("+(n.timeScale(t)+a/2)+", 0)"},h=5,d="translate(-"+(u+h)+", "+(s-1)+")",p=t.selectAll(".start").data(function(t){return[t.start]});p.enter().append("g").attr("class","start").attr("transform",f).append("path").attr("d",l),"panned"!==i&&p.selectAll("path").attr("d",l),p.attr("transform",f);var g=t.selectAll(".finish").data(function(t){return[t.finish]}),m=g.enter().append("g").attr("class","finish").attr("transform",f);m.append("path").attr("d",c),m.append("text").attr("transform",d).text(o),"panned"!==i&&(g.selectAll("path").attr("d",c),g.selectAll("text").attr("transform",d).attr("opacity",o>3?1:1e-6)),g.attr("transform",f)}},hide:function(){var t=this;this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=void 0),this.hideTimer=setTimeout(function(){t.$el.fadeOut()},this.waitBeforeHide)},hideNow:function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=void 0),this.$el.hide()},dummy:null});return i}),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tooltip"),o="object"==typeof e&&e;!r&&/destroy|hide/.test(e)||(r||i.data("bs.tooltip",r=new n(this,o)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.6",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",u="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(u+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var r=this,o=this.tip(),a=this.getUID(this.type);this.setContent(),o.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,u=/\s?auto?\s?/i,l=u.test(s);l&&(s=s.replace(u,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),f=o[0].offsetWidth,h=o[0].offsetHeight;if(l){var d=s,p=this.getPosition(this.$viewport);s="bottom"==s&&c.bottom+h>p.bottom?"top":"top"==s&&c.top-h<p.top?"bottom":"right"==s&&c.right+f>p.width?"left":"left"==s&&c.left-f<p.left?"right":s,o.removeClass(d).addClass(s)}var g=this.getCalculatedOffset(s,c,f,h);this.applyPlacement(g,s);var m=function(){var t=r.hoverState;r.$element.trigger("shown.bs."+r.type),r.hoverState=null,"out"==t&&r.leave(r)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",m).emulateTransitionEnd(n.TRANSITION_DURATION):m()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top+=a,e.left+=s,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var u=i[0].offsetWidth,l=i[0].offsetHeight;"top"==n&&l!=o&&(e.top=e.top+o-l);var c=this.getViewportAdjustedDelta(n,e,u,l);c.left?e.left+=c.left:e.top+=c.top;var f=/top|bottom/.test(n),h=f?2*c.left-r+u:2*c.top-o+l,d=f?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(h,i[0][d],f)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=r.hoverState&&o.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),e&&e()}var r=this,o=t(this.$tip),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=t.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=i?{top:0,left:0}:e.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},s=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},r,a,s,o)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-o-a.scroll,u=e.top+o-a.scroll+i;s<a.top?r.top=a.top-s:u>a.top+a.height&&(r.top=a.top+a.height-u)}else{var l=e.left-o,c=e.left+o+n;l<a.left?r.left=a.left-l:c>a.right&&(r.left=a.left+a.width-c)}return r},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";var e=function(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,i)};e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(t){var e="disabled",n=this.$element,i=n.is("input")?"val":"html",r=n.data();t+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[t]||this.options[t]),setTimeout(function(){"loadingText"==t?n.addClass(e).attr(e,e):n.removeClass(e).removeAttr(e)},0)},e.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var e=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===e.prop("type")&&t.find(".active").removeClass("active")}this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=function(n){return this.each(function(){var i=t(this),r=i.data("bs.button"),o="object"==typeof n&&n;r||i.data("bs.button",r=new e(this,o)),"toggle"==n?r.toggle():n&&r.setState(n)})},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api","[data-toggle^=button]",function(e){var n=t(e.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle"),e.preventDefault()})}(window.jQuery),+function(t){"use strict";function e(){t(i).remove(),t(r).each(function(e){var i=n(t(this));i.hasClass("open")&&(i.trigger(e=t.Event("hide.bs.dropdown")),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}var i=".dropdown-backdrop",r="[data-toggle=dropdown]",o=function(e){t(e).on("click.bs.dropdown",this.toggle)};o.prototype.toggle=function(i){var r=t(this);if(!r.is(".disabled, :disabled")){var o=n(r),a=o.hasClass("open");if(e(),!a){if("ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e),o.trigger(i=t.Event("show.bs.dropdown")),i.isDefaultPrevented())return;o.toggleClass("open").trigger("shown.bs.dropdown"),r.focus()}return!1}},o.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var i=t(this);if(e.preventDefault(),e.stopPropagation(),!i.is(".disabled, :disabled")){var o=n(i),a=o.hasClass("open");if(!a||a&&27==e.keyCode)return 27==e.which&&o.find(r).focus(),i.click();var s=t("[role=menu] li:not(.divider):visible a",o);if(s.length){var u=s.index(s.filter(":focus"));38==e.keyCode&&u>0&&u--,40==e.keyCode&&u<s.length-1&&u++,~u||(u=0),s.eq(u).focus()}}}};var a=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var n=t(this),i=n.data("dropdown");i||n.data("dropdown",i=new o(this)),"string"==typeof e&&i[e].call(n)})},t.fn.dropdown.Constructor=o,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+", [role=menu]",o.prototype.keydown)}(window.jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]}}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one(t.support.transition.end,function(){n=!0});var r=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(r,e),this},t(function(){t.support.transition=e()})}(window.jQuery),+function(t){"use strict";var e=function(e,n){this.options=n,this.$element=t(e),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this[this.isShown?"hide":"show"](t)},e.prototype.show=function(e){var n=this,i=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var i=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var r=t.Event("shown.bs.modal",{relatedTarget:e});i?n.$element.find(".modal-dialog").one(t.support.transition.end,function(){n.$element.focus().trigger(r)}).emulateTransitionEnd(300):n.$element.focus().trigger(r)}))},e.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one(t.support.transition.end,t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.focus()},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(e){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=t.support.transition&&n;if(this.$backdrop=t('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;i?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()):e&&e()};var n=t.fn.modal;t.fn.modal=function(n,i){return this.each(function(){var r=t(this),o=r.data("bs.modal"),a=t.extend({},e.DEFAULTS,r.data(),"object"==typeof n&&n);o||r.data("bs.modal",o=new e(this,a)),"string"==typeof n?o[n](i):a.show&&o.show(i)})},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var n=t(this),i=n.attr("href"),r=t(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("modal")?"toggle":t.extend({remote:!/#/.test(i)&&i},r.data(),n.data());e.preventDefault(),r.modal(o,this).one("hide",function(){n.is(":visible")&&n.focus()})}),t(document).on("show.bs.modal",".modal",function(){t(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){t(document.body).removeClass("modal-open")})}(window.jQuery),define("bootstrap",["jquery"],function(){}),define("statsview",["jquery","underscore","d3","backbone","global","bootstrap"],function(t,e,n,i,r){var o=i.View.extend({el:"#stats-modal",template:t("#stats-template").html(),events:{"show.bs.modal":"onShow","hidden.bs.modal":"onHide"},initialize:function(){this.$container=this.$el.find(".modal-body"),this.listenTo(this.model,"change",this.render)},render:function(){var n=this.model.get("data");if(n)this.$container.html(e.template(this.template,{stats:n,pluralForm:r.utils.pluralForm}));else{var i=t('<div class="spinner"><div class="rect1"/> <div class="rect2"/> <div class="rect3"/> <div class="rect4"/> <div class="rect5"/></div>');this.$container.html(i)}return this},onShow:function(){this.model.get("data")||this.model.fetch(),this.render()},onHide:function(){this.destroy()},destroy:function(){this.$container.empty()},dummy:null});return o}),define("statsmodel",["jquery","backbone","d3","global"],function(t,e,n,i){var r=e.Model.extend({url:i.config.stats_url,parse:function(t){var e=n.time.day(new Date);return{data:t.sectors.map(function(t){var i={name:t.name,value:n.time.day.offset(new Date(t.finish_date),1)};return i.value<=e?i.value=null:i.delta=Math.floor((i.value-e)/1e3/60/60/24),i}).sort(function(t,e){return t.value>e.value?1:-1})}},dummy:null});return r}),define("loadingview",["backbone","global"],function(t,e){var n=t.View.extend({id:"ajax-loading",tagName:"div",initialize:function(){this.loadingCounter=0,this.listenTo(e.events,"start:loading",this.showLoading),this.listenTo(e.events,"stop:loading",this.hideLoading),$(document.body).append(this.render())},render:function(){var t=this.$el;return this.$el.text("...").hide().mousemove(function(e){var n=50;t.css(e.clientX<$(window).width()/2?{"margin-left":e.clientX+n
}:{"margin-left":e.clientX-t.outerWidth()-n}),t.css({transition:"margin 0.2s"})}),this.$el},showLoading:function(t){this.loadingCounter++,this.$el.css({"margin-left":$(window).width()/2-this.$el.outerWidth()/2}),t?this.$el.show():this.$el.fadeIn()},hideLoading:function(){this.loadingCounter=Math.max(0,this.loadingCounter-1),this.loadingCounter||this.$el.fadeOut()},dummy:null});return n}),define("completedfilterview",["backbone","global"],function(t,e){var n=t.View.extend({el:"#completed-filter",events:{"click a":"filter"},initialize:function(){this.$el.show(),e.router.on("route:applyDatamining",this.render,this)},render:function(){this.$el.find("a").removeClass("selected"),this.$el.find("a[href=#"+this.model.hideCompletedDepth+"]").addClass("selected")},filter:function(t){if($(t.target).hasClass("selected"))e.router.navigateSmart({completed_filter:"off"},{trigger:!0}),t.preventDefault();else{var n=$(t.target).data("depth");e.router.navigateSmart({completed_filter:n},{trigger:!0}),t.preventDefault()}},dummy:null});return n}),define("usermodel",["jquery","backbone","global","jquery.jsonp"],function(t,e,n){var i=e.Model.extend({url:n.config.user_id_url,sync:function(e,i,r){r=t.extend({},r,{url:this.url,success:function(t){try{i.completeSync(t),i.trigger("sync",i,t,r)}catch(t){n.utils.logException(t),i.trigger("error",{code:1,exception:t})}},error:function(){i.trigger("error",arguments)}});var o=r.xhr=t.ajax(r);i.trigger("request",i,o,r)},completeSync:function(t){this.set("user_id",t),n.events.trigger("userid:usermodel",t)},dummy:null});return i}),define("userview",["underscore","backbone"],function(t,e){var n=e.View.extend({el:"#user-menu",template:$("#user-menu-template").html(),initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"error",this.showError)},render:function(){this.$el.find(".dropdown-menu").html(t.template(this.template,{userId:this.model.get("user_id")})),this.$el.find(".dropdown-toggle").prop("title",this.model.get("user_id")),this.$el.show()},showError:function(){this.$el.find(".dropdown-menu").html(t.template(this.template,{userId:"   User ID"}))},dummy:null});return n}),define("viewmenuitemscollection",["backbone","global"],function(t,e){var n=t.Model.extend({idAttribute:"name",toggle:function(){this.get("disabled")||(this.set("visible",!this.get("visible")),"contract_level"===this.get("name")&&e.appView.model.trigger("change"),"facts"===this.get("name")&&this.collection.get("facts_detalization").set("disabled",!this.get("visible")),"empty_contracts"===this.get("name")?e.appView.model.trigger("change"):e.events.trigger("toggle:viewmenu",this))}}),i=t.Collection.extend({model:n,initialize:function(){this.add([{name:"contract_level",visible:!0},{name:"plan_shifts",visible:!0},{name:"statuses",visible:!0},{name:"comments",visible:!0},{name:"empty_contracts",visible:!0},{name:"facts",visible:!0},{name:"facts_detalization",visible:!0}])},isVisible:function(t){return this.get(t).get("visible")}});return i}),function(t){var e=function(){return!1===t.support.boxModel&&t.support.objectAll&&t.support.leadingWhitespace}();t.jGrowl=function(e,n){0==t("#jGrowl").size()&&t('<div id="jGrowl"></div>').addClass(n&&n.position?n.position:t.jGrowl.defaults.position).appendTo("body"),t("#jGrowl").jGrowl(e,n)},t.fn.jGrowl=function(e,n){if(t.isFunction(this.each)){var i=arguments;return this.each(function(){void 0==t(this).data("jGrowl.instance")&&(t(this).data("jGrowl.instance",t.extend(new t.fn.jGrowl,{notifications:[],element:null,interval:null})),t(this).data("jGrowl.instance").startup(this)),t.isFunction(t(this).data("jGrowl.instance")[e])?t(this).data("jGrowl.instance")[e].apply(t(this).data("jGrowl.instance"),t.makeArray(i).slice(1)):t(this).data("jGrowl.instance").create(e,n)})}},t.extend(t.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:!1,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3e3,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:!0,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(){},beforeOpen:function(){},afterOpen:function(){},open:function(){},beforeClose:function(){},close:function(){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(e,n){var n=t.extend({},this.defaults,n);"undefined"!=typeof n.speed&&(n.openDuration=n.speed,n.closeDuration=n.speed),this.notifications.push({message:e,options:n}),n.log.apply(this.element,[this.element,e,n])},render:function(e){var n=this,i=e.message,r=e.options;r.themeState=""==r.themeState?"":"ui-state-"+r.themeState;var e=t("<div/>").addClass("jGrowl-notification "+r.themeState+" ui-corner-all"+(void 0!=r.group&&""!=r.group?" "+r.group:"")).append(t("<div/>").addClass("jGrowl-close").html(r.closeTemplate)).append(t("<div/>").addClass("jGrowl-header").html(r.header)).append(t("<div/>").addClass("jGrowl-message").html(i)).data("jGrowl",r).addClass(r.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){t(this).parent().trigger("jGrowl.beforeClose")}).parent();t(e).bind("mouseover.jGrowl",function(){t("div.jGrowl-notification",n.element).data("jGrowl.pause",!0)}).bind("mouseout.jGrowl",function(){t("div.jGrowl-notification",n.element).data("jGrowl.pause",!1)}).bind("jGrowl.beforeOpen",function(){r.beforeOpen.apply(e,[e,i,r,n.element])!==!1&&t(this).trigger("jGrowl.open")}).bind("jGrowl.open",function(){r.open.apply(e,[e,i,r,n.element])!==!1&&("after"==r.glue?t("div.jGrowl-notification:last",n.element).after(e):t("div.jGrowl-notification:first",n.element).before(e),t(this).animate(r.animateOpen,r.openDuration,r.easing,function(){t.support.opacity===!1&&this.style.removeAttribute("filter"),null!==t(this).data("jGrowl")&&(t(this).data("jGrowl").created=new Date),t(this).trigger("jGrowl.afterOpen")}))}).bind("jGrowl.afterOpen",function(){r.afterOpen.apply(e,[e,i,r,n.element])}).bind("jGrowl.beforeClose",function(){r.beforeClose.apply(e,[e,i,r,n.element])!==!1&&t(this).trigger("jGrowl.close")}).bind("jGrowl.close",function(){t(this).data("jGrowl.pause",!0),t(this).animate(r.animateClose,r.closeDuration,r.easing,function(){t.isFunction(r.close)?r.close.apply(e,[e,i,r,n.element])!==!1&&t(this).remove():t(this).remove()})}).trigger("jGrowl.beforeOpen"),""!=r.corners&&void 0!=t.fn.corner&&t(e).corner(r.corners),t("div.jGrowl-notification:parent",n.element).size()>1&&0==t("div.jGrowl-closer",n.element).size()&&this.defaults.closer!==!1&&t(this.defaults.closerTemplate).addClass("jGrowl-closer "+this.defaults.themeState+" ui-corner-all").addClass(this.defaults.theme).appendTo(n.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){t(this).siblings().trigger("jGrowl.beforeClose"),t.isFunction(n.defaults.closer)&&n.defaults.closer.apply(t(this).parent()[0],[t(this).parent()[0]])})},update:function(){t(this.element).find("div.jGrowl-notification:parent").each(function(){void 0!=t(this).data("jGrowl")&&void 0!==t(this).data("jGrowl").created&&t(this).data("jGrowl").created.getTime()+parseInt(t(this).data("jGrowl").life)<(new Date).getTime()&&t(this).data("jGrowl").sticky!==!0&&(void 0==t(this).data("jGrowl.pause")||t(this).data("jGrowl.pause")!==!0)&&t(this).trigger("jGrowl.beforeClose")}),this.notifications.length>0&&(0==this.defaults.pool||t(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)&&this.render(this.notifications.shift()),t(this.element).find("div.jGrowl-notification:parent").size()<2&&t(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){t(this).remove()})},startup:function(n){this.element=t(n).addClass("jGrowl").append('<div class="jGrowl-notification"></div>'),this.interval=setInterval(function(){t(n).data("jGrowl.instance").update()},parseInt(this.defaults.check)),e&&t(this.element).addClass("ie6")},shutdown:function(){t(this.element).removeClass("jGrowl").find("div.jGrowl-notification").trigger("jGrowl.close").parent().empty(),clearInterval(this.interval)},close:function(){t(this.element).find("div.jGrowl-notification").each(function(){t(this).trigger("jGrowl.beforeClose")})}}),t.jGrowl.defaults=t.fn.jGrowl.prototype.defaults}(jQuery),define("jgrowl",["jquery"],function(){}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("clipboard",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Clipboard=t()}}(function(){var t;return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){var i=t("matches-selector");e.exports=function(t,e,n){for(var r=n?t:t.parentNode;r&&r!==document;){if(i(r,e))return r;r=r.parentNode}}},{"matches-selector":5}],2:[function(t,e,n){function i(t,e,n,i,o){var a=r.apply(this,arguments);return t.addEventListener(n,a,o),{destroy:function(){t.removeEventListener(n,a,o)}}}function r(t,e,n,i){return function(n){n.delegateTarget=o(n.target,e,!0),n.delegateTarget&&i.call(t,n)}}var o=t("closest");e.exports=i},{closest:1}],3:[function(t,e,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e}},{}],4:[function(t,e,n){function i(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!s.string(e))throw new TypeError("Second argument must be a String");if(!s.fn(n))throw new TypeError("Third argument must be a Function");if(s.node(t))return r(t,e,n);if(s.nodeList(t))return o(t,e,n);if(s.string(t))return a(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function r(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function o(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function a(t,e,n){return u(document.body,t,e,n)}var s=t("./is"),u=t("delegate");e.exports=i},{"./is":3,delegate:2}],5:[function(t,e,n){function i(t,e){if(o)return o.call(t,e);for(var n=t.parentNode.querySelectorAll(e),i=0;i<n.length;++i)if(n[i]==t)return!0;return!1}var r=Element.prototype,o=r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;e.exports=i},{}],6:[function(t,e,n){function i(t){var e;if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName)t.focus(),t.setSelectionRange(0,t.value.length),e=t.value;else{t.hasAttribute("contenteditable")&&t.focus();var n=window.getSelection(),i=document.createRange();i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i),e=n.toString()}return e}e.exports=i},{}],7:[function(t,e,n){function i(){}i.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function i(){r.off(t,i),e.apply(n,arguments)}var r=this;return i._=e,this.on(t,i,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;for(i;r>i;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,a=i.length;a>o;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}},e.exports=i},{}],8:[function(e,n,i){!function(r,o){if("function"==typeof t&&t.amd)t(["module","select"],o);else if("undefined"!=typeof i)o(n,e("select"));else{var a={exports:{}};o(a,r.select),r.clipboardAction=a.exports}}(this,function(t,e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(e),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(){function t(e){i(this,t),this.resolveOptions(e),this.initSelection()}return t.prototype.resolveOptions=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action=t.action,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""},t.prototype.initSelection=function(){this.text?this.selectFake():this.target&&this.selectTarget()},t.prototype.selectFake=function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px",this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=r["default"](this.fakeElem),this.copyText()},t.prototype.removeFake=function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)},t.prototype.selectTarget=function(){this.selectedText=r["default"](this.target),this.copyText()},t.prototype.copyText=function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)},t.prototype.handleResult=function(t){t?this.emitter.emit("success",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)}):this.emitter.emit("error",{action:this.action,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})},t.prototype.clearSelection=function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()},t.prototype.destroy=function(){this.removeFake()},a(t,[{key:"action",set:function(){var t=arguments.length<=0||void 0===arguments[0]?"copy":arguments[0];if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==("undefined"==typeof t?"undefined":o(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},{select:6}],9:[function(e,n,i){!function(r,o){if("function"==typeof t&&t.amd)t(["module","./clipboard-action","tiny-emitter","good-listener"],o);else if("undefined"!=typeof i)o(n,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var a={exports:{}};o(a,r.clipboardAction,r.tinyEmitter,r.goodListener),r.clipboard=a.exports}}(this,function(t,e,n,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){var n="data-clipboard-"+t;return e.hasAttribute(n)?e.getAttribute(n):void 0}var l=r(e),c=r(n),f=r(i),h=function(t){function e(n,i){o(this,e);var r=a(this,t.call(this));return r.resolveOptions(i),r.listenClick(n),r}return s(e,t),e.prototype.resolveOptions=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText},e.prototype.listenClick=function(t){var e=this;this.listener=f["default"](t,"click",function(t){return e.onClick(t)})},e.prototype.onClick=function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l["default"]({action:this.action(e),target:this.target(e),text:this.text(e),trigger:e,emitter:this})},e.prototype.defaultAction=function(t){return u("action",t)},e.prototype.defaultTarget=function(t){var e=u("target",t);return e?document.querySelector(e):void 0},e.prototype.defaultText=function(t){return u("text",t)},e.prototype.destroy=function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)},e}(c["default"]);t.exports=h})},{"./clipboard-action":8,"good-listener":4,"tiny-emitter":7}]},{},[9])(9)}),define("viewmenuview",["jquery","underscore","backbone","d3","global","jgrowl","clipboard","bootstrap"],function(t,e,n,i,r,o,a){var s=n.View.extend({el:"#view-menu",template:t("#view-menu-template").html(),events:{"click a[data-item]":"toggle","click .btn-size-plus":"onBtnSizePlus","click .btn-size-minus":"onBtnSizeMinus"},initialize:function(){this.$el.show(),this.render(),r.router.on("route:applyDatamining",this.onRouting,this),this.listenTo(this.collection,"change",this.render)},render:function(){return this.$el.find("ul.dropdown-menu").html(e.template(this.template,{items:this.collection.models})),this},onRouting:function(t,e,n,i){if(i){if("all"==i)this.collection.each(function(t){t.set("visible",!0)});else{var r=i.split(",");this.collection.each(function(t){var e=!1;r.map(function(n){n==t.get("name")&&(e=!0)}),t.set("visible",e)})}this.render()}else this.collection.each(function(t){t.set("visible",!1)}),this.render()},toggle:function(e){this.collection.get(t(e.target).data("item")).toggle(),this.$el.find(".badge").html(this.collection.filter(function(t){return!t.get("visible")}).length||"");var n=[];this.collection.each(function(t){t.get("visible")&&n.push(t.get("name"))}),r.router.navigateSmart({layers:n.join()},{trigger:!1}),e.preventDefault()},onBtnSizePlus:function(t){r.events.trigger("zoom_full",{action:"plus"})},onBtnSizeMinus:function(t){r.events.trigger("zoom_full",{action:"minus"})},dummy:null});return s}),function(t){"use strict";function e(t,e){return t.toUpperCase().indexOf(e.toUpperCase())>-1}function n(e){var n=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return t.each(n,function(){e=e.replace(this.re,this.ch)}),e}function i(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n="(?:"+Object.keys(e).join("|")+")",i=new RegExp(n),r=new RegExp(n,"g"),o=null==t?"":""+t;return i.test(o)?o.replace(r,function(t){return e[t]}):o}function r(e,n){var i=arguments,r=e,e=i[0],n=i[1];[].shift.apply(i),"undefined"==typeof e&&(e=r);var a,s=this.each(function(){var r=t(this);if(r.is("select")){var s=r.data("selectpicker"),u="object"==typeof e&&e;if(s){if(u)for(var l in u)u.hasOwnProperty(l)&&(s.options[l]=u[l])}else{var c=t.extend({},o.DEFAULTS,t.fn.selectpicker.defaults||{},r.data(),u);r.data("selectpicker",s=new o(this,c,n))}"string"==typeof e&&(a=s[e]instanceof Function?s[e].apply(s,i):s.options[e])}});return"undefined"!=typeof a?a:s}t.expr[":"].icontains=function(n,i,r){return e(t(n).text(),r[3])},t.expr[":"].aicontains=function(n,i,r){return e(t(n).data("normalizedText")||t(n).text(),r[3])};var o=function(e,n,i){i&&(i.stopPropagation(),i.preventDefault()),this.$element=t(e),this.$newElement=null,this.$button=null,this.$menu=null,this.$lis=null,this.options=n,null===this.options.title&&(this.options.title=this.$element.attr("title")),this.val=o.prototype.val,this.render=o.prototype.render,this.refresh=o.prototype.refresh,this.setStyle=o.prototype.setStyle,this.selectAll=o.prototype.selectAll,this.deselectAll=o.prototype.deselectAll,this.destroy=o.prototype.remove,this.remove=o.prototype.remove,this.show=o.prototype.show,this.hide=o.prototype.hide,this.init()};o.VERSION="1.6.3",o.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results match",countSelectedText:function(t,e){return 1==t?"{0} item selected":"{0} items selected"},maxOptionsText:function(t,e){var n=[];return n[0]=1==t?"Limit reached ({n} item max)":"Limit reached ({n} items max)",n[1]=1==e?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)",n},selectAllText:"Select All",deselectAllText:"Deselect All",multipleSeparator:", ",style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,searchAccentInsensitive:!1},o.prototype={constructor:o,init:function(){var e=this,n=this.$element.attr("id");this.$element.hide(),this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),this.$newElement=this.createView(),this.$element.after(this.$newElement),this.$menu=this.$newElement.find("> .dropdown-menu"),this.$button=this.$newElement.find("> button"),this.$searchbox=this.$newElement.find("input"),this.options.dropdownAlignRight&&this.$menu.addClass("dropdown-menu-right"),"undefined"!=typeof n&&(this.$button.attr("data-id",n),t('label[for="'+n+'"]').click(function(t){t.preventDefault(),e.$button.focus()})),this.exitListener(),this.checkDisabled(),this.clickListener(),this.liveSearchListener(),this.render(),this.liHeight(),this.setStyle(),this.setWidth(),this.options.container&&this.selectPosition(),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile()},exitListener:function(){var t=this;this.$newElement.on("hide.bs.dropdown",function(e){"function"==typeof t.options.exitCallback&&t.options.exitCallback.apply(t,e)})},createDropdown:function(){var e=this.multiple?" show-tick":"",n=this.$element.parent().hasClass("input-group")?" input-group-btn":"",i=this.autofocus?" autofocus":"",r=this.$element.parents().hasClass("form-group-lg")?" btn-lg":this.$element.parents().hasClass("form-group-sm")?" btn-sm":"",o=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"",a='<div class="btn-group bootstrap-select'+e+n+'"><button type="button" class="btn dropdown-toggle selectpicker'+r+'" data-toggle="dropdown"'+i+'><span class="filter-option pull-left"></span>&nbsp;<span class="caret"></span></button><div class="dropdown-menu open">'+o+'<ul class="dropdown-menu inner selectpicker" role="menu"></ul></div></div>',s=t(a),u=s.find("ul.dropdown-menu");this.insertSearchBoxBefore(u),this.options.liveSearch||s.find(".bs-searchbox").hide(),this.insertActionsBoxBefore(u),this.options.actionsBox||s.find(".bs-actionsbox").hide();var l=t('<div class="apply-button">'+this.options.applyButtonText+"</div>");return s.find("div.dropdown-menu").append(l),s},createView:function(){var t=this.createDropdown(),e=this.createLi();return t.find("ul").append(e),t},reloadLi:function(){this.destroyLi();var t=this.createLi();this.$menu.find("ul").append(t)},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var e=this,r=[],o=0,a=function(t,e,n){return"<li"+("undefined"!=typeof n?' class="'+n+'"':"")+("undefined"!=typeof e|null===e?' data-original-index="'+e+'"':"")+">"+t+"</li>"},s=function(t,r,o,a){var s=n(i(t));return'<a tabindex="0"'+("undefined"!=typeof r?' class="'+r+'"':"")+("undefined"!=typeof o?' style="'+o+'"':"")+("undefined"!=typeof a?'data-optgroup="'+a+'"':"")+' data-normalized-text="'+s+'">'+t+'<span class="'+e.options.iconBase+" "+e.options.tickIcon+' check-mark"></span></a>'};return this.$element.find("option").each(function(){var n=t(this),i=n.attr("class")||"",u=n.attr("style"),l=n.data("content")?n.data("content"):n.html(),c="undefined"!=typeof n.data("subtext")?'<small class="muted text-muted">'+n.data("subtext")+"</small>":"",f="undefined"!=typeof n.data("icon")?'<span class="'+e.options.iconBase+" "+n.data("icon")+'"></span> ':"",h=n.is(":disabled")||n.parent().is(":disabled"),d=n[0].index;if(""!==f&&h&&(f="<span>"+f+"</span>"),n.data("content")||(l=f+'<span class="text">'+l+c+"</span>"),!e.options.hideDisabled||!h)if(n.parent().is("optgroup")&&n.data("divider")!==!0){if(0===n.index()){o+=1;var p=n.parent().attr("label"),g="undefined"!=typeof n.parent().data("subtext")?'<small class="muted text-muted">'+n.parent().data("subtext")+"</small>":"",m=n.parent().data("icon")?'<span class="'+e.options.iconBase+" "+n.parent().data("icon")+'"></span> ':"";p=m+'<span class="text">'+p+g+"</span>",0!==d&&r.length>0&&r.push(a("",null,"divider")),r.push(a(p,null,"dropdown-header"))}r.push(a(s(l,"opt "+i,u,o),d))}else r.push(n.data("divider")===!0?a("",d,"divider"):n.data("hidden")===!0?a(s(l,i,u),d,"hide is-hidden"):a(s(l,i,u),d))}),this.multiple||0!==this.$element.find("option:selected").length||this.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),t(r.join(""))},findLis:function(){return null==this.$lis&&(this.$lis=this.$menu.find("li")),this.$lis},render:function(e){var n=this;e!==!1&&this.$element.find("option").each(function(e){n.setDisabled(e,t(this).is(":disabled")||t(this).parent().is(":disabled")),n.setSelected(e,t(this).is(":selected"))}),this.tabIndex();var r=this.options.hideDisabled?":not([disabled])":"",o=this.$element.find("option:selected"+r).map(function(){var e,i=t(this),r=i.data("icon")&&n.options.showIcon?'<i class="'+n.options.iconBase+" "+i.data("icon")+'"></i> ':"";return e=n.options.showSubtext&&i.attr("data-subtext")&&!n.multiple?' <small class="muted text-muted">'+i.data("subtext")+"</small>":"",i.data("content")&&n.options.showContent?i.data("content"):"undefined"!=typeof i.attr("title")?i.attr("title"):r+i.html()+e}).toArray(),a=this.multiple?o.join(this.options.multipleSeparator):o[0];if(a&&this.options.titlePrefix&&(a=this.options.titlePrefix+" "+a),this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var s=this.options.selectedTextFormat.split(">");if(s.length>1&&o.length>s[1]||1==s.length&&o.length>=2){r=this.options.hideDisabled?", [disabled]":"";var u=this.$element.find("option").not('[data-divider="true"], [data-hidden="true"]'+r).length,l="function"==typeof this.options.countSelectedText?this.options.countSelectedText(o.length,u):this.options.countSelectedText;a=l.replace("{0}",o.length.toString()).replace("{1}",u.toString())}}this.options.title=this.$element.attr("title"),"static"==this.options.selectedTextFormat&&(a=this.options.title),a||(a="undefined"!=typeof this.options.title?this.options.title:this.options.noneSelectedText),this.$button.attr("title",i(a)),this.$newElement.find(".filter-option").html(a),this.$searchbox.val()&&this.$searchbox.triggerHandler("propertychange")},setStyle:function(t,e){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|validate\[.*\]/gi,""));var n=t?t:this.options.style;"add"==e?this.$button.addClass(n):"remove"==e?this.$button.removeClass(n):(this.$button.removeClass(this.options.style),this.$button.addClass(n))},liHeight:function(){if(this.options.size!==!1){var t=this.$menu.parent().clone().find("> .dropdown-toggle").prop("autofocus",!1).end().appendTo(this.$element.parent()),e=t.addClass("open").find("> .dropdown-menu"),n=e.find("li").not(".divider").not(".dropdown-header").filter(":visible").children("a").outerHeight(),i=this.options.header?e.find(".popover-title").outerHeight():0,r=this.options.liveSearch?e.find(".bs-searchbox").outerHeight():0,o=this.options.actionsBox?e.find(".bs-actionsbox").outerHeight():0,a=e.find(".apply-button").outerHeight()||0;t.remove(),this.$newElement.data("liHeight",n).data("headerHeight",i).data("searchHeight",r).data("actionsHeight",o).data("applyButtonHeight",a)}},setSize:function(){this.findLis();var e,n,i,r=this,o=this.$menu,a=o.find(".inner"),s=this.$newElement.outerHeight(),u=this.$newElement.data("liHeight"),l=this.$newElement.data("headerHeight"),c=this.$newElement.data("searchHeight"),f=this.$newElement.data("actionsHeight"),h=this.$newElement.data("applyButtonHeight"),d=this.$lis.filter(".divider").outerHeight(!0),p=parseInt(o.css("padding-top"))+parseInt(o.css("padding-bottom"))+parseInt(o.css("border-top-width"))+parseInt(o.css("border-bottom-width")),g=this.options.hideDisabled?", .disabled":"",m=t(window),v=p+parseInt(o.css("margin-top"))+parseInt(o.css("margin-bottom"))+2,y=function(){n=r.$newElement.offset().top-m.scrollTop(),i=m.height()-n-s};if(y(),this.options.header&&o.css("padding-top",0),"auto"==this.options.size){var b=function(){var t,s=r.$lis.not(".hide");y(),e=i-v,r.options.dropupAuto&&r.$newElement.toggleClass("dropup",n>i&&e-v<o.height()),r.$newElement.hasClass("dropup")&&(e=n-v),t=s.length+s.filter(".dropdown-header").length>3?3*u+v-2:0,o.css({"max-height":e+"px",overflow:"hidden","min-height":t+l+c+f+h+"px"}),a.css({"max-height":e-l-c-f-h-p+"px","overflow-y":"auto","min-height":Math.max(t-p,0)+"px"})};b(),this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",b),t(window).off("resize.getSize").on("resize.getSize",b),t(window).off("scroll.getSize").on("scroll.getSize",b)}else if(this.options.size&&"auto"!=this.options.size&&o.find("li"+g).length>this.options.size){var w=this.$lis.not(".divider"+g).find(" > *").slice(0,this.options.size).last().parent().index(),_=this.$lis.slice(0,w+1).filter(".divider").length;e=u*this.options.size+_*d+p,r.options.dropupAuto&&this.$newElement.toggleClass("dropup",n>i&&e<o.height()),o.css({"max-height":e+l+c+f+h+"px",overflow:"hidden"}),a.css({"max-height":e-p+"px","overflow-y":"auto"})}},setWidth:function(){if("auto"==this.options.width){this.$menu.css("min-width","0");var t=this.$newElement.clone().appendTo(document.body),e=t.find("> .dropdown-menu").css("width"),n=t.css("width","auto").find("> button").css("width");t.remove(),this.$newElement.css("width",Math.max(parseInt(e),parseInt(n))+"px")}else"fit"==this.options.width?(this.$menu.css("min-width",""),
this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width",""));this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement.removeClass("fit-width")},selectPosition:function(){var e,n,i=this,r="<div />",o=t(r),a=function(t){o.addClass(t.attr("class").replace(/form-control/gi,"")).toggleClass("dropup",t.hasClass("dropup")),e=t.offset(),n=t.hasClass("dropup")?0:t[0].offsetHeight,o.css({top:e.top+n,left:e.left,width:t[0].offsetWidth,position:"absolute"})};this.$newElement.on("click",function(){i.isDisabled()||(a(t(this)),o.appendTo(i.options.container),o.toggleClass("open",!t(this).hasClass("open")),o.append(i.$menu))}),t(window).resize(function(){a(i.$newElement)}),t(window).on("scroll",function(){a(i.$newElement)}),t("html").on("click",function(e){t(e.target).closest(i.$newElement).length<1&&o.removeClass("open")})},setSelected:function(t,e){this.findLis(),this.$lis.filter('[data-original-index="'+t+'"]').toggleClass("selected",e)},setDisabled:function(t,e){this.findLis(),e?this.$lis.filter('[data-original-index="'+t+'"]').addClass("disabled").find("a").attr("href","#").attr("tabindex",-1):this.$lis.filter('[data-original-index="'+t+'"]').removeClass("disabled").find("a").removeAttr("href").attr("tabindex",0)},isDisabled:function(){return this.$element.is(":disabled")},checkDisabled:function(){var t=this;this.isDisabled()?this.$button.addClass("disabled").attr("tabindex",-1):(this.$button.hasClass("disabled")&&this.$button.removeClass("disabled"),-1==this.$button.attr("tabindex")&&(this.$element.data("tabindex")||this.$button.removeAttr("tabindex"))),this.$button.click(function(){return!t.isDisabled()})},tabIndex:function(){this.$element.is("[tabindex]")&&(this.$element.data("tabindex",this.$element.attr("tabindex")),this.$button.attr("tabindex",this.$element.data("tabindex")))},clickListener:function(){var e=this;this.$newElement.on("touchstart.dropdown",".dropdown-menu",function(t){t.stopPropagation()}),this.$newElement.on("click",function(n){t(n.target).closest(e.$newElement.find(".apply-button")).length||(setTimeout(function(){e.$newElement.find(":focus").blur()},0),e.setSize(),e.options.liveSearch||e.multiple||setTimeout(function(){e.$menu.find(".selected a").focus()},10))}),this.$menu.on("click","li a",function(n){var i=t(this),r=i.parent().data("originalIndex"),o=e.$element.val(),a=e.$element.prop("selectedIndex");if(e.multiple&&n.stopPropagation(),n.preventDefault(),!e.isDisabled()&&!i.parent().hasClass("disabled")){var s=e.$element.find("option"),u=s.eq(r),l=u.prop("selected"),c=u.parent("optgroup"),f=e.options.maxOptions,h=c.data("maxOptions")||!1;if(e.multiple){if(u.prop("selected",!l),e.setSelected(r,!l),i.blur(),f!==!1||h!==!1){var d=f<s.filter(":selected").length,p=h<c.find("option:selected").length;if(f&&d||h&&p)if(f&&1==f)s.prop("selected",!1),u.prop("selected",!0),e.$menu.find(".selected").removeClass("selected"),e.setSelected(r,!0);else if(h&&1==h){c.find("option:selected").prop("selected",!1),u.prop("selected",!0);var g=i.data("optgroup");e.$menu.find(".selected").has('a[data-optgroup="'+g+'"]').removeClass("selected"),e.setSelected(r,!0)}else{var m="function"==typeof e.options.maxOptionsText?e.options.maxOptionsText(f,h):e.options.maxOptionsText,v=m[0].replace("{n}",f),y=m[1].replace("{n}",h),b=t('<div class="notify"></div>');m[2]&&(v=v.replace("{var}",m[2][f>1?0:1]),y=y.replace("{var}",m[2][h>1?0:1])),u.prop("selected",!1),e.$menu.append(b),f&&d&&(b.append(t("<div>"+v+"</div>")),e.$element.trigger("maxReached.bs.select")),h&&p&&(b.append(t("<div>"+y+"</div>")),e.$element.trigger("maxReachedGrp.bs.select")),setTimeout(function(){e.setSelected(r,!1)},10),b.delay(750).fadeOut(300,function(){t(this).remove()})}}}else s.prop("selected",!1),u.prop("selected",!0),e.$menu.find(".selected").removeClass("selected"),e.setSelected(r,!0);e.multiple?e.options.liveSearch&&e.$searchbox.focus():e.$button.focus(),(o!=e.$element.val()&&e.multiple||a!=e.$element.prop("selectedIndex")&&!e.multiple)&&e.$element.change()}}),this.$menu.on("click","li.disabled a, .popover-title, .popover-title :not(.close)",function(t){t.target==this&&(t.preventDefault(),t.stopPropagation(),e.options.liveSearch?e.$searchbox.focus():e.$button.focus())}),this.$menu.on("click","li.divider, li.dropdown-header",function(t){t.preventDefault(),t.stopPropagation(),e.options.liveSearch?e.$searchbox.focus():e.$button.focus()}),this.$menu.on("click",".popover-title .close",function(){e.$button.focus()}),this.$searchbox.on("click",function(t){t.stopPropagation()}),this.$menu.on("click",".actions-btn",function(n){e.options.liveSearch?e.$searchbox.focus():e.$button.focus(),n.preventDefault(),n.stopPropagation(),t(this).is(".bs-select-all")?e.selectAll():e.deselectAll(),e.$element.change()}),this.$menu.on("click",".apply-button",function(t){"function"==typeof e.options.applyCallback&&e.options.applyCallback.apply(this,t)}),this.$element.change(function(){e.render(!1)})},liveSearchListener:function(){var e=this,r=t('<li class="no-results"></li>');this.$newElement.on("click.dropdown.data-api touchstart.dropdown.data-api",function(){e.options.liveSearch&&(e.$menu.find(".active").removeClass("active"),e.$searchbox.val()&&setTimeout(function(){e.$searchbox.triggerHandler("propertychange")},10),e.multiple||e.$menu.find(".selected").addClass("active"),setTimeout(function(){e.$searchbox.focus()},10))}),this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api",function(t){t.stopPropagation()}),this.$searchbox.on("input propertychange",function(){e.$searchbox.val()?(e.options.searchAccentInsensitive?e.$lis.not(".is-hidden").removeClass("hide").find("a").not(":aicontains("+n(e.$searchbox.val())+")").parent().addClass("hide"):e.$lis.not(".is-hidden").removeClass("hide").find("a").not(":icontains("+e.$searchbox.val()+")").parent().addClass("hide"),e.$menu.find("li").filter(":visible:not(.no-results)").length?r.parent().length&&r.remove():(r.parent().length&&r.remove(),r.html(e.options.noneResultsText+" "+i(e.$searchbox.val())+"").show(),e.$menu.find("li").last().after(r))):(e.$lis.not(".is-hidden").removeClass("hide"),r.parent().length&&r.remove()),e.$menu.find("li.active").removeClass("active"),e.$menu.find("li").filter(":visible:not(.divider)").eq(0).addClass("active").find("a").focus(),t(this).focus()})},val:function(t){return"undefined"!=typeof t?(this.$element.val(t),this.render(),this.$element):this.$element.val()},selectAll:function(){this.findLis(),this.$lis.not(".divider").not(".disabled").not(".selected").filter(":visible").find("a").click()},deselectAll:function(){this.findLis(),this.$lis.not(".divider").not(".disabled").filter(".selected").filter(":visible").find("a").click()},keydown:function(e){var i,r,o,a,s,u,l,c,f,h=t(this),d=h.is("input")?h.parent().parent():h.parent(),p=d.data("this"),g={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};if(p.options.liveSearch&&(d=h.parent().parent()),p.options.container&&(d=p.$menu),i=t("[role=menu] li a",d),f=p.$menu.parent().hasClass("open"),!f&&/([0-9]|[A-z])/.test(String.fromCharCode(e.keyCode))&&(p.options.container?p.$newElement.trigger("click"):(p.setSize(),p.$menu.parent().addClass("open"),f=!0),p.$searchbox.focus()),p.options.liveSearch&&(/(^9$|27)/.test(e.keyCode.toString(10))&&f&&0===p.$menu.find(".active").length&&(e.preventDefault(),p.hideDropdown()),i=t("[role=menu] li:not(.divider):not(.dropdown-header):visible",d),h.val()||/(38|40)/.test(e.keyCode.toString(10))||0===i.filter(".active").length&&(i=p.$newElement.find("li").filter(p.options.searchAccentInsensitive?":aicontains("+n(g[e.keyCode])+")":":icontains("+g[e.keyCode]+")"))),i.length){if(/(38|40)/.test(e.keyCode.toString(10)))r=i.index(i.filter(":focus")),a=i.parent(":not(.disabled):visible").first().index(),s=i.parent(":not(.disabled):visible").last().index(),o=i.eq(r).parent().nextAll(":not(.disabled):visible").eq(0).index(),u=i.eq(r).parent().prevAll(":not(.disabled):visible").eq(0).index(),l=i.eq(o).parent().prevAll(":not(.disabled):visible").eq(0).index(),p.options.liveSearch&&(i.each(function(e){t(this).is(":not(.disabled)")&&t(this).data("index",e)}),r=i.index(i.filter(".active")),a=i.filter(":not(.disabled):visible").first().data("index"),s=i.filter(":not(.disabled):visible").last().data("index"),o=i.eq(r).nextAll(":not(.disabled):visible").eq(0).data("index"),u=i.eq(r).prevAll(":not(.disabled):visible").eq(0).data("index"),l=i.eq(o).prevAll(":not(.disabled):visible").eq(0).data("index")),c=h.data("prevIndex"),38==e.keyCode&&(p.options.liveSearch&&(r-=1),r!=l&&r>u&&(r=u),a>r&&(r=a),r==c&&(r=s)),40==e.keyCode&&(p.options.liveSearch&&(r+=1),-1==r&&(r=0),r!=l&&o>r&&(r=o),r>s&&(r=s),r==c&&(r=a)),h.data("prevIndex",r),p.options.liveSearch?(e.preventDefault(),h.is(".dropdown-toggle")||(i.removeClass("active"),i.eq(r).addClass("active").find("a").focus(),h.focus())):i.eq(r).focus();else if(!h.is("input")){var m,v,y=[];i.each(function(){t(this).parent().is(":not(.disabled)")&&t.trim(t(this).text().toLowerCase()).substring(0,1)==g[e.keyCode]&&y.push(t(this).parent().index())}),m=t(document).data("keycount"),m++,t(document).data("keycount",m),v=t.trim(t(":focus").text().toLowerCase()).substring(0,1),v!=g[e.keyCode]?(m=1,t(document).data("keycount",m)):m>=y.length&&(t(document).data("keycount",0),m>y.length&&(m=1)),i.eq(y[m-1]).focus()}(/(13|32)/.test(e.keyCode.toString(10))||/(^9$)/.test(e.keyCode.toString(10))&&p.options.selectOnTab)&&f&&(/(32)/.test(e.keyCode.toString(10))||e.preventDefault(),p.options.liveSearch?/(32)/.test(e.keyCode.toString(10))||(p.$menu.find(".active a").click(),h.focus()):t(":focus").click(),t(document).data("keycount",0)),(/(^9$|27)/.test(e.keyCode.toString(10))&&f&&(p.multiple||p.options.liveSearch)||/(27)/.test(e.keyCode.toString(10))&&!f)&&p.hideDropdown()}},mobile:function(){this.$element.addClass("mobile-device").appendTo(this.$newElement),this.options.container&&this.$menu.hide()},refresh:function(){this.$lis=null,this.reloadLi(),this.render(),this.updateSearchBox(),this.updateActionsBox(),this.setWidth(),this.setStyle(),this.checkDisabled(),this.liHeight()},insertSearchBoxBefore:function(e){var n=t('<div class="bs-searchbox"><input type="search" class="input-block-level form-control" autocomplete="off" placeholder="..." /></div>');n.insertBefore(e)},updateSearchBox:function(){this.$menu.find(".bs-searchbox").toggle(this.options.liveSearch)},insertActionsBoxBefore:function(e){var n=t('<div class="bs-actionsbox"><a class="actions-btn bs-select-all" href="#select_all">'+this.options.selectAllText+'</a><a class="actions-btn bs-deselect-all" href="#select_none">'+this.options.deselectAllText+"</a></div>");n.insertBefore(e)},updateActionsBox:function(){this.$menu.find(".bs-actionsbox").toggle(this.options.actionsBox)},update:function(){this.reloadLi(),this.setWidth(),this.setStyle(),this.checkDisabled(),this.liHeight()},hideDropdown:function(){this.$menu.parent().removeClass("open"),this.$button.focus(),this.$newElement.trigger("hide.bs.dropdown")},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()}};var a=t.fn.selectpicker;t.fn.selectpicker=r,t.fn.selectpicker.Constructor=o,t.fn.selectpicker.noConflict=function(){return t.fn.selectpicker=a,this},t(document).data("keycount",0).on("keydown",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input",o.prototype.keydown).on("focusin.modal",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input",function(t){t.stopPropagation()}),t(window).on("load.bs.select.data-api",function(){t(".selectpicker").each(function(){var e=t(this);r.call(e,e.data())})})}(jQuery),define("bootstrap_select",["bootstrap"],function(){}),function(t){t.fn.selectpicker.defaults={noneSelectedText:"  ",noneResultsText:"  ",selectAllText:" ",deselectAllText:" ",countSelectedText:" {0}  {1}",maxOptionsText:["  ({n} {var} )","    ({n} {var} )",["items","item"]],multipleSeparator:", ",applyButtonText:""}}(jQuery),define("bootstrap_select_i18n",["bootstrap_select"],function(){}),define("selectorsviews",["jquery","underscore","backbone","global","bootstrap_select","bootstrap_select_i18n"],function(t,e,n,i){var r=n.View.extend({template:t("#selector-menu-template").html(),itemsToShowLiveSearch:5,itemsToShowActionsBox:3,initialize:function(){this.$el.hide(),this.listenTo(this.model,"change",this.render)},render:function(){var t=this.getItems();return this.$el.html(e.template(this.template,{menuItems:t})),this.$el.selectpicker({countSelectedText:this.selectorNamePlural+": {0}  {1}",titlePrefix:this.titlePrefix||void 0,liveSearch:t.length>this.itemsToShowLiveSearch,actionsBox:t.length>this.itemsToShowActionsBox,applyCallback:this.apply.bind(this),exitCallback:this.exit.bind(this)}),this.$el.selectpicker("refresh"),this._initialValue=this.$el.val(),this},apply:function(){if(!e.isEqual(this._initialValue,this.$el.val())){var t=i.router.getParamsObjectFromQuery(i.router.getLocation()),n=JSON.parse(t.selector);n[this.selectorType]=this.$el.val(),n[this.selectorType]||delete n[this.selectorType],i.router.navigateSmart({selector:JSON.stringify(n)},{trigger:!0})}},exit:function(){this.$el.val(this._initialValue),this.render()},isSelected:function(t){return this.model.getSelectorValues(this.selectorType).indexOf(t)>-1},getItems:function(){return[]}}),o=r.extend({el:"#selector-contract",selectorType:"contract",selectorNamePlural:"",getItems:function(){var t=this,n=this.model.source_dataset||{};return e.map(n.nodes,function(e){return{name:e.name,subtext:e.client_name,selected:t.isSelected(""+e.name)}}).sort(function(t,e){return t.name-e.name})},dummy:null}),a=r.extend({el:"#selector-order",selectorType:"order",selectorNamePlural:"",getItems:function(){var t=this,n=this.model.source_dataset||{},i=[];e.forEach(n.nodes,function(n){e.forEach(n.nodes,function(e){i.push({name:e.name,selected:t.isSelected(e.name)})})});var r=function(t){return t.split(".").map(function(t){return new Array(Math.max(0,6-t.length)+1).join("0")+t}).join(".")};return i.sort(function(t,e){return r(t.name).localeCompare(r(e.name))})},dummy:null}),s=r.extend({el:"#selector-work-type",selectorType:"worktype",selectorNamePlural:"",getItems:function(){var t,n=this,i=this.model.source_dataset||{},r={},o=!1;return e.forEach(i.nodes,function(t){e.forEach(t.nodes,function(t){e.forEach(t.nodes,function(t){r[t.name]=!0})}),t.troubleshooting&&(o=!0)}),t=e.keys(r).map(function(t){return{name:t,selected:n.isSelected(t)}}),o&&t.push({name:" ",value:"troubleshooting",new_section:!0,selected:n.isSelected("troubleshooting")}),t},dummy:null}),u=r.extend({el:"#selector-sector",selectorType:"sector",selectorNamePlural:"",titlePrefix:":",getItems:function(){var t=this,n=this.model.source_dataset||{},i=this.model.get("sector_names"),r={};return e.forEach(n.nodes,function(t){e.forEach(t.nodes,function(t){e.forEach(t.nodes,function(t){e.forEach(t.nodes,function(t){r[t.sector_id]=t.sector_name_id})})})}),e.map(r,function(e,n){return{name:n,subtext:i[e],selected:t.isSelected(n)}})},dummy:null}),l=r.extend({el:"#selector-status",selectorType:"status",selectorNamePlural:" ",itemsToShowActionsBox:1,getItems:function(){var t=this,e=[{name:"  ",value:"on_work_with_reject"},{name:"",value:"on_hold"},{name:"",value:"on_pause"},{name:" ",value:"no_data"},{name:" ",value:"no_plan",new_section:!0}];return e.forEach(function(e){e.selected=t.isSelected(e.value)}),e},dummy:null});return{ContractView:o,OrderView:a,WorktypeView:s,SectorView:u,StatusView:l}}),define("appview",["jquery","underscore","backbone","d3","global","dataset","timelinesview","nodesview","tooltipview","cellscollection","commentsview","infopanelview","axisdaysview","monthsview","zoomview","zoomhelper","gridview","horizontalgridview","todayview","dayhighlightview","menudeldiaview","dayselectview","searchview","sortview","daterangesview","statsview","statsmodel","loadingview","completedfilterview","usermodel","userview","viewmenuitemscollection","viewmenuview","selectorsviews",""],function(t,e,n,i,r,o,a,s,u,l,c,f,h,d,p,g,m,v,y,b,w,_,x,k,M,S,T,C,D,E,N,$,A,j,P){P="im just a dummy";var R=n.View.extend({el:"#app",initialize:function(){this.canvas=i.select("#canvas"),this.canvas.attr("width",r.config.width+r.config.margin.left+r.config.margin.right).on("click",function(){r.events.trigger("click:canvas",i.event)}).select("#main").attr("transform","translate("+r.config.margin.left+","+r.config.margin.top+")"),this.axis=i.select("#axis").attr("width",r.config.width+r.config.margin.left+r.config.margin.right).attr("height",r.config.axis.height),this.model=new o,this.userModel=new E,this.userModel.fetch(),this.listenToOnce(this.model,"change",this.render),this.listenTo(this.model,"change toggle",this.adjustHeight),this.listenTo(this.model,"error",this.error),this.listenTo(r.events,"resize",this.onResize),this.zoomHelper=new g,this.userView=new N({model:this.userModel}),this.timelinesView=new a({model:this.model}),this.nodesView=new s({model:this.model}),this.tooltipView=new u({model:this.model}),this.commentsView=new c({dataset:this.model,collection:new l}),this.infoPanelView=new f,this.axisDaysView=new h,this.monthsView=new d,this.zoomView=new p({model:this.model,zoomHelper:this.zoomHelper}),this.gridView=new m({model:this.model}),this.horizontalGridView=new v({model:this.model}),this.todayView=new y({model:this.model}),this.dayHighlightView=new b({model:this.model}),this.menuDelDiaView=new w({model:this.model}),this.daySelectView=new _({model:this.model}),this.searchView=new x({model:this.model}),this.sortView=new k({model:this.model}),this.statsView=new S({model:new T}),this.viewMenuItemsCollection=new $,this.viewMenuView=new A({collection:this.viewMenuItemsCollection}),this.selectorContractView=new j.ContractView({model:this.model}),this.selectorOrderView=new j.OrderView({model:this.model}),this.selectorWorktypeView=new j.WorktypeView({model:this.model}),this.selectorSectorView=new j.SectorView({model:this.model}),this.selectorStatusView=new j.StatusView({model:this.model}),this.loadingView=new C,this.completedFilterView=new D({model:this.model}),this.dateRangesView=new M,this.model.fetch(),this.initGlobalAjax(),this.model.once("change",function(){i.select("header").style("top","0px"),i.select("footer").style("bottom","0px"),r.events.trigger("data-ready"),r.appView.model.searchQuery&&r.appView.model.expandToSearchResults()}),r.appView=this},render:function(){t("#spinner").hide(),this.$el.find("footer .version").text(r.appVersion),this.$el.show()},adjustHeight:function(){var t=(r.config.nodeHeight+r.config.nodePadding)*this.model.getD3Data().nodes.length;this.model.getD3Data().yScale.rangeRound([0,t]),this.canvas.attr("height",Math.max(r.config.height,t)+r.config.margin.top+r.config.margin.bottom)},onResize:function(){var t=(r.config.nodeHeight+r.config.nodePadding)*this.model.getD3Data().nodes.length;this.canvas.attr("width",r.config.width+r.config.margin.left+r.config.margin.right).attr("height",Math.max(r.config.height,t)+r.config.margin.top+r.config.margin.bottom),this.axis.attr("width",r.config.width+r.config.margin.left+r.config.margin.right).attr("height",r.config.axis.height)},initGlobalAjax:function(){t(document).ajaxStart(function(){r.events.trigger("start:loading")}),t(document).ajaxStop(function(){r.events.trigger("stop:loading")}),t("#auth-error .close").click(function(){t("#auth-error").hide()})},error:function(e){t("#spinner").hide();var n=e&&e.code||0,i=e&&e.exception&&e.exception.code||0,r=e&&e.exception&&e.exception.message||"";t("#auth-error").find(".message").hide().end().find(".message-"+n).show().end().find(".exception").text((i?"[code: "+i+"] ":"")+(r||"")).end().fadeIn()}});return R}),define("router",["jquery","underscore","backbone","appview","global"],function(t,e,n,r,o){var a=n.Router.extend({routes:{"":"index","search=*searchQuery":"referalVisitor","sort=:sort/completed_filter=:completed/selector=:selector(/layers=:layersList)(/scale=:zoomValue)(/toggle=:toggleValue)(/pan=:panValue)(/preselected_contract=:preselectedContractValue)(/search=*searchQuery)":"applyDatamining","sort=:sort/completed_filter=:completed/search=*searchQuery":"applyShortDatamining","short_link=*searchQuery":"zippedLink","open_comment=*searchQuery":"openComment","confirmplan=*searchQuery":"confirmPlan","open_contracts=*searchQuery":"openContracts","*actions":"defaultAction"},defaultParams:{sort:(o.config.sortDesc?"!":"")+o.config.sortType,completed_filter:o.config.hideCompleted?o.config.hideCompletedDepth:"off",selector:"{}",layers:"all"},urlParamsSorting:{sort:1,completed_filter:2,selector:3,layers:4,scale:5,toggle:6,pan:7,preselected_contract:8,search:1e3},index:function(){this.navigateSmart(this.defaultParams,{trigger:!0,replace:!0})},getLocation:function(){var t=window.location.hash;if(t.indexOf("short_link=")>=0){var t=t.split("short_link=")[1],e=Base64.btou(RawDeflate.inflate(Base64.fromBase64(t)));if(e)return"#"!=e[0]&&(e="#"+e),e}return window.location.hash},zippedLink:function(t){var e=Base64.btou(RawDeflate.inflate(Base64.fromBase64(t)));n.history.loadUrl(e)},openComment:function(t){o.events.trigger("navigate:comment",t,!0)},confirmPlan:function(t){o.events.trigger("navigate:confirmplan",t,!0)},referalVisitor:function(t){window.location.hash="#",this.navigateSmart(e.extend({},this.defaultParams,{search:t}),{trigger:!0,replace:!0})},openContracts:function(t){},applyShortDatamining:function(t,n,i){this.navigateSmart(e.extend({},this.defaultParams,{sort:t,completed_filter:n,search:i}),{trigger:!0,replace:!0})},applyDatamining:function(t,e,n,i,r,a,s,u,l){var c=!0;o.config.preselectedNode=u?this.unescapeParam(u):null,o.events.trigger("search:model",(l||"").toLocaleLowerCase(),c),o.events.trigger("completed-filter:model","off"!==e,e,c),o.events.trigger("sort:model",t.split("!").pop(),"!"===t[0]),o.events.trigger("selector:model",n,c)},defaultAction:function(t){console.warn("No route: ",t)},navigateSmart:function(t,e){var n=this.updateQueryWithParams(o.router.getLocation(),t);o.router.navigate(n,e)},updateQueryWithParams:function(t,n){var i=this,r=this.getParamsObjectFromQuery(t),o=e.extend(r,n),a=e.reduce(o,function(t,e,n){return e.length&&t.push([n,e]),t},[]).sort(function(t,e){var n=i.urlParamsSorting[t[0]]||500,r=i.urlParamsSorting[e[0]]||500;return n>r?1:r>n?-1:0}),s=a.reduce(function(t,e){return t+(t.length>0?"/":"")+e[0]+"="+e[1]},""),u=Base64.toBase64(RawDeflateStr.deflate(Base64.utob(s)));return"short_link="+u},escapeParam:function(t){return t.replace(/\//g,"|").replace(/\./g,",")},unescapeParam:function(t){return t.replace(/\|/g,"/").replace(/\,/g,".")},getParamsObjectFromQuery:function(t){var e=t.slice(1).match(/(search=.*)|([^\/=]+=[^.][^\/]+)/g);return e?e.reduce(function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0]]=n[1]),t},{}):{}},encodeURI:function(t){var e,n="",r="",o="",a="";for(i=0;i<256;i++)a=i.toString(16),a.length<2&&(a="0"+a),o+=a,r+=unescape("%"+a);for(o=o.toUpperCase(),t.replace(String.fromCharCode(13)+"","%13"),q=0;q<t.length;q++){for(e=t.substr(q,1),i=0;i<r.length;i++)e==r.substr(i,1)&&(e=e.replace(r.substr(i,1),"%"+o.substr(2*i,2)),i=r.length);n+=e}return n},decodeURI:function(t){return unescape(t)}}),s=function(){o.router=new a,new r,n.history.start({root:window.location.pathname})};return{initialize:s}}),define("app",["router","global","module"],function(t,e,n){n.config().contracts&&(e.config.data_url=e.config.data_url+"?contracts="+n.config().contracts);var i=function(){t.initialize()};return{initialize:i}}),function(){function t(t){function e(t,e){for(var n=t.split("_"),i=Math.min(o.length,n.length),r=-1;++r<i;)if(o[r](e))return n[r];return n[i-1]}function n(t,n,i){var r={mm:"___",hh:"___",dd:"___",MM:"___",yy:"___"};return"m"===i?n?"":"":t+" "+e(r[i],+t)}function i(t,e){var n={nominative:"___________".split("_"),accusative:"___________".split("_")},i=/D[oD]? *MMMM?/.test(e)?"accusative":"nominative";return n[i][t.month()]}function r(t,e){var n={nominative:"______".split("_"),accusative:"______".split("_")},i=/\[ ?[\u0412\u0432] ?(?:\u043f\u0440\u043e\u0448\u043b\u0443\u044e|\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e)? ?\] ?dddd/.test(e)?"accusative":"nominative";return n[i][t.day()]}var o=[function(t){return t%10===1&&t%100!==11},function(t){return t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)},function(t){return t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0},function(t){return!0}];t.lang("ru",{months:i,monthsShort:"___________".split("_"),weekdays:r,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., LT",LLLL:"dddd, D MMMM YYYY ., LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:n,mm:n,h:"",hh:n,d:"",dd:n,M:"",MM:n,y:"",yy:n},ordinal:"%d.",week:{dow:1,doy:7}})}"function"==typeof define&&define.amd&&define("moment_ru",["moment"],t),"undefined"!=typeof window&&window.moment&&t(window.moment)}(),require.config({paths:{jquery:"libs/jquery-2.0.0",jgrowl:"libs/jquery.jgrowl","jquery.jsonp":"libs/jquery.jsonp-2.4.0","jquery.hoverIntent":"libs/jquery.hoverIntent","jquery.csv":"libs/jquery.csv",bootstrap:"libs/bootstrap",bootstrap_select:"libs/bootstrap-select",bootstrap_select_i18n:"libs/bootstrap-select-i18n-ru_RU",bootstrap_contextmenu:"libs/bootstrap-contextmenu",underscore:"libs/lodash",backbone:"libs/backbone",d3:"libs/d3.v3","d3.lambdas":"libs/d3.lambdas",ga:"libs/google-analytics",clipboard:"libs/clipboard",moment:"libs/moment.min",moment_ru:"libs/moment.ru"},shim:{"jquery.jsonp":["jquery"],"jquery.hoverIntent":["jquery"],"jquery.csv":["jquery"],bootstrap:["jquery"],jgrowl:["jquery"],moment:["jquery"],bootstrap_select:["bootstrap"],bootstrap_select_i18n:["bootstrap_select"],underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},d3:{exports:"d3"},"d3.lambdas":["d3"],ga:{exports:"ga"}}}),require(["app","moment_ru"],function(t){t.initialize()}),define("main",function(){});